---
title: FormRender
date: 2020-08-13 19:30:25
tags: FormRender
categories: å‰ç«¯
---

ä»Šå¤©å­¦ä¹ ç ”ç©¶äº†ä¸€ä¸‹ FormRenderï¼Œè§‰å¾—åœ¨ä¸€äº›è¡¨å•å¤šçš„é¡¹ç›®ï¼Œæˆ–è€…æ˜¯åç«¯æ•°æ®ç»“æ„å¤æ‚çš„é¡¹ç›®ï¼Œå¾ˆé€‚ç”¨ã€‚
å¯ä»¥åœ¨è¿™ä¸ªé“¾æ¥é‡Œé¢æ‰¾åˆ°å¿«é€Ÿ /æ‹–æ‹½çš„ å½¢å¼ ç”Ÿæˆè¡¨å•ç»“æ„ ï¼Œå†è‡ªåŠ¨è½¬åŒ–ä¸º json-schema çš„æ ¼å¼
æ”¾è¿› FormRender é‡Œé¢ï¼Œå®Œæˆå¿«é€Ÿç”Ÿæˆè¡¨å•
[è¿™æ˜¯é“¾æ¥](https://form-render.github.io/schema-generator/)
ä¸‹é¢æ˜¯ä¸€ä¸ªå†™æ»¡äº†æ³¨é‡Šçš„ï¼Œå°½é‡å…¨é¢çš„æ —å­ ğŸŒ°ï¼Œæ³¨å…¥äº†æˆ‘çš„å¿ƒè¡€ï¼
ç”¨çš„æ—¶å€™ç”šè‡³å¯ä»¥ç›´æ¥å¤åˆ¶è¿™ä¸ª

```
import React, { useState } from 'react';
import { Input } from 'antd';
import ReactDOM from 'react-dom';
// ä½¿ç”¨ Ant Design ä½“ç³»
import FormRender from 'form-render/lib/antd';
// ä½¿ç”¨ Fusion Design ä½“ç³»
// import FormRender from "form-render/lib/fusion";

//  è¿™äº›å†…å®¹å¯ä»¥åˆ°è¿™ä¸ªåœ°å€æ  https://form-render.github.io/schema-generator/playground

window.copyMe = (list, index) => {
  const item = list[index];
  list.splice(index, 0, item);
  return list;
};

const SiteInput = ({ value, onChange, name }) => {
  return (
    <Input
      addonBefore="http://"
      addonAfter=".com"
      value={value}
      onChange={e => onChange(name, e.target.value)}
    />
  );
};
const schema1 = {
  type: 'object',
  'ui:labelWidth': '30%', // ç”¨äºæ§åˆ¶æœ¬å…ƒç´ ä»¥åŠå…¶å­å…ƒç´ ï¼ˆå¦‚æœæœ¬å…ƒç´ æ˜¯å¯¹è±¡æˆ–åˆ—è¡¨ï¼‰çš„æ ‡ç­¾å®½åº¦
  //  ui:disabled: å¯æ§åˆ¶ inputã€numberã€dateã€checkboxã€radioã€selectã€switch å¯¹äºç»„ä»¶çš„ disabled å±æ€§(å˜ç°ä¸å¯ç‚¹å‡»)
  //  ui:readonlyï¼šå¯æ§åˆ¶ inputã€number ç»„ä»¶ä¸­çš„ readonly å±æ€§(ä¸å¯ç¼–è¾‘ï¼Œä½†ä¸å˜ç°)
  //  ui:hiddenï¼šå¯æ§åˆ¶æ‰€æœ‰åŸºç¡€ç»„ä»¶æ˜¯å¦æ˜¾ç¤ºï¼Œå¯ä½¿ç”¨ true/false æˆ–å‡½æ•°è¡¨è¾¾å¼
  //  ui:classNameï¼šæ·»åŠ ç»„ä»¶ root å…ƒç´ çš„ classNameï¼ˆå’Œ fr-field è¿™ä¸ª className åœ¨åŒçº§ï¼‰ï¼Œç”¨äºè‡ªå®šä¹‰å•ç‹¬ç»„ä»¶çš„æ ·å¼
  //  ui:widthï¼šå•ä¸ªåŸºç¡€ç»„ä»¶çš„é•¿åº¦ï¼Œå»ºè®®ä½¿ç”¨ç™¾åˆ†æ¯”ä¾‹å¦‚"ui:width":"50%"ã€‚
  properties: {
    agree: {
      title: 'æ˜¯å¦åŒæ„',
      type: 'boolean',
      //      titleï¼šè¡¨å•çš„æ ‡é¢˜ä¿¡æ¯ï¼Œä½œä¸º label å±•ç¤ºï¼Œæ³¨æ„ title ä¸º""æ—¶å ä½ï¼Œtitle ä¸å†™æ—¶ä¸å ä½
      //      descriptionï¼šè¡¨å•çš„æè¿°ä¿¡æ¯ï¼Œå¸¸å°†å¡«å†™æ³¨æ„ç‚¹æ”¾å…¥æ­¤å‚æ•°
      //      typeï¼šè¡¨å•çš„ç±»å‹ï¼Œæ”¯æŒ stringã€numberã€booleanã€arrayã€objectã€range
      //      formatï¼šç”¨æ¥æè¿°è¾“å…¥æ¡†çš„æ ¼å¼ï¼Œæ”¯æŒ imageã€dateTimeã€dateã€time
      //      patternï¼šè‡ªå®šä¹‰æ­£åˆ™æ ¡éªŒï¼Œç”¨äºæ ¡éªŒ string æˆ– number æ•°æ®æ˜¯å¦åˆæ ¼ï¼Œè¯¦ç»†ä½¿ç”¨å¯è§ pattern è‡ªå®šä¹‰æ­£åˆ™æ ¡éªŒ
      //      message æ ¡éªŒæç¤ºè‡ªå®šä¹‰æ–‡æ¡ˆï¼Œä¸ pattern å…±åŒä½¿ç”¨
      //      default é»˜è®¤å€¼ï¼Œå¯¹è±¡ç±»å‹ä¸èƒ½ä½¿ç”¨ defaultï¼Œå…¶ä»–ç±»å‹åŒ…æ‹¬ array éƒ½å¯ä»¥ä½¿ç”¨ default
    },
    someObj: {
      title: 'å¯¹è±¡',
      type: 'object',
      properties: {
        personType: {
          title: 'ç±»å‹',
          type: 'number',
          enum: [1, 2, 3],
        },
        age: {
          type: 'string',
          title: 'age',
          'ui:hidden': '{{formData.agree==false && rootValue.personType!=2 }}',
          //  ä¸¤ç§å†™æ³•ï¼Œéšä¾¿å–èˆ
          //  'ui:hidden': (formData, rootValue) => formData.agree==false,
          //  formData æ•´ä¸ª form çš„å€¼ ï¼ˆæœ€å¸¸ç”¨ï¼Œå½“ä¸¤ä¸ªå…³è”ç»„ä»¶è·ç¦»è¾ƒè¿œæ—¶ï¼Œå¯ä»¥ä»é¡¶å±‚çš„ formData é‡Œè·å–ï¼‰
          //  rootValue  çˆ¶ç»„ä»¶çš„å€¼ ï¼ˆæ¯”è¾ƒå¸¸ç”¨ï¼Œä¸Šä¸€çº§çš„å€¼ï¼Œæ–¹ä¾¿ä»ä¸­èƒ½è·å–æ‰€æœ‰å…„å¼Ÿç»„ä»¶çš„å€¼ï¼‰
        },
      },
    },
    stringDemo: {
      title: 'å­—ç¬¦ä¸²',
      description: 'è‹±æ–‡æˆ–æ•°å­—ç»„åˆ',
      type: 'string',
      pattern: '^[A-Za-z0-9]+$',
      message: {
        pattern: 'è¯·è¾“å…¥æ­£ç¡®æ ¼å¼',
      },
      'ui:labelWidth': '30%',
    },
    imgDemo: {
      title: 'å›¾ç‰‡',
      type: 'string',
      format: 'image',
      default: "'https://img.alicdn.com/tfs/TB1P8p2uQyWBuNjy0FpXXassXXa-750-1334.png'",
    },
    disabledDemo: {
      title: 'ä¸å¯ç”¨',
      type: 'string',
      default: 'æˆ‘æ˜¯ä¸€ä¸ªè¢« disabled çš„å€¼',
      'ui:disabled': true,
    },
    url: {
      title: 'ç½‘å€',
      type: 'string',
      'ui:widget': 'siteInput',
    },
    enumDemo: {
      title: 'æšä¸¾',
      enum: ['A', 'B'],
      enumNames: ['æœ±å†›', 'å¼ æ—­'],
    },
    monthpicker: {
      title: 'æœˆä»½é€‰æ‹©',
      type: 'string',
      format: 'date',
      'ui:options': {
        picker: 'month',
      },
    },
    objDemo: {
      title: 'å•ä¸ªå¯¹è±¡',
      description: 'è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹',
      type: 'object',
      properties: {
        isLike: {
          title: 'å•é€‰é¡¹',
          type: 'boolean',
          default: true,
        },

        background: {
          title: 'é¢œè‰²é€‰æ‹©',
          description: 'ç‰¹æ®Šé¢æ¿',
          format: 'color',
          type: 'string',
        },
        oncemore: {
          any: 'anthing',
          type: 'object',

          properties: {
            oncemoreee: {
              title: 'æˆ‘å†æ¥ä¸€å±‚',
              type: 'string',
              default: '7',
            },
          },
        },
      },
    },
    arrDemo: {
      title: 'å¯¹è±¡æ•°ç»„',
      description: 'å¯¹è±¡æ•°ç»„åµŒå¥—åŠŸèƒ½',
      type: 'array',
      minItems: 1,
      maxItems: 3,
      items: {
        type: 'object',
        properties: {
          name: {
            title: 'å­—ç¬¦åç§°',
            description: 'stringç±»å‹',
            type: 'string',
            pattern: '^[A-Za-z0-9]+$',
          },
          num: {
            title: 'æ•°å­—å‚æ•°',
            description: 'numberç±»å‹',
            type: 'number',
          },
        },
      },
      'ui:options': {
        buttons: [
          {
            text: 'Excelå¯¼å…¥',
            icon: 'copy',
            callback: 'someCallback',
          },
          {
            text: 'åˆ é™¤å…¨éƒ¨',
            icon: 'delete',
            callback: 'clearAll',
          },
          {
            text: 'å¤åˆ¶ä¸Šä¸ª',
            icon: 'copy',
            callback: 'copyLast',
          },
        ],
        itemButtons: [
          {
            text: 'æœ±å†›åœ¨é‡Œé¢å¤åˆ¶',
            icon: 'copy',
            callback: 'copyMe',
          },
        ],
      },
    },
  },
  required: ['stringDemo', 'dateDemo'],
};

const list = {
  type: 'array',
  items: {
    type: 'object',
    properties: {
      x: {
        type: 'string',
      },
    },
  },
  default: [{ x: 'a' }, { x: 'b' }],
};
function Demo() {
  const [formData, setData] = useState({});
  const [valid, setValid] = useState([]);

  const onSubmit = () => {
    // valid æ˜¯æ ¡éªŒåˆ¤æ–­çš„æ•°ç»„ï¼Œvalid é•¿åº¦ä¸º 0 ä»£è¡¨æ ¡éªŒå…¨éƒ¨é€šè¿‡
    if (valid.length > 0) {
      alert(`æ ¡éªŒæœªé€šè¿‡å­—æ®µï¼š${valid.toString()}`);
    } else {
      alert(JSON.stringify(formData, null, 2));
    }
  };

  return (
    <div style={{ maxWidth: 600 }}>
      <FormRender
        schema={schema1}
        formData={formData}
        onChange={setData}
        onValidate={setValid}
        displayType="row" // è¯¦ç»†é…ç½®è§ä¸‹
        widgets={{ siteInput: SiteInput }} //  è¿™é‡Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶
      />

      {/* <FormRender
        schema={list}
        formData={formData}
        onChange={setData}
        onValidate={setValid}
        displayType="row" // è¯¦ç»†é…ç½®è§ä¸‹
      /> */}

      <button onClick={onSubmit} type="submit">
        æäº¤
      </button>
    </div>
  );
}

export default Demo;

```

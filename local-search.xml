<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>essay0911</title>
    <link href="/2020/09/11/essay0911/"/>
    <url>/2020/09/11/essay0911/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è¿™æ˜¯ç¥å¥‡çš„hooks</title>
    <link href="/2020/09/10/hooks/"/>
    <url>/2020/09/10/hooks/</url>
    
    <content type="html"><![CDATA[<h2 id="HOOKS"><a href="#HOOKS" class="headerlink" title="HOOKS"></a>HOOKS</h2><p>æ’çœ¼ï¼Œåç»­å®Œæˆæ–‡æ¡£</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hooks</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›å¥½ç”¨çš„gitå‘½ä»¤</title>
    <link href="/2020/09/10/git/"/>
    <url>/2020/09/10/git/</url>
    
    <content type="html"><![CDATA[<h2 id="git-ä»£ç ç‰ˆæœ¬ç®¡ç†å·¥å…·"><a href="#git-ä»£ç ç‰ˆæœ¬ç®¡ç†å·¥å…·" class="headerlink" title="git ä»£ç ç‰ˆæœ¬ç®¡ç†å·¥å…·"></a>git ä»£ç ç‰ˆæœ¬ç®¡ç†å·¥å…·</h2><p>æœ€å¼€å§‹çš„æ—¶å€™ï¼Œåªä¼š git add ,git commit , git push , git pull ,å½“ç†Ÿç»ƒä½¿ç”¨è¿™æ ·çš„æäº¤ä»£ç çš„â€œç¡¬â€å‘½ä»¤å<br>åœ¨å·¥ä½œä¸­ä¸æ–­é‡è§å„ç§æƒ…å†µï¼Œå­¦ä¹ äº†å„ç§å¥½ç”¨çš„å‘½ä»¤<br>ä¹Ÿå¾—ç›Šä¸æˆ‘æ‰§ç€ä¸æ‰‹æ•²å‘½ä»¤è€Œä¸æ˜¯ç”¨ä¸€äº› git å·¥å…·<br>åœ¨è¿™é‡Œåšä¸€ä¸ªç®€å•çš„æ€»ç»“ï¼Œå¹¶å†æ¬¡æ‹“å®½è‡ªå·±çš„ git çŸ¥è¯†ï½<br>å†²é¸­</p><h3 id="git-stash"><a href="#git-stash" class="headerlink" title="git stash"></a>git stash</h3><p>git stash å¯ä»¥æŠŠæ‰€æœ‰æœªæäº¤çš„ä¿®æ”¹ï¼ˆå·¥ä½œåŒºå’Œæš‚å­˜åŒºï¼‰ä¹Ÿå°±æ˜¯ git commit ä¹‹å‰çš„ ï¼Œä¿å­˜åˆ°å †æ ˆä¸­ï¼Œå…ˆè¿›åå‡ºã€‚<br>åœ¨æ—¥å¸¸æ•²ä»£ç ï¼Œä¸­ç»å¸¸ä¼šä½¿ç”¨<br>åœ¨åˆ‡åˆ†æ”¯ï¼Œç´§æ€¥ä¸Šçº¿ï¼Œä½†æ˜¯æ­£åœ¨å¼€å‘çš„åŠŸèƒ½åˆ†æ”¯è¿˜æ²¡æœ‰å¼€å‘å®Œçš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å•¦</p><h4 id="git-stash-save-â€œzhujunTestâ€"><a href="#git-stash-save-â€œzhujunTestâ€" class="headerlink" title="git stash save â€œzhujunTestâ€"></a>git stash save â€œzhujunTestâ€</h4><p>å¯ä»¥åœ¨æš‚å­˜çš„æ—¶å€™åŠ å¤‡æ³¨ ç†è§£ä¸º git commit -m â€œâ€ è¿™ç§å¤‡æ³¨å³å¯</p><h4 id="git-stash-list"><a href="#git-stash-list" class="headerlink" title="git stash list"></a>git stash list</h4><p>æŸ¥çœ‹å½“å‰ stash ä¸­çš„å†…å®¹</p><h4 id="git-stash-pop"><a href="#git-stash-pop" class="headerlink" title="git stash pop"></a>git stash pop</h4><p>å°†å½“å‰ stash ä¸­çš„å†…å®¹å¼¹å‡ºï¼Œå¹¶åº”ç”¨åˆ°å½“å‰åˆ†æ”¯å¯¹åº”çš„å·¥ä½œç›®å½•ä¸Šã€‚<br>æ³¨ï¼šè¯¥å‘½ä»¤å°†å †æ ˆä¸­æœ€è¿‘ä¿å­˜çš„å†…å®¹åˆ é™¤ï¼ˆæ ˆæ˜¯å…ˆè¿›åå‡ºï¼‰</p><h4 id="git-stash-apply"><a href="#git-stash-apply" class="headerlink" title="git stash apply"></a>git stash apply</h4><p>å°†å †æ ˆä¸­çš„å†…å®¹åº”ç”¨åˆ°å½“å‰ç›®å½•ï¼Œä¸åŒäº git stash popï¼Œè¯¥å‘½ä»¤ä¸ä¼šå°†å†…å®¹ä»å †æ ˆä¸­åˆ é™¤ï¼Œä¹Ÿå°±è¯´è¯¥å‘½ä»¤èƒ½å¤Ÿå°†å †æ ˆçš„å†…å®¹å¤šæ¬¡åº”ç”¨åˆ°å·¥ä½œç›®å½•ä¸­ï¼Œé€‚åº”äºå¤šä¸ªåˆ†æ”¯çš„æƒ…å†µã€‚<br>å¯ä»¥ä½¿ç”¨ git stash apply + stash åå­—ï¼ˆå¦‚ stash@{1}ï¼‰æŒ‡å®šæ¢å¤å“ªä¸ª stash åˆ°å½“å‰çš„å·¥ä½œç›®å½•ã€‚</p><h4 id="git-stash-clear"><a href="#git-stash-clear" class="headerlink" title="git stash clear"></a>git stash clear</h4><p>æ¸…é™¤å †æ ˆä¸­çš„æ‰€æœ‰ å†…å®¹</p><h4 id="git-stash-show"><a href="#git-stash-show" class="headerlink" title="git stash show"></a>git stash show</h4><p>æŸ¥çœ‹å †æ ˆä¸­æœ€æ–°ä¿å­˜çš„ stash å’Œå½“å‰ç›®å½•çš„å·®å¼‚ã€‚</p><h3 id="git-rebase"><a href="#git-rebase" class="headerlink" title="git rebase"></a>git rebase</h3><p>æœ¬åœ°ä»£ç å¤šæ¬¡æäº¤åï¼Œåˆå¹¶ä¸»åˆ†æ”¯çš„æ—¶å€™ï¼Œå¦‚æœç”¨ git merge åˆ†æ”¯æ ‘ä¼šåˆ†å‰<br>è¿™æ—¶å€™ä½¿ç”¨ git rebase å°±å¾ˆé…·å¾ˆä¼˜é›…<br>æ¥å§å±•ç¤º</p><pre><code class="hljs crmsh">git checkout <span class="hljs-literal">master</span>git pull origin <span class="hljs-literal">master</span>git checkout æœ¬åœ°åˆ†æ”¯git rebase <span class="hljs-literal">master</span>// å¦‚æœæœ‰å†²çªï¼Œè§£å†³å†²çª ç„¶ågit add .    +   git rebase --continuegit checkout <span class="hljs-literal">master</span>git merge æœ¬åœ°åˆ†æ”¯git push</code></pre><p>å®Œäº‹ã€‚</p><h3 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h3><p>é‡ç½® HEAD æŒ‡é’ˆ</p><h4 id="git-reset-â€“hard"><a href="#git-reset-â€“hard" class="headerlink" title="git reset â€“hard"></a>git reset â€“hard</h4><p>æ¯”å¦‚ git reset â€“hard origin master è¿™æ—¶ä¼šæ¸…ç©ºæš‚å­˜åŒºï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰ commit çš„å†…å®¹éƒ½ä¼šè¢«æ¸…é™¤æ‰<br>é‡ç½®ä½ç½®çš„åŒæ—¶ï¼Œç›´æ¥å°† working Tree å·¥ä½œç›®å½•ã€ index æš‚å­˜åŒºåŠ repository éƒ½é‡ç½®æˆç›®æ ‡ Reset èŠ‚ç‚¹çš„å…§å®¹,æ‰€ä»¥æ•ˆæœçœ‹èµ·æ¥ç­‰åŒäºæ¸…ç©ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºã€‚</p><h4 id="git-reseet-â€“mixed-æˆ–è€…è¯´ä¸åŠ å‚æ•°"><a href="#git-reseet-â€“mixed-æˆ–è€…è¯´ä¸åŠ å‚æ•°" class="headerlink" title="git reseet â€“mixed æˆ–è€…è¯´ä¸åŠ å‚æ•°"></a>git reseet â€“mixed æˆ–è€…è¯´ä¸åŠ å‚æ•°</h4><p>ä¿ç•™å·¥ä½œç›®å½•ï¼Œå¹¶æ¸…ç©ºæš‚å­˜åŒº<br>å·¥ä½œç›®å½•çš„å†…å®¹å’Œ â€“soft ä¸€æ ·ä¼šè¢«ä¿ç•™ï¼Œä½†å’Œ â€“soft çš„åŒºåˆ«åœ¨äºï¼Œå®ƒä¼šæŠŠæš‚å­˜åŒºæ¸…ç©º,å¹¶æŠŠåŸèŠ‚ç‚¹å’Œ reset èŠ‚ç‚¹çš„å·®å¼‚çš„æ–‡ä»¶æ”¾åœ¨å·¥ä½œç›®å½•ï¼Œæ€»è€Œè¨€ä¹‹å°±æ˜¯ï¼Œå·¥ä½œç›®å½•çš„ä¿®æ”¹ã€æš‚å­˜åŒºçš„å†…å®¹ä»¥åŠç”± reset æ‰€å¯¼è‡´çš„æ–°çš„æ–‡ä»¶å·®å¼‚ï¼Œéƒ½ä¼šè¢«æ”¾è¿›å·¥ä½œç›®å½•</p><h4 id="git-reset-â€“soft"><a href="#git-reset-â€“soft" class="headerlink" title="git reset â€“soft"></a>git reset â€“soft</h4><p>ä¿ç•™å·¥ä½œç›®å½•ï¼Œå¹¶æŠŠé‡ç½® HEAD æ‰€å¸¦æ¥çš„æ–°çš„å·®å¼‚æ”¾è¿›æš‚å­˜åŒº<br>â€“hard ä¼šæ¸…ç©ºå·¥ä½œç›®å½•å’Œæš‚å­˜åŒºçš„æ”¹åŠ¨,è€Œ â€“soft åˆ™ä¼šä¿ç•™å·¥ä½œç›®å½•çš„å†…å®¹ï¼Œå¹¶æŠŠå› ä¸ºä¿ç•™å·¥ä½œç›®å½•å†…å®¹æ‰€å¸¦æ¥çš„æ–°çš„æ–‡ä»¶å·®å¼‚æ”¾è¿›æš‚å­˜åŒºã€‚</p><h3 id="git-cherry-pick-æŸæ¬¡æäº¤"><a href="#git-cherry-pick-æŸæ¬¡æäº¤" class="headerlink" title="git cherry-pick æŸæ¬¡æäº¤"></a>git cherry-pick æŸæ¬¡æäº¤</h3><p>å¯ä»¥å•ç‹¬åˆå¹¶æŸæ¬¡æäº¤çš„ä»£ç ï¼Œæ¯”å¦‚ A åˆ†æ”¯æœ‰ 3 æ¬¡æäº¤ï¼Œæƒ³è¦æŠŠç¬¬ 2 æ¬¡åˆå¹¶åˆ° B åˆ†æ”¯ã€‚</p><p>å¦‚æœé‡åˆ°äº†ä»£ç å†²çªï¼Œè§£å†³å†²çªç„¶å<br>git add .<br>git cherry-pick â€“continue</p><p><strong>â€“abort</strong><br>ä»£ç å†²çªï¼Œå–æ¶ˆåˆå¹¶ä»£ç çš„äº‹ä»¶</p><p><strong>â€“quit</strong><br>ä»£ç å†²çªï¼Œæ¨å‡º cherry-pickï¼Œä½†æ˜¯ä¸ä¼šå€’æ“ä½œå‰çš„ä»£ç </p><h3 id="git-fetch"><a href="#git-fetch" class="headerlink" title="git fetch"></a>git fetch</h3><p>å·®ä¸å¤šå¯ä»¥è¿™æ ·ç†è§£<br>git pull = git fetch + git merge<br>æœ€å¸¸ç”¨çš„æ˜¯ï¼Œå¤šäººååŒå¼€å‘ï¼Œåˆ«äººæ–°å»ºçš„åˆ†æ”¯ï¼Œåœ¨ä½  git branch -a çœ‹ä¸åˆ°çš„æ—¶å€™<br>æ‰§è¡Œä¸€ä¸‹ git fetch<br>å®Œäº‹</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯»ã€Šå«Œç–‘äºº X çš„çŒ®èº«ã€‹</title>
    <link href="/2020/09/09/essay0909/"/>
    <url>/2020/09/09/essay0909/</url>
    
    <content type="html"><![CDATA[<h3 id="æ•…äº‹ç®€ä»‹"><a href="#æ•…äº‹ç®€ä»‹" class="headerlink" title="æ•…äº‹ç®€ä»‹"></a>æ•…äº‹ç®€ä»‹</h3><p>ç™¾å¹´ä¸€é‡çš„æ•°å­¦å¤©æ‰çŸ³ç¥ï¼Œæ¯å¤©å”¯ä¸€çš„ä¹è¶£ï¼Œä¾¿æ˜¯å»å›ºå®šçš„ä¾¿å½“åº—ä¹°åˆé¤ï¼Œåªä¸ºçœ‹ä¸€çœ¼åœ¨ä¾¿å½“åº—åšäº‹çš„é‚»å±…é–å­ã€‚</p><p>é–å­ä¸å¥³å„¿ç›¸ä¾ä¸ºå‘½ï¼Œå¤±æ‰‹æ€äº†å‰æ¥çº ç¼ çš„å‰å¤«ã€‚çŸ³ç¥æå‡ºç”±ä»–æ–™ç†å–„åã€‚çŸ³ç¥è®¾äº†ä¸€ä¸ªåŒªå¤·æ‰€æ€çš„å±€ï¼Œä»¤è­¦æ–¹å§‹ç»ˆåªèƒ½åœ¨å¤–å›´æ•²æ•²æ‰“æ‰“ï¼Œæ ¹æœ¬æ— æ³•ä¸æ¡ˆå­æ²¾è¾¹ã€‚</p><p>æ•…äº‹ä¸­æœ‰æ’å™å’Œæ­£ç»­äº¤äº’ä¸æ–­çš„ç»„ä»¶ä¸°å¯Œæ•´ä¸ªæ•…äº‹ï¼Œä¸å¦‚è®©æˆ‘æ‹ä¸€æ‹</p><p>çŸ³ç¥ä¸æ±¤å·æ˜¯å¤§å­¦åŒå­¦ï¼Œä¸¤ä¸ªé«˜æ™ºå•†çš„äººåœ¨å¤§å­¦é‡Œå°±æ˜¯å¥½å‹ã€‚<br>ä¸–ç•Œæ€»æ˜¯ç°å®çš„ï¼Œæ‰€ä»¥çŸ³ç¥æ¯•ä¸šåçš„ç”Ÿæ´»ä¹Ÿå¹¶ä¸å¦‚æ„ï¼Œæœ€åæˆä¸ºäº†ä¸€ä¸ªä¸è¢«å­¦ç”Ÿå–œæ¬¢çš„æ•°å­¦è€å¸ˆã€‚å®é™…ä¸Šå­¦ç”Ÿåªæ˜¯ä¸å–œæ¬¢æ•°å­¦å§<br>çŸ³ç¥é€æ¸çš„è§‰å¾—ç”Ÿæ´»å¤±å»äº†æ„ä¹‰ï¼Œæ²¡æœ‰æœ‹å‹ï¼Œæ²¡æœ‰çˆ±äººï¼Œæ²¡æœ‰äº²äººï¼Œåªæœ‰æ•°å­¦ï¼Œåªæœ‰è‡ªå·±ã€‚<br>æ—¶é—´ä¹…äº†ï¼Œè¿è‡ªå·±ä¹Ÿä¸æƒ³è¦äº†<br>åªä¼šæ•°å­¦ï¼Œä½†æ˜¯åœ¨æ•°å­¦é¢†åŸŸè‡ªå·±ä¸ä¼šæœ‰å‘å±•<br>è¿™ç§ä¸€çœ¼çœ‹åˆ°å¤´çš„æ—¥å­ï¼Œæœ‰ä»€ä¹ˆæ„ä¹‰<br>çŸ³ç¥å†³å®šè‡ªæ€<br>è‡ªæ€è¿‡ç¨‹è¢«æ–°é‚»å±…æ•²é—¨æ‰“æ–­ï¼Œæ‰“å¼€é—¨ï¼Œæ˜¯ä¸€å¯¹æ¯å¥³ã€‚æ¯äº²é–å­å’Œå¥³å„¿ç¾é‡Œ<br>é‚£ä¸€ç¬é—´åº”è¯¥æ˜¯å¾ˆç¾å¥½ï¼Œä»¥è‡³äºè®©çŸ³ç¥å†³å®šç»§ç»­ç”Ÿæ´»<br>å¾—çŸ¥é–å­åœ¨ä¸€å®¶ä¾¿å½“åº—ä¸Šç­ï¼ŒçŸ³ç¥å°±æ¯å¤©éƒ½å»<br>æ¯å¤©åƒåŒä¸€ç§ä¾¿å½“ï¼Œæ¯å¤©çœ‹é–å­ä¸€çœ¼ï¼Œæ¯å¤©è·¯è¿‡æ»¡æ˜¯æµæµªæ±‰çš„æ¡¥<br>æ¯å¤©éƒ½ä¸€æ ·<br>ç›´åˆ°é–å­å’Œç¾é‡Œå¤±æ‰‹æ€äº†äºº<br>æ€çš„æ˜¯ä¸åœçº ç¼ é–å­çš„é–å­å‰å¤«<br>äºæ˜¯çŸ³ç¥å†³å®šå¸®åŠ©æ¯å¥³ç’å¤©è¿‡æµ·<br>å†é«˜æ™ºå•†çš„äººæƒ³è¦å®Œç¾çš„éšè—çŠ¯ç½ªä¹Ÿå¾ˆå›°éš¾<br>æ‰€ä»¥çŸ³ç¥å†³å®šç”¨è‡ªå·±æ¢æ¯å¥³çš„ä¸‹åŠç”Ÿå¹¸ç¦<br>çŸ³ç¥åœ¨æ¯å¥³æ€äººç¬¬äºŒå¤©ï¼Œæ€äº†ä¸€ä¸ªæµæµªæ±‰<br>æŠŠæµæµªæ±‰ä¼ªè£…æˆå‰ä¸€å¤©æ­»æ‰çš„é–å­å‰å¤«çš„èº«ä»½<br>åˆ©ç”¨æ—¶é—´å·®ï¼Œè®©æ¯å¥³æ‘†è„±äº†å«Œç–‘<br>å¯æ˜¯ä»–ä»¬é‡è§äº†ååŠ©è­¦å¯Ÿç ´æ¡ˆçš„æ±¤å·<br>æ±¤å·è¯†ç ´äº†çŸ³ç¥çš„è®¡è°‹ï¼Œä½†æ˜¯æ²¡æœ‰è¯æ®<br>çŸ³ç¥è‡ªé¦–<br>çœŸç›¸ä¼šæ°¸è¿œçš„è¢«åŸ‹è—<br>å¯æƒœ<br>æ±¤å·æ—¢ç„¶å·²ç»è¯†ç ´ï¼Œåˆæ€èƒ½è®©çœŸç›¸è¢«åŸ‹è—<br>æ±¤å·å‘Šè¯‰äº†é–å­çœŸç›¸<br>é–å­è‡ªé¦–</p><p>æ•…äº‹å¤§æ¦‚å°±æ˜¯è¿™æ ·</p><h3 id="äººç‰©ç†è§£ä¸ä¸ªäººè§è§£"><a href="#äººç‰©ç†è§£ä¸ä¸ªäººè§è§£" class="headerlink" title="äººç‰©ç†è§£ä¸ä¸ªäººè§è§£"></a>äººç‰©ç†è§£ä¸ä¸ªäººè§è§£</h3><h4 id="çŸ³ç¥è‡ªæ€"><a href="#çŸ³ç¥è‡ªæ€" class="headerlink" title="çŸ³ç¥è‡ªæ€"></a>çŸ³ç¥è‡ªæ€</h4><p>çŸ³ç¥è‡ªæ€ï¼Œæ˜¯å¯¹è‡ªå·±çš„ä»·å€¼äº§ç”Ÿäº†æ€€ç–‘ï¼Œç”Ÿæ´»æ¯ç‡¥ä¹å‘³ï¼Œè‡ªèº«ä»·å€¼æ— æ³•å®ç°ã€‚<br>æ´»ç€ä¸ºäº†ä»€ä¹ˆå‘¢ï¼Ÿ<br>å½“ä¸€ä¸ªäººæŠ›å¼€æƒ…æ¬²ï¼Œæˆ–è€…æ˜¯å¤±å»æƒ…æ¬²çš„æ—¶å€™ï¼Œæ´»ç€æ˜¯ä»€ä¹ˆï¼Ÿ<br>æŠŠå„ç§é£Ÿç‰©è½¬åŒ–ä¸ºç²ªä¾¿ï¼Ÿ<br>ç¹è¡åä»£ï¼Ÿ<br>å½“äººæ²¡æœ‰æƒ…æ¬²ä»¥å<br>ç”Ÿå‘½å°±æ˜¯é™æ­¢çš„<br>æ˜¯ä¸‡åˆ†ä¹‹ä¸€çš„å…‰æ™¯ï¼Œä¹Ÿæ˜¯å››ä¸‡å…«åƒå¹´çš„æ°¸æ’<br>æ˜¯ç»“æŸä¹Ÿæ˜¯å¼€å§‹<br>æ˜¯æ­»ä¹Ÿæ˜¯ç”Ÿ<br>åŸºæœ¬ä¸Šå°±æˆä»™æˆä½›äº†<br>é‚£æ—¶å€™è¿˜è°ˆä»€ä¹ˆç”Ÿå‘½æ„ä¹‰ï¼Œè‡ªæˆ‘ä»·å€¼<br>éƒ½æ˜¯ç©ºï¼Œéƒ½æ˜¯æ— ï¼Œéƒ½æ˜¯ç‹—å±<br>æ‰€ä»¥è¯´æ´»ç€å¾—æœ‰æƒ…æ¬²å•Š<br>æ•°å­¦æ˜¯æ— èŠçš„ï¼Œæˆ‘ä¹Ÿä¸å–œæ¬¢<br>å¥³äººä¸æ˜¯æ— èŠçš„ï¼Œæˆ‘å¾ˆå–œæ¬¢<br>çŸ³ç¥ä¹Ÿå¾ˆå–œæ¬¢ï¼Œæ‰€ä»¥ä»–é€‰æ‹©äº†æ´»ä¸‹æ¥<br>æœ‰æ—¶å€™ï¼Œä¸€ä¸ªäººåªè¦å¥½å¥½æ´»ç€ï¼Œå°±è¶³ä»¥æ‹¯æ•‘æŸä¸ªäºº<br>ä½†æ˜¯æˆ‘è§‰å¾—é‚£ä¸€ç¬é—´ä»–çš„æƒ…æ„Ÿæ˜¯åŠå…¶ä¸°å¯Œå¤æ‚çš„<br>è¦æœ‰å¯¹æ­»äº¡æœ¬èƒ½çš„ææƒ§<br>æœ‰å¯¹ç”Ÿå‘½æœ¬èƒ½çš„æ¸´æœ›<br>æœ‰å¯¹çˆ±æƒ…çš„æ†§æ†¬å‘å¾€<br>ä¹Ÿè¦æœ‰å¯¹ä¸–ç•Œé‡æ–°äº§ç”Ÿçš„ä¸€ç‚¹å¥½å¥‡<br>è‡³äºä»€ä¹ˆæ´»ç€çš„ä»·å€¼ï¼Œç”Ÿå‘½çš„æ„ä¹‰è¿™ç§é—®é¢˜å˜›<br>å¦‚æœæˆ‘çš„èƒ½åŠ›åªèƒ½è®©æˆ‘ç©·å›°æ½¦å€’ï¼Œé‚£ä¹ˆç©·å›°æ½¦å€’å°±æ˜¯æˆ‘çš„ä»·å€¼<br>ä¸å¿…åœ¨åƒå–å«–èµŒèºæ­Œç‡•èˆä¸­å¯»æ‰¾æ„ä¹‰ï¼Œæ´»ç€æœ¬èº«å°±æ˜¯ä¸€ç§æ„ä¹‰<br>å°±å¹³å¹³æ·¡æ·¡æ™®æ™®é€šé€šçš„ç”Ÿæ´»å‘—<br>åœ¨å¹³æ·¡ä¸­åŠ ä¸€ç‚¹ç‚¹æƒ…è¶£<br>çƒŸå•Šé…’å•Šè¿åŠ¨å•Šæ•´ç‚¹å•¥ä¸è¡Œå•Š<br>å†åŠ ä¸€ç‚¹ç‚¹è‰²æƒ…<br>è¿™é‡Œçœç•¥å‡ ç™¾å­—ä»¥å…è·‘å<br>å†æ•´ç‚¹ç¾é£Ÿå¥½åƒçš„<br>å¤©å—æµ·åŒ—é‚£ä¹ˆå¤šå¥½åƒçš„æƒ³æƒ³éƒ½æµå£æ°´<br>å¦‚æœé‡åˆ°äº†å›°éš¾<br>å¦‚æœæŒ£æ‰åœ¨ä½è°·<br>æ— è®ºå¦‚ä½•éƒ½è¦æ´»ä¸‹å»å•Š</p><h4 id="çŸ³ç¥æ€äºº"><a href="#çŸ³ç¥æ€äºº" class="headerlink" title="çŸ³ç¥æ€äºº"></a>çŸ³ç¥æ€äºº</h4><p>åœ¨çˆ±æƒ…é‡Œé¢æ··å…¥å¤ªå¤šæƒ…æ„Ÿä»¥åï¼Œè¿™ä»½çˆ±å°±ä¼šå˜å¾—æ‰­æ›²ã€‚<br>ä½†æ˜¯è¿™ç§æ‰­æ›²å¹¶ä¸å½±å“çˆ±å­˜åœ¨ç€<br>çŸ³ç¥çˆ±çš„æ‰­æ›²å¹¶ä¸”æè‡´<br>æ„¿æ„ä¸ºäº†çˆ±ä»˜å‡ºä¸€åˆ‡ï¼Œä¸è®¡åæœï¼Œä¸æ±‚å›æŠ¥<br>è‡ªç§çš„è®²ï¼Œèƒ½è¢«è¿™æ ·çˆ±ç€ä¹ŸæŒºå¹¸ç¦çš„<br>çŸ³ç¥é€‰äº†ä¸€æ¡é€€æ— å¯é€€çš„è·¯ï¼Œä¸ç®¡æ˜¯ä¸ºäº†çˆ±æƒ…ï¼Œè¿˜æ˜¯ä¸ºäº†æ”¯æ’‘ä»–æ´»ä¸‹å»çš„ä¿¡å¿µ<br>ä»–å¾—è¿™ä¹ˆåšï¼Œä»–å¿…é¡»è¿™ä¹ˆåš<br>ä»–å¯ä»¥æ‰¿æ‹…ä¸‹æ‰€æœ‰çš„ç½ªè´£<br>ä»–æ„¿æ„æ‰¿å—å†…å¿ƒçš„ç…ç†¬<br>ä¹Ÿè®¸æ˜¯å¤œå¤œæ— ä¼‘æ­¢çš„å™©æ¢¦<br>ä¹Ÿè®¸æ˜¯è€³è¾¹è‹¥æœ‰è‹¥æ— çš„å¹»å¬<br>ä»–å¿…é¡»è¿™ä¹ˆåš<br>ä»–è¦æ€äºº<br>æƒ³èµ·ä¸€é¦–æ­Œï¼Œ<br>ã€Škill for youã€‹<br>you gonna make me a believer<br>enen if that shit ainâ€™t true<br>you gonna make me commit murder<br>baby iâ€™d kill for you</p><p>åˆ«è¯´ä»€ä¹ˆå€¼ä¸å€¼å¾—<br>æˆ‘æ„¿æ„å»åšï¼Œé‚£å°±éƒ½å€¼å¾—<br>é€»è¾‘çš„å°½å¤´ï¼Œä¸æ˜¯ç†æ€§ä¸ç§©åºçš„ç†æƒ³å›½ï¼Œè€Œæ˜¯æˆ‘ç”¨ç”Ÿå‘½å¥‰çŒ®çš„çˆ±æƒ…ã€‚</p><h4 id="é–å­"><a href="#é–å­" class="headerlink" title="é–å­"></a>é–å­</h4><p>æˆ‘çœ‹ä¹¦çš„æ—¶å€™å°±ä¸€ç›´ä¸å¤ªå–œæ¬¢é–å­<br>ä¸æ˜¯å› ä¸ºå¥¹ä¸é€‰æ‹©çŸ³ç¥<br>ç›¸åå¥¹ä¸é€‰æ‹©çŸ³ç¥å€’è®©æˆ‘å¯¹å¥¹æœ‰äº†ä¸€ä¸å¥½æ„Ÿ<br>ä¸çŸ¥é“è¯´å•¥<br>å¥¹æ˜¯è¢«å‘½è¿æ¨ç€èµ°çš„<br>äººç”Ÿä¸­åšäº†å‡ æ¬¡é€‰æ‹©éƒ½é”™è¯¯<br>å”¯ä¸€ä¸€æ¬¡æ­£ç¡®çš„è¿˜è¢«æ±¤å·ç ´åäº†</p><p>æ¥å—çŸ³ç¥ï¼Ÿ<br>ä¸ä¸ä¸<br>ä¸”ä¸è¯´å–œæ¬¢ä¸å–œæ¬¢<br>çŸ³ç¥è¿™ä»½çˆ±å¤ªè¿‡æ²‰é‡<br>ä¸çŸ¥é“è¿˜å¥½<br>çŸ¥é“äº†å°±ä¼šè¢«å‹åˆ°æ— æ³•å–˜æ¯<br>çˆ±æƒ…æ˜¯è¦è½»æ¾çš„ï¼Œå¿«ä¹çš„<br>ç»ä¸èƒ½æ˜¯æ²‰é‡çš„ï¼Œå‹æŠ‘çš„<br>æœ€åçŸ¥é“çœŸç›¸çš„é–å­å»è‡ªé¦–<br>ä¹Ÿä¸€å®šæ˜¯å› ä¸ºè¿™ç§å‹æŠ‘</p><p>çˆ±æƒ…é‡Œåªè¦æœ‰ä¸€æ–¹çˆ±çš„è¿‡ç«ï¼Œçˆ±æƒ…å°±ä¸ä¼šé•¿ä¹…<br>ç”šè‡³ä¼šæœ‰å±é™©<br>è¿‡åˆ†çš„çˆ±å®¹æ˜“äº§ç”Ÿå¼ºçƒˆåˆ°æ‰­æ›²çš„å æœ‰æ¬²ã€æ§åˆ¶æ¬²</p><h4 id="æ±¤å·"><a href="#æ±¤å·" class="headerlink" title="æ±¤å·"></a>æ±¤å·</h4><p>åªè¦æ±¤å·å‡ºç°ï¼Œè¿™ä¸ªæ•…äº‹çš„ç»“å±€å°±æ³¨å®šæ˜¯æ‚²å‰§äº†ã€‚<br>è™½ç„¶æ€äººæ”¾ç«ï¼Œæ‰¿æ‹…åæœæ˜¯æ”¿æ²»æ­£ç¡®<br>ä½†æ˜¯æˆ‘è¿˜çœŸæŒºå¸Œæœ›é–å­å¦‚çŸ³ç¥æ‰€æœŸå¾…é‚£æ ·ï¼Œå¹¸ç¦çš„ç”Ÿæ´»ä¸‹å»<br>æœ‰äº›çœŸç›¸æ³¨å®šæ˜¯è¦å°å¿ƒç¿¼ç¿¼æ·±åŸ‹å¿ƒåº•çš„ï¼Œå› ä¸ºç­”æ¡ˆæ­æ™“çš„é‚£ä¸€åˆ»ï¼Œä¹Ÿæ˜¯ç°é£çƒŸç­çš„å¼€å§‹ã€‚<br>å¯æ˜¯å½“æ±¤å·çŸ¥é“äº†çœŸç›¸ä»¥åï¼Œä»–æ€å¯èƒ½æ·±åŸ‹å¿ƒåº•<br>ä»–è‰¯å¿ƒéš¾å®‰å•Š<br>ä»–æ— æ³•å…è®¸è‡ªå·±ç”Ÿå‘½ä¸­å‘ç”Ÿè¿™æ ·çš„äº‹æƒ…å•Š<br>çŸ³ç¥æ€äº†äººï¼Œåº”è¯¥å—åˆ°æƒ©ç½š<br>é–å­æ€äº†äººï¼Œä¹Ÿåº”è¯¥å—åˆ°æƒ©ç½šæ‰å¯¹<br>å¦‚æœè‡ªå·±çŸ¥é“äº†çœŸç›¸å´æ·±åŸ‹å¿ƒåº•ï¼Œä¸æ€äººæ— å¼‚å•Š<br>è¿™ä¸ªä¸–ä¸Šæ²¡æœ‰æ— ç”¨çš„é½¿è½®ï¼Œåªæœ‰é½¿è½®è‡ªèº«æ‰èƒ½å†³å®šè‡ªå·±çš„ç”¨é€”ã€‚<br>å¯æ˜¯<br>å¦‚æœæ­å¼€çœŸç›¸åªä¼šå¸¦æ¥æ›´å¤šç—›è‹¦ï¼Œé‚£æˆ‘ä»¬ä¸€ç›´ä»¥æ¥è¿½æ±‚çš„ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p><h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>æˆ‘å¾ˆæƒ³æŠŠè¯»åæ„Ÿå†™çš„è¯¦ç»†ï¼Œåœ¨æ¯ä¸€ä¸ªæˆ‘æœ‰æ„Ÿè§¦çš„ç‚¹éƒ½åšè®°å½•ã€‚ä½†æ˜¯ä¹Ÿæ— æ‰€è°“ï¼Œéšç€æ—¶é—´å’Œç»å†ï¼Œå¯¹æ•…äº‹çš„ç†è§£ä¼šä¸åŒï¼Œå¦‚æœæƒ³å†™ï¼Œåç»­å†è¡¥å……ã€‚</p><p>å·¥è—¤é‚¦æ˜å…ˆç”Ÿæ˜¯ä¸ªè¯šå®å¯é çš„äººã€‚å’Œä»–ç»“å©šï¼Œä½ å’Œç¾é‡Œè·å¾—å¹¸ç¦çš„å‡ ç‡è¾ƒé«˜ã€‚æŠŠæˆ‘å®Œå…¨å¿˜è®°ï¼Œä¸è¦æœ‰ä»»ä½•è´Ÿç½ªæ„Ÿã€‚å¦‚æœä½ è¿‡å¾—ä¸å¹¸ç¦ï¼Œæˆ‘æ‰€åšçš„ä¸€åˆ‡æ‰æ˜¯å¾’åŠ³</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦å¿ƒå¾—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å«Œç–‘äºº X çš„çŒ®èº«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨webSocketå®Œæˆå‰åç«¯äº¤äº’</title>
    <link href="/2020/09/09/webSocket/"/>
    <url>/2020/09/09/webSocket/</url>
    
    <content type="html"><![CDATA[<h2 id="webSocket"><a href="#webSocket" class="headerlink" title="webSocket"></a>webSocket</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>WebSocket æ˜¯ HTML5 å¼€å§‹æä¾›çš„ä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ã€‚<br>æ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®<br>åœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦åšä¸€ä¸ªæ¡æ‰‹çš„åŠ¨ä½œï¼Œç„¶åï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å°±å½¢æˆäº†ä¸€æ¡å¿«é€Ÿé€šé“ã€‚ä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥æ•°æ®äº’ç›¸ä¼ é€ã€‚<br>ç›´ç™½ä¸€ç‚¹è¯´ï¼Œæƒ³åšä¸€ä¸ªç±»ä¼¼äºæ¶ˆæ¯æ¨é€çš„åŠŸèƒ½ï¼Œå¤§æ¦‚èƒ½æƒ³åˆ°ä¸¤ç§æ–¹æ³•<br>ç¬¬ä¸€ç§å°±æ˜¯ ajax è½®è¯¢ï¼Œæ•´ä¸€ä¸ªå®šæ—¶å™¨ä¸åœçš„è°ƒç”¨åç«¯æ¥å£<br>å¦ä¸€ç§å°±æ˜¯ç”¨ webSocketï¼Œè®©æœåŠ¡å™¨ç«¯å¯ä»¥ä¸»åŠ¨çš„å‘æ¶ˆæ¯ç»™æµè§ˆå™¨ç«¯<br>æ‰€ä»¥ä½ çœ‹ï¼Œè¿˜æ˜¯ webSocket å¥½å•Š</p><p>å½“ä½ è·å– Web Socket è¿æ¥åï¼Œä½ å¯ä»¥é€šè¿‡ send() æ–¹æ³•æ¥å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œå¹¶é€šè¿‡ onmessage äº‹ä»¶æ¥æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€‚<br>ä»¥ä¸‹ API ç”¨äºåˆ›å»º WebSocket å¯¹è±¡ã€‚<br><code>var Socket = new WebSocket(url, [protocol] );</code><br>ä»¥ä¸Šä»£ç ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•° url, æŒ‡å®šè¿æ¥çš„ URLã€‚ç¬¬äºŒä¸ªå‚æ•° protocol æ˜¯å¯é€‰çš„ï¼ŒæŒ‡å®šäº†å¯æ¥å—çš„å­åè®®ã€‚</p><p>æ€»è§‰å¾—è¦è‡ªå·±ç©ä¸€æ¬¡æ‰æ›´å¥½ç†è§£è¿™ä¸ªï¼Œçœ‹æ¥å¯¹ node çš„å­¦ä¹ è¦æä¸Šæ—¥ç¨‹äº†ã€‚</p><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">"wss://echo.websocket.org"</span>);ws.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Connection open ..."</span>);  ws.send(<span class="hljs-string">"Hello WebSockets!"</span>);&#125;;ws.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>&#123;  <span class="hljs-built_in">console</span>.log( <span class="hljs-string">"Received Message: "</span> + evt.data);  ws.close();&#125;;ws.onclose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Connection closed."</span>);&#125;;</code></pre><p>webSocket æ‰©å±•ï¼Œå¿ƒè·³æ£€æµ‹ï¼Œæ•°æ®åŠ å¯†ï¼Œèº«ä»½è®¤è¯ç­‰çŸ¥è¯†ç‚¹ã€‚</p><h3 id="æ’ä»¶åŠä½¿ç”¨"><a href="#æ’ä»¶åŠä½¿ç”¨" class="headerlink" title="æ’ä»¶åŠä½¿ç”¨"></a>æ’ä»¶åŠä½¿ç”¨</h3><p>ä½¿ç”¨äº†ä¸€ä¸ª webSocket çš„æ’ä»¶å«åš sockjs-clientï¼Œå°è£…ç»„ä»¶å¦‚ä¸‹</p><pre><code class="hljs typescript"><span class="hljs-comment">/**</span><span class="hljs-comment"> * WebSocket Client</span><span class="hljs-comment"> */</span><span class="hljs-keyword">import</span> &#123; useEffect, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;<span class="hljs-keyword">import</span> SockJS <span class="hljs-keyword">from</span> <span class="hljs-string">'sockjs-client'</span>;<span class="hljs-keyword">import</span> Stomp <span class="hljs-keyword">from</span> <span class="hljs-string">'stompjs'</span>;<span class="hljs-keyword">import</span> &#123; getToken &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/Enhanced'</span>;  <span class="hljs-comment">//  é¡¹ç›®ç”¨è·å–tokençš„æ–¹æ³•ï¼Œå¯ä»¥å¿½ç•¥ä¸ç®¡</span><span class="hljs-keyword">const</span> Index = <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> &#123;  <span class="hljs-keyword">const</span> &#123; url, options, connect = &#123;&#125;, observers = [], disconnect = &#123;&#125;, children &#125; = props;  <span class="hljs-keyword">const</span> newUrl = url.includes(<span class="hljs-string">'?'</span>) ? url : <span class="hljs-string">`<span class="hljs-subst">$&#123;url&#125;</span>?token=<span class="hljs-subst">$&#123;getToken()&#125;</span>`</span>;  <span class="hljs-keyword">const</span> [client, setClient] = useState(<span class="hljs-literal">null</span>);  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    <span class="hljs-keyword">const</span> newClient = Stomp.over(<span class="hljs-keyword">new</span> SockJS(newUrl, <span class="hljs-literal">null</span>, options));    newClient.debug = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;&#125;;    <span class="hljs-keyword">const</span> &#123; onOpen, onError &#125; = connect;    newClient.connect(      connect.headers || &#123;&#125;,      () =&gt; &#123;        <span class="hljs-keyword">if</span> (onOpen) &#123;          onOpen();        &#125; <span class="hljs-keyword">else</span> &#123;          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'CONNECTED'</span>);        &#125;        setClient(newClient);      &#125;,      error =&gt; &#123;        <span class="hljs-keyword">if</span> (onError) &#123;          onError();        &#125; <span class="hljs-keyword">else</span> &#123;          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ERROR'</span>, error);        &#125;      &#125;,    );    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (newClient.ws.readyState === SockJS.OPEN) &#123;        <span class="hljs-keyword">const</span> &#123; onClose &#125; = disconnect;        newClient.disconnect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;          <span class="hljs-keyword">if</span> (onClose) &#123;            onClose();          &#125;        &#125;, disconnect.headers);      &#125;    &#125;;  &#125;, []);  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (client) &#123;      observers.forEach(<span class="hljs-function"><span class="hljs-params">observer</span> =&gt;</span> &#123;        <span class="hljs-keyword">const</span> &#123; destination, onMessage &#125; = observer;        <span class="hljs-keyword">if</span> (destination) &#123;          client.subscribe(            destination,            data =&gt; &#123;              <span class="hljs-keyword">try</span> &#123;                onMessage(<span class="hljs-built_in">JSON</span>.parse(data.body));              &#125; <span class="hljs-keyword">catch</span> (e) &#123;                onMessage(data.body);              &#125;            &#125;,            observer.headers,          );        &#125;      &#125;);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (client) &#123;        <span class="hljs-built_in">Object</span>.keys(client.subscriptions).forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;          client.unsubscribe(item);        &#125;);      &#125;    &#125;;  &#125;, [!!client, observers.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.destination).join(<span class="hljs-string">','</span>)]);  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> children === <span class="hljs-string">'function'</span> ? children(client) : children || <span class="hljs-literal">null</span>;&#125;;Index.displayName = <span class="hljs-string">'WsClient'</span>;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Index;</code></pre><h3 id="é¡¹ç›®åº”ç”¨ç›¸å…³æ–‡æ¡£"><a href="#é¡¹ç›®åº”ç”¨ç›¸å…³æ–‡æ¡£" class="headerlink" title="é¡¹ç›®åº”ç”¨ç›¸å…³æ–‡æ¡£"></a>é¡¹ç›®åº”ç”¨ç›¸å…³æ–‡æ¡£</h3><p>é—®é¢˜æè¿°ï¼š<br>å¯¹äº dip-tms-fe é¡¹ç›®çš„é¢„ä¼°æŠ¥ä»·ã€ç»“ç®—æŠ¥ä»·è‡ªåŠ¨åˆ†æåŠŸèƒ½ï¼Œå½“å¾…åˆ†ææ–‡ä»¶æ•°é‡è¿‡å¤šæˆ–<br>æ–‡ä»¶è¿‡å¤§æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå› ç½‘ç»œè¶…æ—¶è€Œå¯¼è‡´ 500 é”™è¯¯ï¼Œå°½ç®¡æ­¤æ—¶åç«¯åˆ†ææœåŠ¡è¿˜åœ¨è¿è¡Œä¸­ã€‚<br>é—®é¢˜åŸå› ï¼š<br>å› æœåŠ¡å™¨é•¿æ—¶é—´æœªå“åº”ï¼Œè¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè€Œå¼•å‘æ­¤é”™è¯¯ã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œåç«¯å¯åé¦ˆ<br>ä¼ªæˆåŠŸï¼Œå³ä»£è¡¨å·²æ”¶åˆ°è¯·æ±‚ã€‚è€Œåï¼ŒåŸºäº WebSocket åŒå·¥é€šä¿¡æœºåˆ¶ï¼Œåœ¨åç«¯å¤„ç†å®Œè¯·æ±‚åï¼Œ<br>ä¸»åŠ¨å‘å‰ç«¯æ¨é€å¤„ç†ç»“æŸæ¶ˆæ¯ã€‚<br>è§£å†³æ–¹æ¡ˆï¼š 1.è§£å†³ WebSocket è¿æ¥è¿‡æ…¢é—®é¢˜ï¼Œæ”¯æŒæ–­åé‡è¿<br>åœ¨é¡µé¢å¤´éƒ¨å¯¼èˆªä¸­å¼•å…¥ WebSocketï¼Œä»¥ä¾¿ç”¨æˆ·åœ¨ç™»å½•æˆåŠŸåï¼Œç«‹å³å¼€å§‹å»ºç«‹è¿æ¥ã€‚é€šè¿‡<br>æŸ¥é˜…èµ„æ–™å‘ç° sockJS æ”¯æŒå¤šç§è¿æ¥æ–¹å¼ï¼šwebsocketï¼Œxdr-streamingï¼Œxhr-streamingï¼Œ<br>eventsourceï¼Œiframe-eventsourceï¼Œhtmlfileï¼Œiframe-htmlfileï¼Œxdr-pollingï¼Œxhr-pollingï¼Œ<br>iframe-xhr-pollingï¼Œjsonp-pollingã€‚å»ºç«‹è¿æ¥æ—¶ä¼šä¾æ¬¡è¿›è¡Œå°è¯•ï¼Œç›´åˆ°è¿æ¥æˆåŠŸã€‚åœ¨æµ‹<br>è¯•æ—¶å‘ç°é‡‡ç”¨â€œxhr-pollingâ€çš„æ–¹å¼è¿æ¥è€—æ—¶æœ€çŸ­ï¼Œå› æ­¤å°†å…¶è®¾ä¸ºé¦–é€‰è¿æ¥æ–¹å¼ã€‚ä¸ºé¿å…<br>å› ç½‘ç»œæ–­å¼€å¯¼è‡´çš„ WebSocket é€šè®¯ä¸­æ–­ï¼Œå› æ­¤æ”¯æŒäº†æ–­åé‡è¿ã€‚<br>urlï¼šç”¨äºå»ºç«‹æ¡æ‰‹è¿æ¥</p><pre><code class="hljs javascript">&lt;WsClient  url=<span class="hljs-string">"/server/api/wsconnect"</span>  observers=&#123;[    &#123;      destination: <span class="hljs-string">`/user/<span class="hljs-subst">$&#123;currentUser.userId&#125;</span>/notice`</span>,      onMessage: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'è®¢é˜…è¿”å›'</span>);        PubSub.publish(<span class="hljs-string">'æ›´æ–°æŠ¥å‘Šåˆ†æç»“æœ'</span>);      &#125;,    &#125;,  ]&#125;/&gt;</code></pre><p>destinationï¼šç»Ÿä¸€ç”¨æˆ·å®šä½ç¬¦ï¼Œèƒ½æŠŠä¸€ä¸ªç”¨æˆ·ç‹¬ä¸€æ— äºŒçš„æ ‡è¯†å‡ºæ¥<br>onMessageï¼šæ¥æ”¶ç”±åç«¯ä¸»åŠ¨å‘å‰ç«¯æ¨é€çš„å„ç§æ¶ˆæ¯<br>coverAndSendï¼šä»¥å¹¿æ’­å½¢å¼ï¼Œå°†æ¶ˆæ¯æ¨é€ç»™æ‰€æœ‰ç”¨æˆ·<br>coverAndSendToUserï¼šå°†æ¶ˆæ¯æ¨é€ç»™æŒ‡å®šç”¨æˆ·</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webSocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>js-proxyå¯¹è±¡ä»£ç†</title>
    <link href="/2020/08/18/js-proxy/"/>
    <url>/2020/08/18/js-proxy/</url>
    
    <content type="html"><![CDATA[<h3 id="What"><a href="#What" class="headerlink" title="What"></a>What</h3><p><strong>Proxy</strong> æ˜¯ ES6 ä¸­æ–°å¢çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥ç”¨æ¥è‡ªå®šä¹‰å¯¹è±¡ä¸­çš„æ“ä½œã€‚<br>Proxy å¯ä»¥ç†è§£æˆï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚â€œæ‹¦æˆªâ€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™ã€‚Proxy è¿™ä¸ªè¯çš„åŸæ„æ˜¯ä»£ç†ï¼Œç”¨åœ¨è¿™é‡Œè¡¨ç¤ºç”±å®ƒæ¥â€œä»£ç†â€æŸäº›æ“ä½œï¼Œå¯ä»¥è¯‘ä¸ºâ€œä»£ç†å™¨â€ã€‚</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener">å®˜ç½‘é“¾æ¥</a></p><h3 id="How"><a href="#How" class="headerlink" title="How"></a>How</h3><pre><code class="hljs aspectj"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>)</code></pre><p>target<br>è¦ä½¿ç”¨ Proxy åŒ…è£…çš„ç›®æ ‡å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬åŸç”Ÿæ•°ç»„ï¼Œå‡½æ•°ï¼Œç”šè‡³å¦ä¸€ä¸ªä»£ç†ï¼‰ã€‚<br>handler<br>ä¸€ä¸ªé€šå¸¸ä»¥å‡½æ•°ä½œä¸ºå±æ€§çš„å¯¹è±¡ï¼Œå„å±æ€§ä¸­çš„å‡½æ•°åˆ†åˆ«å®šä¹‰äº†åœ¨æ‰§è¡Œå„ç§æ“ä½œæ—¶ä»£ç† p çš„è¡Œä¸ºã€‚</p><p>handler.has()<br>in æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚<br>handler.get()<br>å±æ€§è¯»å–æ“ä½œçš„æ•æ‰å™¨ã€‚<br>handler.set()<br>å±æ€§è®¾ç½®æ“ä½œçš„æ•æ‰å™¨ã€‚</p><p>ä¸¾å‡ ä¸ªä¸ª ğŸŒ°</p><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> handler = &#123;    <span class="hljs-keyword">get</span>: function(obj, prop) &#123;        <span class="hljs-keyword">return</span> prop <span class="hljs-keyword">in</span> obj ? obj[prop] : <span class="hljs-number">37</span>;    &#125;&#125;;<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(&#123;&#125;, handler);p.a = <span class="hljs-number">1</span>;p.b = <span class="hljs-literal">undefined</span>;<span class="hljs-built_in">console</span>.log(p.a, p.b);      <span class="hljs-comment">// 1, undefined</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'c'</span> <span class="hljs-keyword">in</span> p, p.c); <span class="hljs-comment">// false, 37</span><span class="hljs-comment">//  è¿™æ˜¯ä¸€æ¡åˆ†å‰²çº¿ ================</span><span class="hljs-comment">//  è½¬å‘æ“ä½œ</span><span class="hljs-keyword">let</span> target = &#123;&#125;;<span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, &#123;&#125;);p.a = <span class="hljs-number">37</span>;   <span class="hljs-comment">// æ“ä½œè½¬å‘åˆ°ç›®æ ‡</span><span class="hljs-built_in">console</span>.log(target.a);    <span class="hljs-comment">// 37. æ“ä½œå·²ç»è¢«æ­£ç¡®åœ°è½¬å‘</span><span class="hljs-comment">//  è¿™ä¹Ÿæ˜¯ä¸€æ¡åˆ†å‰²çº¿  ===================</span><span class="hljs-comment">// ç”¨äºæ ¡éªŒï¼Œä¹Ÿå¾ˆok</span><span class="hljs-keyword">let</span> validator = &#123;  <span class="hljs-keyword">set</span>: function(obj, prop, value) &#123;    <span class="hljs-keyword">if</span> (prop === <span class="hljs-string">'age'</span>) &#123;      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Number</span>.isInteger(value)) &#123;        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'The age is not an integer'</span>);      &#125;      <span class="hljs-keyword">if</span> (value &gt; <span class="hljs-number">200</span>) &#123;        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'The age seems invalid'</span>);      &#125;    &#125;    <span class="hljs-comment">// The default behavior to store the value</span>    obj[prop] = value;    <span class="hljs-comment">// è¡¨ç¤ºæˆåŠŸ</span>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  &#125;&#125;;<span class="hljs-keyword">let</span> person = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(&#123;&#125;, validator);person.age = <span class="hljs-number">100</span>;<span class="hljs-built_in">console</span>.log(person.age);<span class="hljs-comment">// 100</span>person.age = <span class="hljs-string">'young'</span>;<span class="hljs-comment">// æŠ›å‡ºå¼‚å¸¸: Uncaught TypeError: The age is not an integer</span>person.age = <span class="hljs-number">300</span>;<span class="hljs-comment">// æŠ›å‡ºå¼‚å¸¸: Uncaught RangeError: The age seems invalid</span></code></pre><p>è¿˜å¯ä»¥æ‰©å±•æ„é€ å‡½æ•°ï¼Œ<br>è¿˜å¯ä»¥æ“ä½œ domï¼Œæ¯”å¦‚äº’æ¢ä¸¤ä¸ªä¸åŒå…ƒç´ çš„å±æ€§æˆ–ç±»å</p><p>é‡ç‚¹åœ¨äºï¼Œæ‹¦æˆª =&gt; æ“ä½œ<br>è¿™ä¸ªå®˜ç½‘å†™çš„æŒºå…¨é¢ï¼Œå¦‚æœæœ‰éœ€è¦å°±ç‚¹å‡»ä¸Šé¢é‚£ä¸ªé“¾æ¥åˆ°å®˜ç½‘çœ‹å§ï½</p><h3 id="ç›¸å…³"><a href="#ç›¸å…³" class="headerlink" title="ç›¸å…³"></a>ç›¸å…³</h3><h4 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h4><pre><code class="hljs qml"><span class="hljs-comment">//  æˆ‘å†åˆ†å‰²ä¸€æ³¢ ==============================</span><span class="hljs-comment">//  çœ‹äº†ä¸‹é¢èƒ½æ›´å¥½çš„ç†è§£ï¼Œç†è§£ï¼Œä¼šç”¨ï¼Œå°±okï¼ è¿™é‡Œæœ‰ä¸ªreflect ä»£ç ä¸‹é¢æ–‡å­—è§£æä¸€æ³¢</span><span class="hljs-keyword">let</span> onWatch = (obj, setBind, getLogger) =&gt; &#123;  <span class="hljs-keyword">let</span> handler = &#123;    get(target, <span class="hljs-keyword">property</span><span class="hljs-string"></span>, receiver) &#123;      getLogger(target, <span class="hljs-keyword">property</span><span class="hljs-string">)</span>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.get(target, <span class="hljs-keyword">property</span><span class="hljs-string"></span>, receiver)    &#125;,    set(target, <span class="hljs-keyword">property</span><span class="hljs-string"></span>, value, receiver) &#123;      setBind(value, <span class="hljs-keyword">property</span><span class="hljs-string">)</span>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.set(target, <span class="hljs-keyword">property</span><span class="hljs-string"></span>, value)    &#125;  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, handler)&#125;<span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attribute">a</span>: <span class="hljs-number">1</span> &#125;<span class="hljs-keyword">let</span> p = onWatch(  obj,  (v, <span class="hljs-keyword">property</span><span class="hljs-string">) </span>=&gt; &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`ç›‘å¬åˆ°å±æ€§<span class="hljs-subst">$&#123;property&#125;</span>æ”¹å˜ä¸º<span class="hljs-subst">$&#123;v&#125;</span>`</span>)  &#125;,  (target, <span class="hljs-keyword">property</span><span class="hljs-string">) </span>=&gt; &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`'<span class="hljs-subst">$&#123;property&#125;</span>' = <span class="hljs-subst">$&#123;target[property]&#125;</span>`</span>)  &#125;)p.a = <span class="hljs-number">2</span> <span class="hljs-comment">// ç›‘å¬åˆ°å±æ€§aæ”¹å˜</span>p.a <span class="hljs-comment">// 'a' = 2</span></code></pre><p>Reflect æ˜¯ä¸€ä¸ªå†…ç½®çš„å¯¹è±¡ï¼Œå®ƒæä¾›æ‹¦æˆª JavaScript æ“ä½œçš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¸ proxy handlers çš„æ–¹æ³•ç›¸åŒã€‚Reflect ä¸æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œå› æ­¤å®ƒæ˜¯ä¸å¯æ„é€ çš„ã€‚<br>Reflect çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼ˆå°±åƒ Math å¯¹è±¡ï¼‰ã€‚</p><p><em>Reflect.apply(target, thisArgument, argumentsList)</em><br>å¯¹ä¸€ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨æ“ä½œï¼ŒåŒæ—¶å¯ä»¥ä¼ å…¥ä¸€ä¸ªæ•°ç»„ä½œä¸ºè°ƒç”¨å‚æ•°ã€‚å’Œ Function.prototype.apply() åŠŸèƒ½ç±»ä¼¼ã€‚</p><p><em>Reflect.get(target, propertyKey[, receiver])</em><br>è·å–å¯¹è±¡èº«ä¸ŠæŸä¸ªå±æ€§çš„å€¼ï¼Œç±»ä¼¼äº target[name]ã€‚</p><p><em>Reflect.has(target, propertyKey)</em><br>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨æŸä¸ªå±æ€§ï¼Œå’Œ in è¿ç®—ç¬¦ çš„åŠŸèƒ½å®Œå…¨ç›¸åŒ</p><p><em>Reflect.set(target, propertyKey, value[, receiver])</em><br>å°†å€¼åˆ†é…ç»™å±æ€§çš„å‡½æ•°ã€‚è¿”å›ä¸€ä¸ª Booleanï¼Œå¦‚æœæ›´æ–°æˆåŠŸï¼Œåˆ™è¿”å› trueã€‚</p><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> duck = &#123;  name: <span class="hljs-string">'Maurice'</span>,  color: <span class="hljs-string">'white'</span>,  greeting: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Quaaaack! My name is <span class="hljs-subst">$&#123;<span class="hljs-keyword">this</span>.name&#125;</span>`</span>);  &#125;&#125;<span class="hljs-built_in">Reflect</span>.has(duck, <span class="hljs-string">'color'</span>);<span class="hljs-comment">// true</span><span class="hljs-built_in">Reflect</span>.has(duck, <span class="hljs-string">'haircut'</span>);<span class="hljs-comment">// false</span><span class="hljs-comment">//  è¿˜æ˜¯ä¸€ä¸ªåˆ†å‰²çº¿ å“ˆå“ˆ====================</span><span class="hljs-built_in">Reflect</span>.set(duck, <span class="hljs-string">'eyes'</span>, <span class="hljs-string">'black'</span>);<span class="hljs-comment">// returns "true" if successful</span><span class="hljs-comment">// "duck" now contains the property "eyes: 'black'"</span></code></pre><p>æ‰€ä»¥ä¸Šé¢çš„ä»£ç ä¸­<br><code>return Reflect.set(target, property, value)</code><br>è¿™å°±æ˜¯æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å±æ€§ ï¼Œä¾‹å¦‚ target : { property:value }</p><h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><p>ok ï¼Œé‚£è¿™å°±æ˜¯ proxy ç›¸å…³çš„ä¸€äº›å†…å®¹ï¼Œè¿™é‡Œæ˜¯æœ±å†› â¤ï¸ _bye ï½</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>js-proxy æ‹¦æˆªå¯¹è±¡ å¯¹è±¡ä»£ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>immerä¸€ä¸ªå¾ˆé…·çš„immutableåº“</title>
    <link href="/2020/08/17/immer/"/>
    <url>/2020/08/17/immer/</url>
    
    <content type="html"><![CDATA[<p>immer æ˜¯ä¸€ä¸ªç”¨ C ++ ç¼–å†™çš„å¯æŒä¹…åŒ–å’Œä¸å¯æ›´æ”¹çš„æ•°æ®ç»“æ„åº“ã€‚</p><p>å¯æŒä¹…åŒ–æ„å‘³ç€ä¿®æ”¹æ•°æ®ç»“æ„æ—¶ï¼Œå°†ä¿ç•™æ—§å€¼ã€‚</p><p>ä¸å¯æ›´æ”¹æ„å‘³ç€æ‰€æœ‰çš„æ“ä½œæ–¹æ³•éƒ½æ˜¯ constã€‚</p><p>ä»£ç æ›´ä¼˜é›…ï¼Œå¯è¯»æ€§å¥½ä¸€äº›ã€‚<br>è‡³äºç”¨è¿™ä¸ªçš„å¿…è¦æ€§ï¼Œè€å®è¯´ä¹Ÿä¸å¤§ï¼Œäº†è§£å°±è¡Œã€‚</p><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> produce <span class="hljs-keyword">from</span> <span class="hljs-string">'immer'</span>;<span class="hljs-keyword">const</span> &#123; zhujun &#125; = <span class="hljs-keyword">this</span>.state;<span class="hljs-keyword">this</span>.setState(&#123;  zhujun:[    &#123;      ...zhujun[<span class="hljs-number">0</span>],      age:zhujun[<span class="hljs-number">0</span>].age += <span class="hljs-number">1</span>    &#125;,    ...members.slice(<span class="hljs-number">1</span>)  ]&#125;)<span class="hljs-keyword">this</span>.setState(produce(<span class="hljs-function"><span class="hljs-params">draft</span>=&gt;</span>&#123;  draft.zhujun[<span class="hljs-number">0</span>].age+=<span class="hljs-number">1</span>&#125;))<span class="hljs-comment">//  ä¸€äº›ç”¨æ³• é¡¹ç›®é‡Œéšä¾¿æ‰¾çš„</span> <span class="hljs-keyword">const</span> newValue = produce(value, <span class="hljs-function"><span class="hljs-params">draftState</span> =&gt;</span> &#123;    draftState = <span class="hljs-function">(<span class="hljs-params">draftState || []</span>).<span class="hljs-params">map</span>(<span class="hljs-params">(<span class="hljs-params">item, index</span>) =&gt; (<span class="hljs-params">&#123;</span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">      ...item,</span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">      key: item.key || item.id || `ID-$&#123;index&#125;`,</span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">    &#125;</span>)</span>);</span><span class="hljs-function"></span><span class="hljs-function">    <span class="hljs-params">if</span> (<span class="hljs-params">constraintType === '+'</span>) &#123;</span><span class="hljs-function">      <span class="hljs-params">if</span> (<span class="hljs-params">draftState.length === 0</span>) &#123;</span><span class="hljs-function">        <span class="hljs-params">draftState</span>.<span class="hljs-params">push</span>(<span class="hljs-params">&#123;</span></span><span class="hljs-function"><span class="hljs-params">          key: keyZero,</span></span><span class="hljs-function"><span class="hljs-params">          ...(<span class="hljs-params"><span class="hljs-keyword">typeof</span> createTemplate === '<span class="hljs-keyword">function</span>' ? createTemplate(<span class="hljs-params"></span>) : createTemplate</span>),</span></span><span class="hljs-function"><span class="hljs-params">          unsaved: <span class="hljs-literal">true</span>,</span></span><span class="hljs-function"><span class="hljs-params">        &#125;</span>);</span><span class="hljs-function">      &#125;</span><span class="hljs-function"></span><span class="hljs-function">      <span class="hljs-params">if</span> (<span class="hljs-params">draftState.length === 1</span>) &#123;</span><span class="hljs-function">        <span class="hljs-params">draftState</span>[0].<span class="hljs-params">closable</span> = <span class="hljs-params">false</span>;</span><span class="hljs-function">      &#125; <span class="hljs-params">else</span> &#123;</span><span class="hljs-function">        <span class="hljs-params">draftState</span>[0].<span class="hljs-params">closable</span> = <span class="hljs-params">true</span>;</span><span class="hljs-function">      &#125;</span><span class="hljs-function">    &#125;</span><span class="hljs-function"></span><span class="hljs-function">    <span class="hljs-params">return</span> <span class="hljs-params">draftState</span>;</span><span class="hljs-function">  &#125;);</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>immer immutable</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”¨FormRenderå¿«é€Ÿå¼€å‘è¡¨å•</title>
    <link href="/2020/08/13/form-render/"/>
    <url>/2020/08/13/form-render/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©å­¦ä¹ ç ”ç©¶äº†ä¸€ä¸‹ FormRenderï¼Œè§‰å¾—åœ¨ä¸€äº›è¡¨å•å¤šçš„é¡¹ç›®ï¼Œæˆ–è€…æ˜¯åç«¯æ•°æ®ç»“æ„å¤æ‚çš„é¡¹ç›®ï¼Œå¾ˆé€‚ç”¨ã€‚<br>å¯ä»¥åœ¨è¿™ä¸ªé“¾æ¥é‡Œé¢æ‰¾åˆ°å¿«é€Ÿ /æ‹–æ‹½çš„ å½¢å¼ ç”Ÿæˆè¡¨å•ç»“æ„ ï¼Œå†è‡ªåŠ¨è½¬åŒ–ä¸º json-schema çš„æ ¼å¼<br>æ”¾è¿› FormRender é‡Œé¢ï¼Œå®Œæˆå¿«é€Ÿç”Ÿæˆè¡¨å•<br><a href="https://form-render.github.io/schema-generator/" target="_blank" rel="noopener">è¿™æ˜¯é“¾æ¥</a><br>ä¸‹é¢æ˜¯ä¸€ä¸ªå†™æ»¡äº†æ³¨é‡Šçš„ï¼Œå°½é‡å…¨é¢çš„æ —å­ ğŸŒ°ï¼Œæ³¨å…¥äº†æˆ‘çš„å¿ƒè¡€ï¼<br>ç”¨çš„æ—¶å€™ç”šè‡³å¯ä»¥ç›´æ¥å¤åˆ¶è¿™ä¸ª</p><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;<span class="hljs-keyword">import</span> &#123; Input &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;<span class="hljs-comment">// ä½¿ç”¨ Ant Design ä½“ç³»</span><span class="hljs-keyword">import</span> FormRender <span class="hljs-keyword">from</span> <span class="hljs-string">'form-render/lib/antd'</span>;<span class="hljs-comment">// ä½¿ç”¨ Fusion Design ä½“ç³»</span><span class="hljs-comment">// import FormRender from "form-render/lib/fusion";</span><span class="hljs-comment">//  è¿™äº›å†…å®¹å¯ä»¥åˆ°è¿™ä¸ªåœ°å€æ  https://form-render.github.io/schema-generator/playground</span><span class="hljs-built_in">window</span>.copyMe = <span class="hljs-function">(<span class="hljs-params">list, index</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> item = list[index];  list.splice(index, <span class="hljs-number">0</span>, item);  <span class="hljs-keyword">return</span> list;&#125;;<span class="hljs-keyword">const</span> SiteInput = <span class="hljs-function">(<span class="hljs-params">&#123; value, onChange, name &#125;</span>) =&gt;</span> &#123;  <span class="hljs-keyword">return</span> (    &lt;Input      addonBefore=<span class="hljs-string">"http://"</span>      addonAfter=<span class="hljs-string">".com"</span>      value=&#123;value&#125;      onChange=&#123;e =&gt; onChange(name, e.target.value)&#125;    /&gt;  );&#125;;<span class="hljs-keyword">const</span> schema1 = &#123;  type: <span class="hljs-string">'object'</span>,  <span class="hljs-string">'ui:labelWidth'</span>: <span class="hljs-string">'30%'</span>, <span class="hljs-comment">// ç”¨äºæ§åˆ¶æœ¬å…ƒç´ ä»¥åŠå…¶å­å…ƒç´ ï¼ˆå¦‚æœæœ¬å…ƒç´ æ˜¯å¯¹è±¡æˆ–åˆ—è¡¨ï¼‰çš„æ ‡ç­¾å®½åº¦</span>  <span class="hljs-comment">//  ui:disabled: å¯æ§åˆ¶ inputã€numberã€dateã€checkboxã€radioã€selectã€switch å¯¹äºç»„ä»¶çš„ disabled å±æ€§(å˜ç°ä¸å¯ç‚¹å‡»)</span>  <span class="hljs-comment">//  ui:readonlyï¼šå¯æ§åˆ¶ inputã€number ç»„ä»¶ä¸­çš„ readonly å±æ€§(ä¸å¯ç¼–è¾‘ï¼Œä½†ä¸å˜ç°)</span>  <span class="hljs-comment">//  ui:hiddenï¼šå¯æ§åˆ¶æ‰€æœ‰åŸºç¡€ç»„ä»¶æ˜¯å¦æ˜¾ç¤ºï¼Œå¯ä½¿ç”¨ true/false æˆ–å‡½æ•°è¡¨è¾¾å¼</span>  <span class="hljs-comment">//  ui:classNameï¼šæ·»åŠ ç»„ä»¶ root å…ƒç´ çš„ classNameï¼ˆå’Œ fr-field è¿™ä¸ª className åœ¨åŒçº§ï¼‰ï¼Œç”¨äºè‡ªå®šä¹‰å•ç‹¬ç»„ä»¶çš„æ ·å¼</span>  <span class="hljs-comment">//  ui:widthï¼šå•ä¸ªåŸºç¡€ç»„ä»¶çš„é•¿åº¦ï¼Œå»ºè®®ä½¿ç”¨ç™¾åˆ†æ¯”ä¾‹å¦‚"ui:width":"50%"ã€‚</span>  properties: &#123;    agree: &#123;      title: <span class="hljs-string">'æ˜¯å¦åŒæ„'</span>,      type: <span class="hljs-string">'boolean'</span>,      <span class="hljs-comment">//      titleï¼šè¡¨å•çš„æ ‡é¢˜ä¿¡æ¯ï¼Œä½œä¸º label å±•ç¤ºï¼Œæ³¨æ„ title ä¸º""æ—¶å ä½ï¼Œtitle ä¸å†™æ—¶ä¸å ä½</span>      <span class="hljs-comment">//      descriptionï¼šè¡¨å•çš„æè¿°ä¿¡æ¯ï¼Œå¸¸å°†å¡«å†™æ³¨æ„ç‚¹æ”¾å…¥æ­¤å‚æ•°</span>      <span class="hljs-comment">//      typeï¼šè¡¨å•çš„ç±»å‹ï¼Œæ”¯æŒ stringã€numberã€booleanã€arrayã€objectã€range</span>      <span class="hljs-comment">//      formatï¼šç”¨æ¥æè¿°è¾“å…¥æ¡†çš„æ ¼å¼ï¼Œæ”¯æŒ imageã€dateTimeã€dateã€time</span>      <span class="hljs-comment">//      patternï¼šè‡ªå®šä¹‰æ­£åˆ™æ ¡éªŒï¼Œç”¨äºæ ¡éªŒ string æˆ– number æ•°æ®æ˜¯å¦åˆæ ¼ï¼Œè¯¦ç»†ä½¿ç”¨å¯è§ pattern è‡ªå®šä¹‰æ­£åˆ™æ ¡éªŒ</span>      <span class="hljs-comment">//      message æ ¡éªŒæç¤ºè‡ªå®šä¹‰æ–‡æ¡ˆï¼Œä¸ pattern å…±åŒä½¿ç”¨</span>      <span class="hljs-comment">//      default é»˜è®¤å€¼ï¼Œå¯¹è±¡ç±»å‹ä¸èƒ½ä½¿ç”¨ defaultï¼Œå…¶ä»–ç±»å‹åŒ…æ‹¬ array éƒ½å¯ä»¥ä½¿ç”¨ default</span>    &#125;,    someObj: &#123;      title: <span class="hljs-string">'å¯¹è±¡'</span>,      type: <span class="hljs-string">'object'</span>,      properties: &#123;        personType: &#123;          title: <span class="hljs-string">'ç±»å‹'</span>,          type: <span class="hljs-string">'number'</span>,          enum: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],        &#125;,        age: &#123;          type: <span class="hljs-string">'string'</span>,          title: <span class="hljs-string">'age'</span>,          <span class="hljs-string">'ui:hidden'</span>: <span class="hljs-string">'&#123;&#123;formData.agree==false &amp;&amp; rootValue.personType!=2 &#125;&#125;'</span>,          <span class="hljs-comment">//  ä¸¤ç§å†™æ³•ï¼Œéšä¾¿å–èˆ</span>          <span class="hljs-comment">//  'ui:hidden': (formData, rootValue) =&gt; formData.agree==false,</span>          <span class="hljs-comment">//  formData æ•´ä¸ª form çš„å€¼ ï¼ˆæœ€å¸¸ç”¨ï¼Œå½“ä¸¤ä¸ªå…³è”ç»„ä»¶è·ç¦»è¾ƒè¿œæ—¶ï¼Œå¯ä»¥ä»é¡¶å±‚çš„ formData é‡Œè·å–ï¼‰</span>          <span class="hljs-comment">//  rootValue  çˆ¶ç»„ä»¶çš„å€¼ ï¼ˆæ¯”è¾ƒå¸¸ç”¨ï¼Œä¸Šä¸€çº§çš„å€¼ï¼Œæ–¹ä¾¿ä»ä¸­èƒ½è·å–æ‰€æœ‰å…„å¼Ÿç»„ä»¶çš„å€¼ï¼‰</span>        &#125;,      &#125;,    &#125;,    stringDemo: &#123;      title: <span class="hljs-string">'å­—ç¬¦ä¸²'</span>,      description: <span class="hljs-string">'è‹±æ–‡æˆ–æ•°å­—ç»„åˆ'</span>,      type: <span class="hljs-string">'string'</span>,      pattern: <span class="hljs-string">'^[A-Za-z0-9]+$'</span>,      message: &#123;        pattern: <span class="hljs-string">'è¯·è¾“å…¥æ­£ç¡®æ ¼å¼'</span>,      &#125;,      <span class="hljs-string">'ui:labelWidth'</span>: <span class="hljs-string">'30%'</span>,    &#125;,    imgDemo: &#123;      title: <span class="hljs-string">'å›¾ç‰‡'</span>,      type: <span class="hljs-string">'string'</span>,      format: <span class="hljs-string">'image'</span>,      <span class="hljs-keyword">default</span>: <span class="hljs-string">"'https://img.alicdn.com/tfs/TB1P8p2uQyWBuNjy0FpXXassXXa-750-1334.png'"</span>,    &#125;,    disabledDemo: &#123;      title: <span class="hljs-string">'ä¸å¯ç”¨'</span>,      type: <span class="hljs-string">'string'</span>,      <span class="hljs-keyword">default</span>: <span class="hljs-string">'æˆ‘æ˜¯ä¸€ä¸ªè¢« disabled çš„å€¼'</span>,      <span class="hljs-string">'ui:disabled'</span>: <span class="hljs-literal">true</span>,    &#125;,    url: &#123;      title: <span class="hljs-string">'ç½‘å€'</span>,      type: <span class="hljs-string">'string'</span>,      <span class="hljs-string">'ui:widget'</span>: <span class="hljs-string">'siteInput'</span>,    &#125;,    enumDemo: &#123;      title: <span class="hljs-string">'æšä¸¾'</span>,      enum: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>],      enumNames: [<span class="hljs-string">'æœ±å†›'</span>, <span class="hljs-string">'å¼ æ—­'</span>],    &#125;,    monthpicker: &#123;      title: <span class="hljs-string">'æœˆä»½é€‰æ‹©'</span>,      type: <span class="hljs-string">'string'</span>,      format: <span class="hljs-string">'date'</span>,      <span class="hljs-string">'ui:options'</span>: &#123;        picker: <span class="hljs-string">'month'</span>,      &#125;,    &#125;,    objDemo: &#123;      title: <span class="hljs-string">'å•ä¸ªå¯¹è±¡'</span>,      description: <span class="hljs-string">'è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹'</span>,      type: <span class="hljs-string">'object'</span>,      properties: &#123;        isLike: &#123;          title: <span class="hljs-string">'å•é€‰é¡¹'</span>,          type: <span class="hljs-string">'boolean'</span>,          <span class="hljs-keyword">default</span>: <span class="hljs-literal">true</span>,        &#125;,        background: &#123;          title: <span class="hljs-string">'é¢œè‰²é€‰æ‹©'</span>,          description: <span class="hljs-string">'ç‰¹æ®Šé¢æ¿'</span>,          format: <span class="hljs-string">'color'</span>,          type: <span class="hljs-string">'string'</span>,        &#125;,        oncemore: &#123;          any: <span class="hljs-string">'anthing'</span>,          type: <span class="hljs-string">'object'</span>,          properties: &#123;            oncemoreee: &#123;              title: <span class="hljs-string">'æˆ‘å†æ¥ä¸€å±‚'</span>,              type: <span class="hljs-string">'string'</span>,              <span class="hljs-keyword">default</span>: <span class="hljs-string">'7'</span>,            &#125;,          &#125;,        &#125;,      &#125;,    &#125;,    arrDemo: &#123;      title: <span class="hljs-string">'å¯¹è±¡æ•°ç»„'</span>,      description: <span class="hljs-string">'å¯¹è±¡æ•°ç»„åµŒå¥—åŠŸèƒ½'</span>,      type: <span class="hljs-string">'array'</span>,      minItems: <span class="hljs-number">1</span>,      maxItems: <span class="hljs-number">3</span>,      items: &#123;        type: <span class="hljs-string">'object'</span>,        properties: &#123;          name: &#123;            title: <span class="hljs-string">'å­—ç¬¦åç§°'</span>,            description: <span class="hljs-string">'stringç±»å‹'</span>,            type: <span class="hljs-string">'string'</span>,            pattern: <span class="hljs-string">'^[A-Za-z0-9]+$'</span>,          &#125;,          num: &#123;            title: <span class="hljs-string">'æ•°å­—å‚æ•°'</span>,            description: <span class="hljs-string">'numberç±»å‹'</span>,            type: <span class="hljs-string">'number'</span>,          &#125;,        &#125;,      &#125;,      <span class="hljs-string">'ui:options'</span>: &#123;        buttons: [          &#123;            text: <span class="hljs-string">'Excelå¯¼å…¥'</span>,            icon: <span class="hljs-string">'copy'</span>,            callback: <span class="hljs-string">'someCallback'</span>,          &#125;,          &#123;            text: <span class="hljs-string">'åˆ é™¤å…¨éƒ¨'</span>,            icon: <span class="hljs-string">'delete'</span>,            callback: <span class="hljs-string">'clearAll'</span>,          &#125;,          &#123;            text: <span class="hljs-string">'å¤åˆ¶ä¸Šä¸ª'</span>,            icon: <span class="hljs-string">'copy'</span>,            callback: <span class="hljs-string">'copyLast'</span>,          &#125;,        ],        itemButtons: [          &#123;            text: <span class="hljs-string">'æœ±å†›åœ¨é‡Œé¢å¤åˆ¶'</span>,            icon: <span class="hljs-string">'copy'</span>,            callback: <span class="hljs-string">'copyMe'</span>,          &#125;,        ],      &#125;,    &#125;,  &#125;,  required: [<span class="hljs-string">'stringDemo'</span>, <span class="hljs-string">'dateDemo'</span>],&#125;;<span class="hljs-keyword">const</span> list = &#123;  type: <span class="hljs-string">'array'</span>,  items: &#123;    type: <span class="hljs-string">'object'</span>,    properties: &#123;      x: &#123;        type: <span class="hljs-string">'string'</span>,      &#125;,    &#125;,  &#125;,  <span class="hljs-keyword">default</span>: [&#123; <span class="hljs-attr">x</span>: <span class="hljs-string">'a'</span> &#125;, &#123; <span class="hljs-attr">x</span>: <span class="hljs-string">'b'</span> &#125;],&#125;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Demo</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">const</span> [formData, setData] = useState(&#123;&#125;);  <span class="hljs-keyword">const</span> [valid, setValid] = useState([]);  <span class="hljs-keyword">const</span> onSubmit = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    <span class="hljs-comment">// valid æ˜¯æ ¡éªŒåˆ¤æ–­çš„æ•°ç»„ï¼Œvalid é•¿åº¦ä¸º 0 ä»£è¡¨æ ¡éªŒå…¨éƒ¨é€šè¿‡</span>    <span class="hljs-keyword">if</span> (valid.length &gt; <span class="hljs-number">0</span>) &#123;      alert(<span class="hljs-string">`æ ¡éªŒæœªé€šè¿‡å­—æ®µï¼š<span class="hljs-subst">$&#123;valid.toString()&#125;</span>`</span>);    &#125; <span class="hljs-keyword">else</span> &#123;      alert(<span class="hljs-built_in">JSON</span>.stringify(formData, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));    &#125;  &#125;;  <span class="hljs-keyword">return</span> (    &lt;div style=&#123;&#123; <span class="hljs-attr">maxWidth</span>: <span class="hljs-number">600</span> &#125;&#125;&gt;      &lt;FormRender        schema=&#123;schema1&#125;        formData=&#123;formData&#125;        onChange=&#123;setData&#125;        onValidate=&#123;setValid&#125;        displayType=<span class="hljs-string">"row"</span> <span class="hljs-comment">// è¯¦ç»†é…ç½®è§ä¸‹</span>        widgets=&#123;&#123; <span class="hljs-attr">siteInput</span>: SiteInput &#125;&#125; <span class="hljs-comment">//  è¿™é‡Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶</span>      /&gt;      &#123;<span class="hljs-comment">/* &lt;FormRender</span><span class="hljs-comment">        schema=&#123;list&#125;</span><span class="hljs-comment">        formData=&#123;formData&#125;</span><span class="hljs-comment">        onChange=&#123;setData&#125;</span><span class="hljs-comment">        onValidate=&#123;setValid&#125;</span><span class="hljs-comment">        displayType="row" // è¯¦ç»†é…ç½®è§ä¸‹</span><span class="hljs-comment">      /&gt; */</span>&#125;      &lt;button onClick=&#123;onSubmit&#125; type=<span class="hljs-string">"submit"</span>&gt;        æäº¤      &lt;<span class="hljs-regexp">/button&gt;</span><span class="hljs-regexp">    &lt;/</span>div&gt;  );&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Demo;</code></pre>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FormRender</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°excelçš„æœ¬åœ°é¢„è§ˆ</title>
    <link href="/2020/08/11/preview-excel/"/>
    <url>/2020/08/11/preview-excel/</url>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®æ˜¯å¤–ä¼çš„é¡¹ç›®ï¼Œå®ƒçš„çº¿ä¸ŠæœåŠ¡å™¨èµ„æºæ— æ³•åœ¨å…¬ç½‘è®¿é—®åˆ°ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨å¾®è½¯å…¬å¼€çš„æ¥å£å®ç°é¢„è§ˆ<br>ç”±äºä¸èƒ½ä½¿ç”¨å¾®è½¯æ¥å£åœ¨çº¿é¢„è§ˆ office æ–‡ä»¶ï¼Œæ‰€ä»¥è‡ªå·±å®ç°äº†ä¸€å¥—é¢„è§ˆ excel çš„æ–¹æ¡ˆï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; useState, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;<span class="hljs-keyword">import</span> produce <span class="hljs-keyword">from</span> <span class="hljs-string">'immer'</span>;<span class="hljs-keyword">import</span> XLSX <span class="hljs-keyword">from</span> <span class="hljs-string">'xlsx'</span>;<span class="hljs-keyword">import</span> &#123; Spin &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;<span class="hljs-keyword">import</span> Tabs <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/Enhanced/Tabs'</span>;<span class="hljs-keyword">import</span> &#123; request &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/Enhanced'</span>;<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">'./index.less'</span>;<span class="hljs-keyword">const</span> Index = <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> &#123;  <span class="hljs-keyword">const</span> &#123; src, ...rest &#125; = props;  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (src) &#123;      request(src, &#123;        responseType: <span class="hljs-string">'arraybuffer'</span>,      &#125;).then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (response.success) &#123;          <span class="hljs-keyword">const</span> workbook = XLSX.read(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(response.data), &#123;            type: <span class="hljs-string">'array'</span>,          &#125;);          <span class="hljs-keyword">const</span> newData = produce([], draftState =&gt; &#123;            <span class="hljs-comment">// eslint-disable-next-line</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [k, v] <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.entries(workbook.Sheets)) &#123;              draftState.push(&#123;                name: k,                html: XLSX.utils.sheet_to_html(v),              &#125;);            &#125;            <span class="hljs-keyword">return</span> draftState;          &#125;);          setData(newData);        &#125;      &#125;);    &#125;  &#125;, [src]);  <span class="hljs-keyword">return</span> (    &lt;div &#123;...rest&#125;&gt;      &#123;data ? (        &lt;Tabs          tabPanes=&#123;data.map(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> (&#123;            id: index,            title: item.name,            content: (              &lt;div className=&#123;styles.excel&#125; dangerouslySetInnerHTML=&#123;&#123; <span class="hljs-attr">__html</span>: item.html &#125;&#125; /&gt;            ),          &#125;))&#125;        /&gt;      ) : (        &lt;Spin style=&#123;&#123; <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>, <span class="hljs-attr">margin</span>: <span class="hljs-string">'0 auto'</span> &#125;&#125; /&gt;      )&#125;    &lt;<span class="hljs-regexp">/div&gt;</span><span class="hljs-regexp">  );</span><span class="hljs-regexp">&#125;;</span><span class="hljs-regexp"></span><span class="hljs-regexp">Index.displayName = 'ExcelViewer';</span><span class="hljs-regexp">export default Index;</span></code></pre><p><img src="/img/sheets.png" srcset="/img/loading.gif" alt="å›¾ç‰‡"></p><p>sheet[â€˜!refâ€™]ï¼šè¡¨ç¤ºæ‰€æœ‰å•å…ƒæ ¼çš„èŒƒå›´ï¼Œä¾‹å¦‚ä» A1 åˆ° F8 åˆ™è®°å½•ä¸º A1:F8ï¼›<br>sheet[!merges]ï¼šå­˜æ”¾ä¸€äº›å•å…ƒæ ¼åˆå¹¶ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„ç”±åŒ…å« s å’Œ e æ„æˆçš„å¯¹è±¡ç»„æˆï¼Œs è¡¨ç¤ºå¼€å§‹ï¼Œe è¡¨ç¤ºç»“æŸï¼Œr è¡¨ç¤ºè¡Œï¼Œc è¡¨ç¤ºåˆ—ï¼›</p><table><thead><tr><th>é”®</th><th>æè¿°</th></tr></thead><tbody><tr><td>v</td><td>æºæ•°æ®(æœªç»è¿‡å¤„ç†çš„æ•°æ®)</td></tr><tr><td>w</td><td>æ ¼å¼åŒ–åçš„æ–‡æœ¬(å¦‚æœèƒ½å¤Ÿè¢«æ ¼å¼åŒ–)</td></tr><tr><td>t</td><td>å•å…ƒæ ¼ç±»å‹</td></tr><tr><td>r</td><td>è§£ç åçš„å¯Œæ–‡æœ¬</td></tr><tr><td>h</td><td>æ¸²æŸ“æˆ HTML æ ¼å¼çš„å¯Œæ–‡æœ¬</td></tr><tr><td>c</td><td>å•å…ƒæ ¼æ³¨é‡Š</td></tr><tr><td>z</td><td>æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²çš„æ•°å€¼</td></tr></tbody></table><p>v: â€œzhujunâ€<br>w: â€œzhujunâ€<br>t: â€œsâ€ <code>// s è¡¨ç¤º string ç±»å‹ï¼Œn è¡¨ç¤º number ç±»å‹ï¼Œb è¡¨ç¤º boolean ç±»å‹ï¼Œd è¡¨ç¤º date ç±»å‹ï¼Œç­‰ç­‰</code><br>r: <code>&quot;&lt;t&gt;zhujun&lt;t&gt;&quot;</code><br>h: â€œzhujunâ€</p><p>XLSX.utils.sheet_to_csvï¼šç”Ÿæˆ CSV æ ¼å¼<br>XLSX.utils.sheet_to_txtï¼šç”Ÿæˆçº¯æ–‡æœ¬æ ¼å¼<br>XLSX.utils.sheet_to_htmlï¼šç”Ÿæˆ HTML æ ¼å¼<br>XLSX.utils.sheet_to_jsonï¼šè¾“å‡º JSON æ ¼å¼<br>XLSX.utils.sheet_to_row_object_arrayï¼šæŒ‰æ¯è¡Œæ•°æ®è¾“å‡ºæ•°ç»„</p><p><em>å‡ ä¸ªé‡ç‚¹ï¼š</em></p><ol><li>xlsx æ–¹æ³•çš„ä½¿ç”¨</li><li>immer çš„ä½¿ç”¨</li><li>Object.entries()æ–¹æ³•çš„ä½¿ç”¨</li><li>dangerouslySetInnerHTML çš„ä½¿ç”¨</li></ol><p>Object.entries() å¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡çš„é”®å€¼ä»¥æ•°ç»„çš„å½¢å¼éå†å‡ºæ¥ï¼Œç»“æœå’Œ forâ€¦in ä¸€è‡´ï¼Œä½†ä¸ä¼šéå†åŸå‹å±æ€§ã€‚</p><pre><code class="hljs yaml"><span class="hljs-string">const</span> <span class="hljs-string">arr1</span> <span class="hljs-string">=</span> <span class="hljs-string">[&#123;</span> <span class="hljs-attr">a:</span> <span class="hljs-number">1</span> <span class="hljs-string">&#125;,</span> <span class="hljs-number">2</span><span class="hljs-string">,</span> <span class="hljs-number">3</span><span class="hljs-string">];</span><span class="hljs-string">console.log(Object.entries(arr1));</span>  <span class="hljs-string">//</span> <span class="hljs-string">[['0',</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">a:</span> <span class="hljs-number">1</span> <span class="hljs-string">&#125;],</span> <span class="hljs-string">['1',</span> <span class="hljs-string">'2'</span><span class="hljs-string">],</span> <span class="hljs-string">['2',</span> <span class="hljs-string">'3'</span><span class="hljs-string">]]</span><span class="hljs-string">const</span> <span class="hljs-string">arr2</span> <span class="hljs-string">=</span> <span class="hljs-string">[&#123;</span> <span class="hljs-attr">a:</span> <span class="hljs-number">1</span> <span class="hljs-string">&#125;,</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">b:</span> <span class="hljs-number">2</span> <span class="hljs-string">&#125;,</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">c:</span> <span class="hljs-number">3</span> <span class="hljs-string">&#125;];</span><span class="hljs-string">console.log(Object.entries(arr2));</span>  <span class="hljs-string">//</span> <span class="hljs-string">[['0',</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">a:</span> <span class="hljs-number">1</span> <span class="hljs-string">&#125;],</span> <span class="hljs-string">['1',</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">b:</span> <span class="hljs-number">2</span> <span class="hljs-string">&#125;],</span> <span class="hljs-string">['2',</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">c:</span> <span class="hljs-number">3</span> <span class="hljs-string">&#125;]]</span><span class="hljs-string">const</span> <span class="hljs-string">obj</span> <span class="hljs-string">=</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">sheet1:</span> <span class="hljs-string">&#123;</span> <span class="hljs-attr">zhujun:</span> <span class="hljs-number">666</span> <span class="hljs-string">&#125;&#125;;</span><span class="hljs-string">console.log(Object.entries(obj));</span>  <span class="hljs-string">//</span>  <span class="hljs-string">[</span> <span class="hljs-string">'sheet1'</span><span class="hljs-string">,&#123;</span> <span class="hljs-attr">zhujun:</span> <span class="hljs-number">666</span> <span class="hljs-string">&#125;</span> <span class="hljs-string">]</span></code></pre><p>åœ¨ react ä¸­ï¼Œå±•ç¤ºå¯Œæ–‡æœ¬ ï¼Œå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œæ³¨æ„ç”¨æ³•ï¼</p><pre><code class="hljs applescript">&lt;<span class="hljs-keyword">div</span> dangerouslySetInnerHTML=&#123;&#123; __html: '&lt;<span class="hljs-keyword">div</span>&gt;<span class="hljs-number">123</span>&lt;/<span class="hljs-keyword">div</span>&gt;' &#125;&#125; /&gt;</code></pre><hr><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; Fragment, PureComponent &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;<span class="hljs-keyword">import</span> XLSX <span class="hljs-keyword">from</span> <span class="hljs-string">'xlsx'</span>;<span class="hljs-keyword">import</span> &#123; Card, Spin, Tabs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;<span class="hljs-keyword">import</span> &#123; formatMessage &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'umi-plugin-react/locale'</span>;<span class="hljs-keyword">import</span> &#123; Table &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/Enhanced'</span>;<span class="hljs-keyword">import</span> &#123; request &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/Enhanced'</span>;<span class="hljs-keyword">const</span> &#123; TabPane &#125; = Tabs;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span> </span>&#123;  <span class="hljs-keyword">constructor</span>(props) &#123;    <span class="hljs-keyword">super</span>(props);    <span class="hljs-keyword">this</span>.state = &#123;      workbook: <span class="hljs-literal">null</span>,      isLoading: <span class="hljs-literal">true</span>,    &#125;;  &#125;  componentDidMount() &#123;    <span class="hljs-keyword">const</span> &#123; src &#125; = <span class="hljs-keyword">this</span>.props;    <span class="hljs-keyword">if</span> (src) &#123;      request(src, &#123;        method: <span class="hljs-string">'get'</span>,        download: <span class="hljs-literal">true</span>,      &#125;).then(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> &#123;        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(resp.response.data);        <span class="hljs-keyword">const</span> workbook = XLSX.read(data, &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'array'</span> &#125;);        <span class="hljs-keyword">this</span>.setState(&#123;          isLoading: <span class="hljs-literal">false</span>,          workbook,        &#125;);      &#125;);    &#125;  &#125;  render() &#123;    <span class="hljs-keyword">const</span> &#123; isLoading, workbook &#125; = <span class="hljs-keyword">this</span>.state;    <span class="hljs-keyword">return</span> (      &lt;Fragment&gt;        &#123;isLoading ? (          &lt;Spin size=<span class="hljs-string">"large"</span> /&gt;        ) : (          &lt;Tabs&gt;            &#123;workbook.SheetNames.map(<span class="hljs-function">(<span class="hljs-params">sheetName, sheetIndex</span>) =&gt;</span> &#123;              <span class="hljs-keyword">return</span> (                &lt;TabPane tab=&#123;sheetName&#125; key=&#123;sheetIndex&#125;&gt;                  &lt;Table                    columns=&#123;<span class="hljs-built_in">Object</span>.keys(                      XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName])[<span class="hljs-number">0</span>],                    ).map(<span class="hljs-function">(<span class="hljs-params">columnItem, columnIndex</span>) =&gt;</span> &#123;                      <span class="hljs-keyword">return</span> &#123;                        title: formatMessage(&#123; <span class="hljs-attr">id</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;columnItem&#125;</span>`</span> &#125;),                        dataIndex: columnItem,                        key: columnIndex,                      &#125;;                    &#125;)&#125;                    dataSource=&#123;XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName])&#125;                  /&gt;                &lt;<span class="hljs-regexp">/TabPane&gt;</span><span class="hljs-regexp">              );</span><span class="hljs-regexp">            &#125;)&#125;</span><span class="hljs-regexp">          &lt;/</span>Tabs&gt;        )&#125;      &lt;<span class="hljs-regexp">/Fragment&gt;</span><span class="hljs-regexp">    );</span><span class="hljs-regexp">  &#125;</span><span class="hljs-regexp">&#125;</span><span class="hljs-regexp"></span><span class="hljs-regexp">export default Index;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢„è§ˆexcel XLSX</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯»ã€Šå°‘æœ‰äººèµ°çš„è·¯ã€‹</title>
    <link href="/2020/08/02/essay0802/"/>
    <url>/2020/08/02/essay0802/</url>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€ç³»åˆ—ä¹¦ï¼Œç°åœ¨åœ¨è¯»ç¬¬ 4 æœ¬ã€Šåœ¨ç„¦è™‘çš„å¹´ä»£è·å¾—ç²¾ç¥çš„æˆé•¿ã€‹</p><p>å¿ƒæ™ºæˆç†Ÿçš„æ—…ç¨‹ â€”â€”è‡ªå¾‹ï¼Œè‡ªä¿¡<br>å‹‡æ•¢çš„é¢å¯¹è°è¨€ â€”â€”è°è¨€æ˜¯é‚ªæ¶çš„æ ¹æº<br>ä¸å¿ƒçµå¯¹è¯ â€”â€”äººç”Ÿé”™ç»¼å¤æ‚<br>è¿™æœ¬ä¹¦ â€”â€”äººç”Ÿæ²¡æœ‰ç®€å•çš„ç­”æ¡ˆ</p><p>æ‰€ä»¥ä¸‹é¢çš„å†…å®¹å…ˆæ˜¯ç¬¬ 4 æœ¬å†…å®¹ï¼Œè‡³äºå‰é¢å‡ æœ¬ä¹¦å†™ä¸å†™ï¼Œçœ‹æˆ‘å¿ƒæƒ…å§ï½<br>è¿™æœ¬æ˜¯æ–¯ç§‘ç‰¹*æ´¾å…‹åœ¨ 60 å²çš„æ—¶å€™å†™çš„ï¼Œç›¸æ¯”ä¹‹ä¸‹æˆ‘è¿˜æ˜¯æ›´å–œæ¬¢ä»– 40 å²å†™çš„ç¬¬ä¸€æœ¬ä¹¦å«ã€Šå¿ƒæ™ºæˆç†Ÿçš„æ—…ç¨‹ã€‹</p><blockquote><p>è‡ªæˆ‘å’Œçµé­‚å¸¸å¤„äºäº¤æˆ˜çŠ¶æ€ï¼Œè‡ªæˆ‘éœ€è¦æ‹¥æœ‰ï¼Œæ‹¥æœ‰çš„è¶Šå¤šè¶Šå¥½ï¼Œè€Œçµé­‚éœ€è¦æ”¾å¼ƒï¼Œæ”¾å¼ƒçš„è¶Šå¤šè¶Šè‡ªç”±ã€‚æ‰€ä»¥å‰åŠç”Ÿè¦è¿½å¯»è‡ªæˆ‘ï¼ŒååŠç”Ÿåˆ™è¦æ”¾ä¸‹è‡ªæˆ‘ï¼Œè¿½éšçµé­‚ã€‚</p></blockquote><p>æˆ‘ä»¬å–‹å–‹ä¸ä¼‘ï¼Œè¯´ä¸œé“è¥¿ï¼Œ<br>å´ä»æ—§å­¤ç‹¬<br>æ´»ç€å´å­¤ç‹¬<br>å½’å®¿<br>åœ¨å“ªé‡Œï¼Ÿ</p><blockquote><p>é‚£äº›å¬ä¸è§éŸ³ä¹çš„äººè®¤ä¸ºé‚£äº›è·³èˆçš„äººéƒ½ç–¯äº† â€”â€”â€” å°¼é‡‡</p></blockquote><p>å†²çªï¼šåˆ©ç›Š åè§</p><blockquote><p>è®¸å¤šäººå®æ„¿æ­»ï¼Œä¹Ÿä¸æ„¿æ„æ€è€ƒï¼Œäº‹å®ä¸Šä»–ä»¬ä¹Ÿç¡®å®è‡³æ­»éƒ½æ²¡æœ‰æ€è€ƒè¿‡ â€”â€”â€” ç½—ç´ </p></blockquote><p>è‰ç‡æ€è€ƒå’Œç›²ä»å¿ƒç†<br>å…ˆå…¥ä¸ºä¸»ä¸è´´æ ‡ç­¾<br>è®¤ä¸ºè‡ªå·±æ— æ‰€ä¸çŸ¥ï¼Œæ— æ‰€ä¸èƒ½ï¼Œå…¶å®æ‰æ˜¯æœ€å¤§çš„è ¢è´§ã€‚</p><p>è‡ªæˆ‘æ‰æœ‰è‡ªå°Š çµé­‚æ²¡æœ‰è‡ªå°Š</p><p>æ€è€ƒæœ€å¿Œè®³çš„æ˜¯è‰ç‡ï¼Œå€¾å¬æœ€å¿Œè®³çš„æ˜¯åˆ†å¿ƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦å¿ƒå¾—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°‘æœ‰äººèµ°çš„è·¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯»ã€Šä½ ä¸çŸ¥é“çš„javascriptã€‹</title>
    <link href="/2020/07/30/javascript/"/>
    <url>/2020/07/30/javascript/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸Šå·"><a href="#ä¸Šå·" class="headerlink" title="ä¸Šå·"></a>ä¸Šå·</h2><h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><p>ä½œç”¨åŸŸæ˜¯èƒ½å¤Ÿå‚¨å­˜å˜é‡å½“ä¸­çš„å€¼ï¼Œå¹¶ä¸”èƒ½åœ¨ä¹‹åå¯¹è¿™ä¸ª å€¼è¿›è¡Œè®¿é—®æˆ–ä¿®æ”¹ã€‚</p><h4 id="ç†è§£ä½œç”¨åŸŸ"><a href="#ç†è§£ä½œç”¨åŸŸ" class="headerlink" title="ç†è§£ä½œç”¨åŸŸ"></a>ç†è§£ä½œç”¨åŸŸ</h4><ul><li>å¼•æ“</li></ul><p>ä»å¤´åˆ°å°¾è´Ÿè´£æ•´ä¸ª javascript ç¨‹åºçš„å˜å¼‚åŠæ‰§è¡Œè¿‡ç¨‹</p><ul><li>ç¼–è¯‘å™¨</li></ul><p>å¼•æ“çš„å¥½æœ‹å‹ä¹‹ä¸€ï¼Œè´Ÿè´£è¯­æ³•åˆ†æåŠä»£ç ç”Ÿæˆç­‰è„æ´»ç´¯æ´»</p><ul><li>ä½œç”¨åŸŸ</li></ul><p>å¼•æ“çš„å¦ä¸€ä¸ªå¥½æœ‹å‹ï¼Œè´Ÿè´£æ‰‹æœºå¹¶ä¸”ç»´æŠ¤ç”±æ‰€æœ‰ç”Ÿå‘½çš„æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰ç»„æˆçš„ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œå¹¶å®æ–½ä¸€å¥—éå¸¸ä¸¥æ ¼çš„è§„åˆ™ï¼Œç¡®å®šå½“å‰æ‰§è¡Œçš„ä»£ç å¯¹æ’°å†™æ ‡è¯†ç¬¦çš„è®¿é—®æƒé™ã€‚</p><p>ä¸¾ä¸ªæ —å­ ğŸŒ°</p><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span><span class="hljs-params">(a)</span> <span class="hljs-comment">&#123; console.log( a ); // 2</span></span><span class="hljs-function"><span class="hljs-comment">&#125;</span></span><span class="hljs-function"><span class="hljs-title">foo</span><span class="hljs-params">( 2 )</span>;</span></code></pre><p>å¼•æ“:æˆ‘è¯´ä½œç”¨åŸŸï¼Œæˆ‘éœ€è¦ä¸º foo è¿›è¡Œ RHS å¼•ç”¨ã€‚ä½ è§è¿‡å®ƒå—?<br>ä½œç”¨åŸŸ:åˆ«è¯´ï¼Œæˆ‘è¿˜çœŸè§è¿‡ï¼Œç¼–è¯‘å™¨é‚£å°å­åˆšåˆšå£°æ˜äº†å®ƒã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç»™ä½ ã€‚<br>å¼•æ“:å“¥ä»¬å¤ªå¤Ÿæ„æ€äº†!å¥½å§ï¼Œæˆ‘æ¥æ‰§è¡Œä¸€ä¸‹ fooã€‚<br>å¼•æ“:ä½œç”¨åŸŸï¼Œè¿˜æœ‰ä¸ªäº‹å„¿ã€‚æˆ‘éœ€è¦ä¸º a è¿›è¡Œ LHS å¼•ç”¨ï¼Œè¿™ä¸ªä½ è§è¿‡å—?<br>ä½œç”¨åŸŸ:è¿™ä¸ªä¹Ÿè§è¿‡ï¼Œç¼–è¯‘å™¨æœ€è¿‘æŠŠå®ƒå£°åä¸º foo çš„ä¸€ä¸ªå½¢å¼å‚æ•°äº†ï¼Œæ‹¿å»å§ã€‚<br>å¼•æ“:å¤§æ©ä¸è¨€è°¢ï¼Œä½ æ€»æ˜¯è¿™ä¹ˆæ£’ã€‚ç°åœ¨æˆ‘è¦æŠŠ 2 èµ‹å€¼ç»™ aã€‚<br>å¼•æ“:å“¥ä»¬ï¼Œä¸å¥½æ„æ€åˆæ¥æ‰“æ‰°ä½ ã€‚æˆ‘è¦ä¸º console è¿›è¡Œ RHS å¼•ç”¨ï¼Œä½ è§è¿‡å®ƒå—?<br>ä½œç”¨åŸŸ:å’±ä¿©è°è·Ÿè°å•Šï¼Œå†è¯´æˆ‘å°±æ˜¯å¹²è¿™ä¸ªã€‚è¿™ä¸ªæˆ‘ä¹Ÿæœ‰ï¼Œconsole æ˜¯ä¸ªå†…ç½®å¯¹è±¡ã€‚ ç»™ä½ ã€‚<br>å¼•æ“:ä¹ˆä¹ˆå“’ã€‚æˆ‘å¾—çœ‹çœ‹è¿™é‡Œé¢æ˜¯ä¸æ˜¯æœ‰ log(..)ã€‚å¤ªå¥½äº†ï¼Œæ‰¾åˆ°äº†ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚<br>å¼•æ“:å“¥ä»¬ï¼Œèƒ½å¸®æˆ‘å†æ‰¾ä¸€ä¸‹å¯¹ a çš„ RHS å¼•ç”¨å—?è™½ç„¶æˆ‘è®°å¾—å®ƒï¼Œä½†æƒ³å†ç¡®è®¤ä¸€æ¬¡ã€‚<br>ä½œç”¨åŸŸ:æ”¾å¿ƒå§ï¼Œè¿™ä¸ªå˜é‡æ²¡æœ‰å˜åŠ¨è¿‡ï¼Œæ‹¿èµ°ï¼Œä¸è°¢ã€‚<br>å¼•æ“:çœŸæ£’ã€‚æˆ‘æ¥æŠŠ a çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ 2ï¼Œä¼ é€’è¿› log(..)ã€‚<br>â€¦â€¦</p><pre><code class="hljs stylus"><span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span> = <span class="hljs-number">2</span></code></pre><ol><li>é¦–å…ˆï¼Œvar a åœ¨å…¶ä½œç”¨åŸŸä¸­å£°æ˜æ–°å˜é‡ã€‚è¿™ä¼šåœ¨æœ€å¼€å§‹çš„é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä»£ç æ‰§è¡Œå‰è¿›è¡Œã€‚</li><li>æ¥ä¸‹æ¥ï¼Œa = 2 ä¼šæŸ¥è¯¢(LHS æŸ¥è¯¢)å˜é‡ a å¹¶å¯¹å…¶è¿›è¡Œèµ‹å€¼ã€‚</li></ol><p>å—çº§ä½œç”¨åŸŸ<br>try catch è¯­å¥é‡Œé¢ catch éƒ¨åˆ†æ˜¯å—çº§ä½œç”¨åŸŸ<br>let å¯ä»¥åœ¨ä»»æ„ä½œç”¨åŸŸä¸­ï¼Œé€šå¸¸æ˜¯å‡½æ•°å†…éƒ¨ã€‚å¯ä»¥å½“åšå—çº§å˜é‡ï½ä½†æ˜¯æ²¡æœ‰å£°æ˜æå‡<br>const ä¹Ÿä¸€æ ·</p><h3 id="ç¼–è¯‘å™¨"><a href="#ç¼–è¯‘å™¨" class="headerlink" title="ç¼–è¯‘å™¨"></a>ç¼–è¯‘å™¨</h3><p>åŒ…æ‹¬å˜é‡å’Œå‡½æ•°åœ¨å†…çš„æ‰€æœ‰å£°æ˜éƒ½ä¼šåœ¨ä»»ä½•ä»£ç è¢«æ‰§è¡Œå‰é¦–å…ˆ è¢«å¤„ç†ã€‚</p><p>å½“ä½ çœ‹åˆ° var a = 2; æ—¶ï¼Œå¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå£°æ˜ã€‚ä½† JavaScript å®é™…ä¸Šä¼šå°†å…¶çœ‹æˆä¸¤ä¸ª å£°æ˜:var a;å’Œ a = 2;ã€‚<br>ç¬¬ä¸€ä¸ªå®šä¹‰å£°æ˜æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œçš„ã€‚ç¬¬äºŒä¸ªèµ‹å€¼å£°æ˜ä¼šè¢«ç•™åœ¨ åŸåœ°ç­‰å¾…æ‰§è¡Œé˜¶æ®µã€‚</p><p>å£°æ˜å˜é‡æå‡</p><h4 id="å‡½æ•°ä¼˜å…ˆ"><a href="#å‡½æ•°ä¼˜å…ˆ" class="headerlink" title="å‡½æ•°ä¼˜å…ˆ"></a>å‡½æ•°ä¼˜å…ˆ</h4><pre><code class="hljs javascript">foo(); <span class="hljs-comment">// 1</span><span class="hljs-keyword">var</span> foo;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params"></span>) </span>&#123;   <span class="hljs-built_in">console</span>.log( <span class="hljs-number">1</span> );&#125;foo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;   <span class="hljs-built_in">console</span>.log( <span class="hljs-number">2</span> );&#125;;<span class="hljs-comment">// ä¼šè¾“å‡º 1 è€Œä¸æ˜¯ 2 !è¿™ä¸ªä»£ç ç‰‡æ®µä¼šè¢«å¼•æ“ç†è§£ä¸ºå¦‚ä¸‹å½¢å¼:</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-built_in">console</span>.log( <span class="hljs-number">1</span> );&#125;foo(); <span class="hljs-comment">// 1</span>foo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-built_in">console</span>.log( <span class="hljs-number">2</span> );&#125;;</code></pre><p><strong>å°ç»“ï¼š</strong><br>æˆ‘ä»¬ä¹ æƒ¯å°† var a = 2;çœ‹ä½œä¸€ä¸ªå£°æ˜ï¼Œè€Œå®é™…ä¸Š JavaScript å¼•æ“å¹¶ä¸è¿™ä¹ˆè®¤ä¸ºã€‚å®ƒå°† var a<br>å’Œ a = 2 å½“ä½œä¸¤ä¸ªå•ç‹¬çš„å£°æ˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¼–è¯‘é˜¶æ®µçš„ä»»åŠ¡ï¼Œè€Œç¬¬äºŒä¸ªåˆ™æ˜¯æ‰§è¡Œé˜¶æ®µçš„ä»»åŠ¡ã€‚<br>è¿™æ„å‘³ç€æ— è®ºä½œç”¨åŸŸä¸­çš„å£°æ˜å‡ºç°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œéƒ½å°†åœ¨ä»£ç æœ¬èº«è¢«æ‰§è¡Œå‰é¦–å…ˆè¿›è¡Œå¤„ç†ã€‚ å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹å½¢è±¡åœ°æƒ³è±¡æˆæ‰€æœ‰çš„å£°æ˜(å˜é‡å’Œå‡½æ•°)éƒ½ä¼šè¢«â€œç§»åŠ¨â€åˆ°å„è‡ªä½œç”¨åŸŸçš„ æœ€é¡¶ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæå‡ã€‚</p><h3 id="this"><a href="#this" class="headerlink" title="this"></a>this</h3><p>ä¸ºä»€ä¹ˆç”¨ thisã€‚ ç®€æ´ ï¼Œå¤ç”¨æ€§å¥½</p><p>æˆ‘è§‰å¾—å…³äº this çœŸçš„æ²¡ä»€ä¹ˆå¥½æ€»ç»“çš„ï¼Œå°±ä¸€å¥è¯å°±å®Œäº‹ï¼š<br>this å®é™…ä¸Šæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶å‘ç”Ÿçš„ç»‘å®šï¼Œå®ƒæŒ‡å‘ä»€ä¹ˆå®Œå…¨å–å†³äºå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ã€‚</p><h3 id="å±æ€§æè¿°ç¬¦"><a href="#å±æ€§æè¿°ç¬¦" class="headerlink" title="å±æ€§æè¿°ç¬¦"></a>å±æ€§æè¿°ç¬¦</h3><p>è¯´å®åœ¨çš„ è¿™ç©æ„æˆ‘åœ¨çº¢å®ä¹¦é‡Œçœ‹è¿‡çš„</p><pre><code class="hljs yaml"><span class="hljs-string">var</span> <span class="hljs-string">myObject</span> <span class="hljs-string">=</span> <span class="hljs-string">&#123;</span> <span class="hljs-string">a:2</span><span class="hljs-string">&#125;;</span>     <span class="hljs-string">Object.getOwnPropertyDescriptor(</span> <span class="hljs-string">myObject,</span> <span class="hljs-string">"a"</span> <span class="hljs-string">);</span>     <span class="hljs-string">//</span> <span class="hljs-string">&#123;</span><span class="hljs-string">//</span> <span class="hljs-attr">value:</span> <span class="hljs-number">2</span><span class="hljs-string">,</span><span class="hljs-string">//</span> <span class="hljs-attr">writable:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span><span class="hljs-string">//</span> <span class="hljs-attr">enumerable:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span><span class="hljs-string">//</span> <span class="hljs-attr">configurable:</span> <span class="hljs-literal">true</span> <span class="hljs-string">//</span> <span class="hljs-string">&#125;</span><span class="hljs-string">var</span> <span class="hljs-string">myObject</span> <span class="hljs-string">=</span> <span class="hljs-string">&#123;&#125;;</span>     <span class="hljs-string">Object.defineProperty(</span> <span class="hljs-string">myObject,</span> <span class="hljs-string">"a"</span><span class="hljs-string">,</span> <span class="hljs-string">&#123;</span>         <span class="hljs-attr">value:</span> <span class="hljs-number">2</span><span class="hljs-string">,</span><span class="hljs-attr">writable:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span> <span class="hljs-attr">configurable:</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span> <span class="hljs-attr">enumerable:</span> <span class="hljs-literal">true</span>     <span class="hljs-string">&#125;</span> <span class="hljs-string">);</span>     <span class="hljs-string">myObject.a;</span> <span class="hljs-string">//</span> <span class="hljs-number">2</span><span class="hljs-string">//</span>  <span class="hljs-string">ç¦æ­¢ä¸€ä¸ªå¯¹è±¡æ·»åŠ æ–°å±æ€§å¹¶ä¸”ä¿ç•™å·²æœ‰å±æ€§</span>        <span class="hljs-string">Object.preventExtensions(</span> <span class="hljs-string">myObject</span> <span class="hljs-string">);</span>     <span class="hljs-string">myObject.b</span> <span class="hljs-string">=</span> <span class="hljs-number">3</span><span class="hljs-string">;</span>     <span class="hljs-string">myObject.b;</span> <span class="hljs-string">//</span> <span class="hljs-string">undefined</span></code></pre><p>Object.seal(..) ä¼šåˆ›å»ºä¸€ä¸ªâ€œå¯†å°â€çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•å®é™…ä¸Šä¼šåœ¨ä¸€ä¸ªç°æœ‰å¯¹è±¡ä¸Šè°ƒç”¨ Object.preventExtensions(..) å¹¶æŠŠæ‰€æœ‰ç°æœ‰å±æ€§æ ‡è®°ä¸º configurable:false</p><p>Object.freeze(..) ä¼šåˆ›å»ºä¸€ä¸ªå†»ç»“å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•å®é™…ä¸Šä¼šåœ¨ä¸€ä¸ªç°æœ‰å¯¹è±¡ä¸Šè°ƒç”¨ Object.seal(..) å¹¶æŠŠæ‰€æœ‰â€œæ•°æ®è®¿é—®â€å±æ€§æ ‡è®°ä¸º writable:falseï¼Œè¿™æ ·å°±æ— æ³•ä¿®æ”¹å®ƒä»¬ çš„å€¼</p><p>for in éå†å¯¹è±¡ä¸­æ‰€æœ‰å¯æšä¸¾å±æ€§<br>for of éå†å¯¹è±¡{key:value}ä¸­çš„ value</p><p>æ„é€ å‡½æ•° åŸå‹å•¥çš„ä¸å†™äº†</p><h2 id="ä¸­å·"><a href="#ä¸­å·" class="headerlink" title="ä¸­å·"></a>ä¸­å·</h2><p>ç±»å‹<br>å€¼<br>åŸç”Ÿå‡½æ•°<br>å¼ºåˆ¶ç±»å‹è½¬æ¢<br>è¯­æ³•<br>ã€‚ã€‚ã€‚åˆæ˜¯ 300 å¤šé¡µ<br>æˆ‘æŒ‘æ„Ÿå…´è¶£çš„çœ‹å§</p><p>é¸­å­ç±»å‹ï¼š å½“ä¸€ä¸ªä¸œè¥¿é•¿å¾—åƒé¸­å­ï¼Œå«å£°ä¹Ÿåƒé¸­å­ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸ªé¸­å­</p><p>ä» JavaScript ä¸»ç¨‹åº(æˆ–å¦ä¸€ä¸ª Worker)ä¸­ï¼Œå¯ä»¥è¿™æ ·å®ä¾‹åŒ–ä¸€ä¸ª Worker: var w1 = new Worker( â€œ<a href="http://some.url.1/mycoolworker.js&quot;" target="_blank" rel="noopener">http://some.url.1/mycoolworker.js&quot;</a> );<br>è¿™ä¸ª URL åº”è¯¥æŒ‡å‘ä¸€ä¸ª JavaScript æ–‡ä»¶çš„ä½ç½®(è€Œä¸æ˜¯ä¸€ä¸ª HTML é¡µé¢!)ï¼Œè¿™ä¸ªæ–‡ä»¶å°† è¢«åŠ è½½åˆ°ä¸€ä¸ª Worker ä¸­ã€‚ç„¶åæµè§ˆå™¨å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œè®©è¿™ä¸ªæ–‡ä»¶åœ¨è¿™ä¸ªçº¿ç¨‹ä¸­ä½œ ä¸ºç‹¬ç«‹çš„ç¨‹åºè¿è¡Œã€‚</p><p>Worker ä¹‹é—´ä»¥åŠå®ƒä»¬å’Œä¸»ç¨‹åºä¹‹é—´ï¼Œä¸ä¼šå…±äº«ä»»ä½•ä½œç”¨åŸŸæˆ–èµ„æºï¼Œé‚£ä¼šæŠŠæ‰€æœ‰å¤šçº¿ç¨‹ç¼–ç¨‹ çš„å™©æ¢¦å¸¦åˆ°å‰ç«¯é¢†åŸŸï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªåŸºæœ¬çš„äº‹ä»¶æ¶ˆæ¯æœºåˆ¶ç›¸äº’è”ç³»ã€‚</p><p>Worker w1 å¯¹è±¡æ˜¯ä¸€ä¸ªäº‹ä»¶ä¾¦å¬è€…å’Œè§¦å‘è€…ï¼Œå¯ä»¥é€šè¿‡è®¢é˜…å®ƒæ¥è·å¾—è¿™ä¸ª Worker å‘å‡ºçš„äº‹ ä»¶ä»¥åŠå‘é€äº‹ä»¶ç»™è¿™ä¸ª Workerã€‚<br>ä»¥ä¸‹æ˜¯å¦‚ä½•ä¾¦å¬äº‹ä»¶(å…¶å®å°±æ˜¯å›ºå®šçš„ â€œmessageâ€ äº‹ä»¶):<br>w1.addEventListener( â€œmessageâ€, function(evt){<br>// evt.data<br>} );<br>ä¹Ÿå¯ä»¥å‘é€ â€œmessageâ€ äº‹ä»¶ç»™è¿™ä¸ª Worker:<br>w1.postMessage( â€œsomething cool to sayâ€ );<br>åœ¨è¿™ä¸ª Worker å†…éƒ¨ï¼Œæ”¶å‘æ¶ˆæ¯æ˜¯å®Œå…¨å¯¹ç§°çš„: // â€œmycoolworker.jsâ€<br>addEventListener( â€œmessageâ€, function(evt){<br>// evt.data<br>} );<br>postMessage( â€œa really cool replyâ€ );<br>æ³¨æ„ï¼Œä¸“ç”¨ Worker å’Œåˆ›å»ºå®ƒçš„ç¨‹åºä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œâ€messageâ€ äº‹ä»¶ æ²¡æœ‰ä»»ä½•æ­§ä¹‰éœ€è¦æ¶ˆé™¤ï¼Œå› ä¸ºæˆ‘ä»¬ç¡®å®šå®ƒåªèƒ½æ¥è‡ªè¿™ä¸ªä¸€å¯¹ä¸€çš„å…³ç³»:å®ƒè¦ä¹ˆæ¥è‡ªè¿™ä¸ª Workerï¼Œè¦ä¹ˆæ¥è‡ªä¸»é¡µé¢ã€‚</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¹Ÿè¯»è¿‡å‘¨çˆ±æ°‘å†™çš„ js åŸºæœ¬åŸç†ï¼Œæ€»çš„æ¥è¯´å¯¹ js æœ‰äº†ä¸€äº›è®¤çŸ¥äº†ã€‚å¤ªæ·±åˆ»çš„ï¼Œå¤æ‚çš„æˆ‘å°±ä¸ç»†ç ”ç©¶äº†ã€‚å°±è¿™ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯</title>
    <link href="/2020/07/14/essay0714/"/>
    <url>/2020/07/14/essay0714/</url>
    
    <content type="html"><![CDATA[<p>è¯åŒ»ä¸æ­»ç—…ï¼Œæ­»ç—…æ— è¯åŒ»ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2020å…¨å›½2å·ä½œæ–‡éšç¬”</title>
    <link href="/2020/07/07/essay0707/"/>
    <url>/2020/07/07/essay0707/</url>
    
    <content type="html"><![CDATA[<p>å…¨å›½ â…¡ å·ä½œæ–‡è§£æ+é˜…è¯»ä¸‹é¢çš„ææ–™ï¼Œæ ¹æ®è¦æ±‚å†™ä½œã€‚<br>å¢¨å­è¯´ï¼šâ€œè§†äººä¹‹å›½ï¼Œè‹¥è§†å…¶å›½ï¼›è§†äººä¹‹å®¶ï¼Œè‹¥è§†å…¶å®¶ï¼›è§†äººä¹‹èº«ï¼Œè‹¥è§†å…¶èº«ã€‚â€<br>è‹±å›½è¯—äººçº¦ç¿°å¤šæ©è¯´ï¼šâ€œæ²¡æœ‰äººæ˜¯è‡ªæˆä¸€ä½“ã€ä¸ä¸–éš”ç»çš„å­¤å²›ï¼Œæ¯ä¸€ä¸ªäººéƒ½æ˜¯å¹¿è¢¤å¤§é™†çš„ä¸€éƒ¨åˆ†ã€‚â€<br>â€œé’å±±ä¸€é“åŒäº‘é›¨ï¼Œæ˜æœˆä½•æ›¾æ˜¯ä¸¤ä¹¡ã€‚â€â€œåŒæ°”è¿æï¼Œå…±ç›¼æ˜¥æ¥ã€‚â€â€¦â€¦2020 å¹´çš„æ˜¥å¤©ï¼Œè¿™äº›å¯„è¨€å°åœ¨å›½é™…ç¤¾ä¼šæ´åŠ©ä¸­å›½çš„ç‰©èµ„ä¸Šï¼Œè¡¨è¾¾äº†ä¸–ç•Œäººæ°‘å¯¹ä¸­å›½çš„æ”¯æŒã€‚<br>â€œå±±å’Œå±±ä¸ç›¸é‡ï¼Œäººå’Œäººè¦ç›¸é€¢ã€‚â€â€œæ¶ˆå¤±å§ï¼Œé»‘å¤œï¼é»æ˜æ—¶æˆ‘ä»¬å°†è·èƒœï¼â€â€¦â€¦è¿™äº›è¯è¯­å°åœ¨ä¸­å›½æ´åŠ©å…¶ä»–å›½å®¶çš„ç‰©èµ„ä¸Šï¼Œå¯„æ‰˜ç€ä¸­å›½äººæ°‘å¯¹ä¸–ç•Œçš„ç¥ç¦ã€‚<br>â€œä¸–ç•Œé’å¹´ä¸ç¤¾ä¼šå‘å±•è®ºå›â€é‚€è¯·ä½ ä½œä¸ºä¸­å›½é’å¹´ä»£è¡¨å‚ä¼šï¼Œå‘è¡¨ä»¥â€œæºæ‰‹åŒä¸€ä¸–ç•Œï¼Œé’å¹´å…±åˆ›æœªæ¥â€ä¸ºä¸»é¢˜çš„ä¸­æ–‡æ¼”è®²ã€‚è¯·å®Œæˆä¸€ç¯‡æ¼”è®²ç¨¿ã€‚<br>è¦æ±‚ï¼šç»“åˆææ–™å†…å®¹åŠå«æ„å®Œæˆå†™ä½œä»»åŠ¡ï¼›é€‰å¥½è§’åº¦ï¼Œç¡®å®šç«‹æ„ï¼Œæ˜ç¡®æ–‡ä½“ï¼Œè‡ªæ‹Ÿæ ‡é¢˜ï¼›ä¸è¦å¥—ä½œï¼Œä¸å¾—æŠ„è¢­ï¼›ä¸å¾—æ³„éœ²ä¸ªäººä¿¡æ¯ï¼›ä¸å°‘äº 800 å­—ã€‚</p><p>2020 å¹´çš„å…¨å›½ 2 å·ä½œæ–‡ï¼Œçœ‹å®Œè¿™ä¸ªå¹¶æ²¡æœ‰æƒ³å†™ä½œæ–‡çš„å†²åŠ¨ã€‚<br>ä¸è¿‡æˆ‘å–œæ¬¢è¿™å¥ å±±å’Œå±±ä¸ç›¸é‡ï¼Œäººå’Œäººè¦ç›¸é€¢</p><p>å±±å’Œå±±ä¸ä¼šç›¸é‡å—ï¼Ÿ<br>ä½ å¯æ›¾çœ‹è¿‡è¿ç»µçš„å±±è„‰ï¼Œ<br>é‚£ä¸€å±±æŒ¨ç€ä¸€å±±ï¼Œ<br>å°±å¥½æ¯”ä¸€å±±çˆ±ç€ä¸€å±±ï¼Œ<br>è¿˜å¯èƒ½æœ‰å¾ˆå¤šå°å±±ï¼Œå“ˆå“ˆ<br>è¿™ä¸–ç•Œä¸Šæœ‰å¾ˆå¤šå±±å•Šï¼Œå¤©ç”Ÿå°±æ˜¯åœ¨ä¸€èµ·çš„<br>ç›¸äº’ä¾åï¼Œä¸æ›¾åˆ†ç¦»ï¼Œåšå®šçš„å¿ƒå°±åƒçŸ³å¤´ä¸€æ ·ã€‚<br>å¥¥å¯¹ï¼Œå±±ï¼Œæœ¬æ¥å°±æ˜¯çŸ³å¤´ã€‚<br>åšå®šçš„çŸ³å¤´çš„å¿ƒï¼Œå®ˆåœ¨èº«è¾¹ä¸€åŠ¨ä¸åŠ¨<br>ä¸»è¦å®ƒæƒ³åŠ¨ä¹Ÿæ²¡åŠæ³•å•Š<br>å®ƒæ²¡æœ‰è…¿å•Š<br>å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ<br>å…¶å®ä¸¥è°¨æ¥è¯´å•Š<br>é‚£äº›è¿ç»µä¾åçš„å±±<br>ä¹Ÿä¸æ˜¯å¤©ç”Ÿå°±åœ¨ä¸€èµ·çš„<br>åªä¸è¿‡ä»æˆ‘çš„ç”Ÿå‘½å‘¨æœŸæ¥è¯´<br>ä»æˆ‘çš„ç”Ÿåˆ°æ­»çš„æ—¶é—´é‡Œ<br>åœ¨ä¸€èµ·çš„å±±è„‰è¿˜æ˜¯åœ¨ä¸€èµ·<br>å¤šå¥½<br>å¤šè®©äººç¾¡æ…•<br>ä½†æ˜¯åœ°çƒæ¿å—æ˜¯ä¼šç§»åŠ¨çš„é¸­<br>åœ¨ä¸€èµ·çš„å±±è„‰<br>åœ¨æ¿å—ç§»åŠ¨è¿‡ç¨‹ä¸­<br>å¯èƒ½ä¼šæ‹¥æŠ±çš„æ›´åŠ ç´§å¯†<br>ä¹Ÿå¯èƒ½ä¼šé»˜é»˜åˆ†ç¦»<br>ä¸åœ¨ä¸€èµ·çš„å±±<br>ä¹Ÿå¯èƒ½ä¸€æ­¥æ­¥çš„é è¿‘<br>æˆ‘å–œæ¬¢é‚£ä¸€åº§å±±<br>æˆ‘è¦èµ°å»å®ƒé‚£é‡Œ<br>åªè¦æ˜¯æœ‰ä¸€é¢—æ„¿æ„æ¥è¿‘çš„å¿ƒ<br>æˆ‘çš„æ¯ä¸€æ­¥<br>æ¯ä¸€å˜ç±³<br>å°±éƒ½æœ‰æ„ä¹‰<br>ç„¶å<br>åœ¨ç›¸é‡çš„é‚£ä¸€åˆ»<br>è°è¿˜åœ¨ä¹æ˜¯ä¸æ˜¯å·²ç»å¤©è’åœ°è€<br>è°è¿˜åœ¨ä¹ç»å†äº†å¤šå°‘æ˜¥ç§‹æ›´æ›¿<br>å°±åœ¨é‚£ä¸€åˆ»<br>å®ƒä»¬æ‹‰ä½å½¼æ­¤çš„æ‰‹<br>éƒ½ä¼šäº§ç”Ÿä¸€ç§å¼‚å¸¸æ¿€åŠ¨çš„æƒ…ç»ª<br>ç”¨äº†ä¸‰åƒä¸‡å¹´<br>ç»ˆäºæ¥åˆ°äº†è¿™é‡Œ<br>æ€ä¹ˆä»–å¦ˆçš„ä½ ä¹Ÿæ˜¯ä¸ªç”·çš„ï¼</p><p>äººå’Œäººéœ€è¦ç›¸é€¢å—<br>éœ€è¦<br>æˆ‘éœ€è¦ä½ <br>è¿™ä¸–ç•Œçš„æ¯ä¸€ä¸ªäººä½ å¬å¥½<br>æˆ‘éœ€è¦ä½ <br>ä½ æ¥å§<br>æ¥è·Ÿæˆ‘ç›¸é€¢å§<br>æˆ‘åœ¨<br>åŒ—çº¬ 41Â°48â€²11.75â€³<br>ä¸œç» 123Â°25â€²31.18<br>ä½ æ¥å§<br>æ¥è·Ÿæˆ‘ç›¸é€¢å§<br>è§é¢è®°å¾—ç»™æˆ‘ä¸€å—é’±<br>å¦‚æœæ¯ä¸ªäººéƒ½ç»™æˆ‘ä¸€å—é’±<br>é‚£æˆ‘å°±èƒ½ä¹°ç‚¹è‚‰ç•™ç€è¿‡å¹´<br>å¥¥å¯¹äº†<br>è·¯è´¹ç«è½¦ç¥¨å•¥çš„æˆ‘å¯ä¸æŠ¥é”€</p><p>ç›¸é€¢è¿™ä¸ªå­—çœ¼<br>æ€»æ˜¯èƒ½ç»™äººæ†§æ†¬æˆ–è€…å¸Œæœ›<br>åœ¨å¯¹æœªçŸ¥çš„å¥½å¥‡å’Œå¹»æƒ³ä¸­<br>è«åçš„å°±å¯¹ç›¸é€¢è¿™ä»¶äº‹äº§ç”Ÿäº†å¥½æ„Ÿ<br>ä¸è¿‡æ¯”èµ·ç›¸é€¢<br>æˆ‘æ›´å–œæ¬¢é‡é€¢<br>ç»å†åˆ†ç¦»<br>ç»å†æ—¶é—´<br>ç»å†åˆ«äºº<br>ç»å†äº†å¾ˆå¤šä»¥å<br>è¿˜æ˜¯æƒ³å†è§ä½ <br>å¦‚æœåˆšå¥½ä½ ä¹Ÿè¿™æ ·æƒ³<br>é‚£é‡é€¢å¯¹äºæˆ‘ä»¬å°±æœ‰äº†æ„ä¹‰<br>ä¹Ÿè®¸æ˜¯å„¿æ—¶å¬‰æˆçš„ç©ä¼´<br>ä¹Ÿè®¸æ˜¯ä¸€ç”Ÿæ‰€çˆ±çš„æƒ…äºº<br>ä¹Ÿè®¸æ˜¯åˆ€å±±ç«æµ·çš„å…„å¼Ÿ<br>ä¹Ÿè®¸æ˜¯é˜´é˜³ä¸¤éš”çš„äº²äºº<br>è®©æˆ‘ä»¬é‡é€¢å§ï¼<br>è®©æˆ‘ä»¬é‡é€¢å§ã€‚<br>æˆ‘ä¼šå‘Šè¯‰ä½ æˆ‘æœ‰å¤šä¹ˆçš„æƒ³ä½ <br>ä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„è¯´ç»™ä½ å¬<br>åœ¨ä½ çš„è€³è¾¹<br>æˆ–è€…<br>åœ¨æˆ‘çš„æ¢¦é‡Œ</p><p>å±±å’Œå±±ä¹Ÿè®¸ç›¸é‡<br>äººå’Œäººæœªå¿…ç›¸é€¢<br>å¦‚æœæœ‰å¹¸æ›¾ä¸ä½ ç›¸é€¢<br>é‚£å°±è®©æˆ‘ä»¬é‡é€¢å§<br>ç«è½¦ç¥¨æˆ‘ä¼šç»™ä½ æŠ¥äº†</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è¯»æ·±å…¥æµ…å‡ºReactå’ŒRedux</title>
    <link href="/2020/07/06/reactandredux/"/>
    <url>/2020/07/06/reactandredux/</url>
    
    <content type="html"><![CDATA[<p>å¼€å§‹è¯»ä¹¦ï½<br>ç¨‹å¢¨ç¼–è‘—<br>ä¸‹é¢çš„å†…å®¹æ¯”è¾ƒéšæ€§ï¼Œæš‚æ—¶è‡ªå·±å†™ç»™è‡ªå·±çœ‹çš„ï¼Œä¸å»ºè®®é˜…è¯»ã€‚</p><ul><li>react ä¸æ”¯æŒ ie8 ä»¥ä¸‹</li></ul><p>â€œscriptsâ€:{<br>â€œstartâ€:â€react-scripts startâ€,</p><p>â€œejectâ€:â€react-scripts ejectâ€<br>}</p><p>eject å¼¹å°„<br>ä¼šæŠŠæ½œè—åœ¨ react-scripts é‡çš„ä¸€ç³»åˆ—æŠ€æœ¯æ ˆé…ç½®éƒ½å¼¹å°„åˆ°åº”ç”¨çš„é¡¶å±‚ã€‚<br>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç ”ç©¶è¿™äº›é…ç½®ç»†èŠ‚äº†ï¼Œè€Œä¸”å¯ä»¥æ›´çµæ´»çš„å®šåˆ¶åº”ç”¨çš„é…ç½®ã€‚<br>âš ï¸ æ³¨æ„å•Š eject å‘½ä»¤ä¸å¯é€† ï¼Œåœ¨æ‰§è¡Œ npm run eject ä¹‹å‰æœ€å¥½å¤‡ä»½ä¸€ä¸‹ã€‚</p><hr><p>å¦‚æœç”¨ jq å†™ç»„ä»¶ï¼Œ<br>å…ˆå†™ä¸ª index.html<br>ç„¶åå†™ html dom èŠ‚ç‚¹ ç„¶åæ˜¯ js ç»‘å®šç‚¹å‡»é€»è¾‘å•¥çš„<br>jq ä¼šè®©äº‹ä»¶å’Œ dom é€ æˆçº ç¼ ä»£ç ç»“æ„</p><h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><h3 id="react-æ€»ç»“å…¬å¼ä¸º"><a href="#react-æ€»ç»“å…¬å¼ä¸º" class="headerlink" title="react æ€»ç»“å…¬å¼ä¸º"></a>react æ€»ç»“å…¬å¼ä¸º</h3><p>UI = renderï¼ˆdataï¼‰<br>å“åº”å¼ç¼–ç¨‹ ï¼ˆReactive programmingï¼‰<br>ä¸€çœ‹è¿™ä¸ªåå­—ï¼Œå°±çŸ¥é“ä¸ºå•¥ react æ¡†æ¶åå­—çš„ç”±æ¥äº†</p><h3 id="è™šæ‹Ÿ-dom"><a href="#è™šæ‹Ÿ-dom" class="headerlink" title="è™šæ‹Ÿ dom"></a>è™šæ‹Ÿ dom</h3><p>è¯´æ˜¯ç¬¬äº”ç« å…·ä½“è¯´è™šæ‹Ÿ dom</p><h3 id="è®¾è®¡é«˜è´¨é‡çš„-React-ç»„ä»¶"><a href="#è®¾è®¡é«˜è´¨é‡çš„-React-ç»„ä»¶" class="headerlink" title="è®¾è®¡é«˜è´¨é‡çš„ React ç»„ä»¶"></a>è®¾è®¡é«˜è´¨é‡çš„ React ç»„ä»¶</h3><h4 id="åˆ†è€Œæ²»ä¹‹"><a href="#åˆ†è€Œæ²»ä¹‹" class="headerlink" title="åˆ†è€Œæ²»ä¹‹"></a>åˆ†è€Œæ²»ä¹‹</h4><p>æŠŠé—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå°é—®é¢˜ï¼Œå¿…è¦çš„æ—¶å€™å¯ä»¥æ‹†åˆ†å¤§ç»„ä»¶ï¼Œåˆ†ä¸ºå°ç»„ä»¶ã€‚<br>ç»„ä»¶åˆ’åˆ†è¦æ»¡è¶³ é«˜å†…èš ä½è€¦åˆ</p><blockquote><p>é«˜å†…èš ï¼šæŠŠé€»è¾‘ç´§å¯†çš„å†…å®¹æ”¾åœ¨ä¸€ä¸ªç»„ä»¶ä¸­<br>ä½è€¦åˆ ï¼šä¸åŒç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»è¦å°½é‡å¼±åŒ–</p></blockquote><h4 id="state-props"><a href="#state-props" class="headerlink" title="state props"></a>state props</h4><p>å¯¹å¤–ç”¨ props<br>å†…éƒ¨ç”¨ state</p><h5 id="propTypes"><a href="#propTypes" class="headerlink" title="propTypes"></a>propTypes</h5><p>counter(è¿™æ˜¯ä¸ªç»„ä»¶å).proptypes = {<br>a:PropTypes.string.isRequired<br>B:PropTypes.number<br>}</p><p>è§„å®šäº† a å±æ€§è¿™ä¸ªå¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¹¶ä¸”å¿…é¡»æœ‰å€¼ï¼Œä¸èƒ½ undefined å•¥çš„<br>ä½†æ˜¯è¿™ä¸ª B å› ä¸ºæ²¡æœ‰ isRequired æ‰€ä»¥æ²¡æœ‰ B ä¹Ÿæ— æ‰€è°“</p><p>è¿™ä¸ª propTypes æ˜¯ä¸ªè¾…åŠ©å¼€å‘çš„åŠŸèƒ½ï¼Œå¯ä»¥ä¸å†™çš„<br>å¦‚æœå†™äº†è¿™ç©æ„ï¼Œè¦åœ¨äº§å“ä¸Šçº¿å‘å¸ƒçš„æ—¶å€™ï¼Œç”¨ babel-react-optimize å»æ‰è¿™ä¸ªä¸œè¥¿ï¼Œç†ç”±å¦‚ä¸‹ï¼š</p><ol><li>å ç”¨ä»£ç ç©ºé—´</li><li>æ¶ˆè€— cpu è®¡ç®—èµ„æº</li><li>å¯¹ç”¨æˆ·è¾“å‡ºæŠ¥é”™æ— æ„ä¹‰</li></ol><h5 id="state-ä¸ç”¨-setState-æ–¹æ³•"><a href="#state-ä¸ç”¨-setState-æ–¹æ³•" class="headerlink" title="state ä¸ç”¨ setState æ–¹æ³•"></a>state ä¸ç”¨ setState æ–¹æ³•</h5><p>å¦‚æœä¸ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šé‡è›®çš„ä¿®æ”¹ state çš„å€¼ï¼Œä¸è¿‡å¹¶ä¸ä¼šè§¦å‘é©±åŠ¨ç»„ä»¶æ›´æ–°ã€‚æ‰€ä»¥é¡µé¢ä¸Šæ²¡æœ‰æ•ˆæœã€‚</p><h5 id="ä¸è¦ç›´æ¥ä¿®æ”¹ä¼ æŸ“æºçš„-props-å¯¹è±¡çš„å€¼"><a href="#ä¸è¦ç›´æ¥ä¿®æ”¹ä¼ æŸ“æºçš„-props-å¯¹è±¡çš„å€¼" class="headerlink" title="ä¸è¦ç›´æ¥ä¿®æ”¹ä¼ æŸ“æºçš„ props å¯¹è±¡çš„å€¼"></a>ä¸è¦ç›´æ¥ä¿®æ”¹ä¼ æŸ“æºçš„ props å¯¹è±¡çš„å€¼</h5><p>å¦‚æœä¸€ä¸ªå­ç»„ä»¶æ”¹äº† props çš„å€¼ï¼Œå…¶ä»–å­ç»„ä»¶å°±ä¼šé™·å…¥ç¨‹åºæ··ä¹±äº†ã€‚æ‰€ä»¥ä¸è¡Œä¸å…è®¸è¿™æ ·å¤„ç†</p><h3 id="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h3><h4 id="è£…è½½è¿‡ç¨‹"><a href="#è£…è½½è¿‡ç¨‹" class="headerlink" title="è£…è½½è¿‡ç¨‹"></a>è£…è½½è¿‡ç¨‹</h4><p>constructon<br>getInitalState<br>getDefaultProps<br>componentWillMount<br>render<br>componentDidMount</p><h5 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h5><p>ä½¿ç”¨è¿™ä¸ªé€‚ç”¨äºä¸‹é¢ç›®çš„ï¼š</p><ul><li>åˆå§‹åŒ– state</li><li>ç»‘å®šæˆå‘˜å‡½æ•°çš„ this ç¯å¢ƒ</li></ul><p>this.onClickButton = this.onClickButton.bind(this)</p><p>è¿™æ ·å†™ï¼Œä¼šç”¨è¿‡ bind æ–¹æ³•ï¼Œè®©å½“å‰å®ä¾‹ä¸­ onClickButton å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œthis æŒ‡å‘å§‹ç»ˆéƒ½æ˜¯å½“å‰ç»„ä»¶å®ä¾‹ã€‚</p><p>this.foo = ::this.foo;<br>ç­‰åŒäºï¼š<br>this.foo = this.foo.bind(this);<br>è¿™é‡Œ:: ä¸¤ä¸ªå†’å·çš„æ“ä½œç¬¦å«åš bind æ“ä½œç¬¦ã€‚<br>ä¸çŸ¥é“æ˜¯ä¸æ˜¯ ES æ ‡å‡†è¯­æ³•ï¼Œæš‚æ—¶ä¸æ¨èä½¿ç”¨</p><h5 id="render"><a href="#render" class="headerlink" title="render"></a>render</h5><p>render å‡½æ•°åªæ˜¯è¿”å›ä¸€ä¸ª JSX æè¿°çš„ç»“æ„ï¼Œæœ€ç»ˆç”± React æ¥æ“ä½œæ¸²æŸ“çš„è¿‡ç¨‹<br>render å‡½æ•°åº”è¯¥æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œä¸è¦äº§ç”Ÿä»»ä½•çš„å‰¯ä½œç”¨ï¼Œ<br>åœ¨ render å‡½æ•°ä¸­å»è°ƒç”¨ this.setState æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºä¸€ä¸ªçº¯å‡½æ•°ä¸åº”è¯¥å¼•èµ·çŠ¶æ€çš„æ”¹å˜</p><h5 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h5><p>render è°ƒç”¨å®Œä»¥åï¼ŒcomponentDidmount å¹¶ä¸ä¼šè¢«ç«‹åˆ»è°ƒç”¨ï¼Œå½“ä»–è°ƒç”¨çš„æ—¶å€™ï¼Œrender å‡½æ•°è¿”å›çš„ä¸œè¥¿å·²ç»å¼•å‘äº†æ¸²æŸ“ï¼Œ<br>ç»„ä»¶å·²ç»è¢«â€œè£…è½½â€åˆ° DOM æ ‘ä¸Šã€‚<br>render å‡½æ•°æœ¬èº«å¹¶ä¸ç‹ DOM æ ‘ä¸Šæ¸²æŸ“æˆ–è€…è£…è½½å†…å®¹ï¼Œå®ƒåªæ˜¯è¿”å›ä¸€ä¸ª JSX å¯¹è±¡ï¼Œç„¶åç”± React åº“å†³å®šå¦‚ä½•æ¸²æŸ“ã€‚<br>è€Œ React åº“è¦æŠŠæ‰€æœ‰çš„ç»„ä»¶éƒ½è¿”å›ç»“æœç»¼åˆèµ·æ¥ä»¥åï¼Œæ‰èƒ½åšå‡ºå¯¹åº” dom ä¿®æ”¹ï¼Œæ‰€ä»¥ï¼Œåœ¨æ‰€æœ‰ç»„ä»¶éƒ½ render å®Œäº‹äº†ä»¥åï¼Œ<br>æ‰ä¼šå¼€å§‹è¿›è¡Œè°ƒç”¨å„ä¸ªç»„ä»¶çš„ componentDidMount<br>componentDidMount åªåœ¨æµè§ˆå™¨ç«¯æ‰§è¡Œ</p><h4 id="æ›´æ–°è¿‡ç¨‹"><a href="#æ›´æ–°è¿‡ç¨‹" class="headerlink" title="æ›´æ–°è¿‡ç¨‹"></a>æ›´æ–°è¿‡ç¨‹</h4><p>componentWillReceiveProps<br>shouldComponentUpdate<br>componentWillUpdate<br>render<br>componentDidUpdate</p><h5 id="componentWillReceiveProps-nextProps"><a href="#componentWillReceiveProps-nextProps" class="headerlink" title="componentWillReceiveProps(nextProps)"></a>componentWillReceiveProps(nextProps)</h5><p>åªè¦æ˜¯å‰¯ç»„ä»¶çš„ render è¢«è°ƒç”¨ï¼Œåœ¨ render é‡Œæ¸²æŸ“çš„å­ç»„ä»¶å°±ä¼šç»å†æ›´æ–°çš„è¿‡ç¨‹ï¼Œé€—å·<br>ä¸ç®¡çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶çš„ props æœ‰æ²¡æœ‰æ”¹å˜ï¼Œéƒ½ä¼šè§¦å‘ä¸Šé¢è¿™ä¸ªç”Ÿå‘½ç”Ÿå‘½å‘¨æœŸ<br>âš ï¸ æ³¨æ„ï¼šå­ç»„ä»¶å†…é€šè¿‡ this.setState æ–¹æ³•è§¦å‘çš„æ›´æ–°è¿‡ç¨‹ä¸ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ç†ç”±å¦‚ä¸‹ï¼š<br>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°é€‚åˆæ ¹æ®æ–°çš„ props å€¼ï¼Œä¹Ÿå°±æ˜¯å‚æ•° nextProps æ¥è®¡ç®—å‡ºæ˜¯ä¸æ˜¯è¦æ›´æ–°å†…éƒ¨çŠ¶æ€ stateï¼Œ<br>æ›´æ–°ç»„ä»¶å†…éƒ¨æ–¹æ³•å°±æ˜¯ this.setStateï¼Œå¦‚æœ setState ä¼šå¯¼è‡´è¿™ä¸ªç”Ÿå‘½å‘¨æœŸè°ƒç”¨ï¼Œå°±æ­»å¾ªç¯äº†é¸­</p><h5 id="shouldComponentUpdate-nextProps-nextState"><a href="#shouldComponentUpdate-nextProps-nextState" class="headerlink" title="shouldComponentUpdate(nextProps,nextState)"></a>shouldComponentUpdate(nextProps,nextState)</h5><p>å†³å®šä¸€ä¸ªç»„ä»¶ä»€ä¹ˆæ—¶å€™ä¸éœ€è¦æ¸²æŸ“<br>å’Œ render æ˜¯ React ç”Ÿå‘½å‘¨æœŸä¸­å”¯äºŒè¦æ±‚æœ‰è¿”å›ç»“æœçš„å‡½æ•°ï¼›<br>è¿™ä¸ªå‡½æ•°è¦è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå‘Šè¯‰ React è¿™ä¸ªç»„ä»¶è¿™æ¬¡æ˜¯å¦è¦ç»§ç»­æ›´æ–°</p><pre><code class="hljs kotlin">shouldComponentUpdata(nextProps,nextStates)&#123;  <span class="hljs-keyword">return</span> (nextProps.caption !== <span class="hljs-keyword">this</span>.props.Caption) ||   (nextState.count !== <span class="hljs-keyword">this</span>.state.count)&#125;</code></pre><h4 id="å¸è½½è¿‡ç¨‹"><a href="#å¸è½½è¿‡ç¨‹" class="headerlink" title="å¸è½½è¿‡ç¨‹"></a>å¸è½½è¿‡ç¨‹</h4><h5 id="conponentWillUnmount"><a href="#conponentWillUnmount" class="headerlink" title="conponentWillUnmount"></a>conponentWillUnmount</h5><p>conponentWillUnmount å¾€å¾€ä¸ componnetDidMount æœ‰å…³ï¼Œæ¯”å¦‚ç”¨äº†é React çš„æ–¹æ³•åˆ›é€ äº†ä¸€äº› DOM å…ƒç´ ï¼Œ<br>å¦‚æœä¸ç®¡ç†çš„è¯ä¼šå¯èƒ½é€ æˆå†…å­˜æ³„æ¼ï¼Œå°±éœ€è¦åœ¨è¿™é‡Œå¤„ç†æ‰</p><h3 id="state-å’Œ-prop-çš„å±€é™"><a href="#state-å’Œ-prop-çš„å±€é™" class="headerlink" title="state å’Œ prop çš„å±€é™"></a>state å’Œ prop çš„å±€é™</h3><ol><li>çˆ¶ç»„ä»¶ å­ç»„ä»¶ å­™å­ç»„ä»¶ä»€ä¹ˆçš„ä¼šæœ‰é‡å¤çš„æ•°æ®</li><li>åŒ…å« 3 çº§æˆ–è€…ä»¥ä¸Šçš„ç»„ä»¶ç»“æ„ï¼Œå¯èƒ½ä¸­é—´é‚£ä¸€å±‚æ ¹æœ¬å°±ç”¨ä¸ä¸Šè¿™ä¸ª propï¼Œä½†æ˜¯å´è¿˜è¦ä¼ é€’<blockquote><p>ç®€ç§°ä¸ºæ•°æ®çš„å†—ä½™å’Œé‡å¤</p></blockquote></li></ol><h2 id="ä»-Flux-åˆ°-Redux"><a href="#ä»-Flux-åˆ°-Redux" class="headerlink" title="ä» Flux åˆ° Redux"></a>ä» Flux åˆ° Redux</h2><h3 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h3><p>å•å‘æ•°æ®æµ</p><h4 id="MVC-æ¡†æ¶çš„ç¼ºé™·"><a href="#MVC-æ¡†æ¶çš„ç¼ºé™·" class="headerlink" title="MVC æ¡†æ¶çš„ç¼ºé™·"></a>MVC æ¡†æ¶çš„ç¼ºé™·</h4><p>Model æ¨¡å‹ å¤§éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘åº”è¯¥æ”¾åœ¨è¿™é‡Œ<br>View è§†å›¾ è¿™é‡Œåº”è¯¥å°½é‡é¿å…ä¸šåŠ¡é€»è¾‘<br>Controller æ§åˆ¶å™¨ è´Ÿè´£æ¥å—ç”¨æˆ·è¾“å…¥ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥è°ƒç”¨å¯¹åº”çš„ Model é€»è¾‘ï¼Œäº§ç”Ÿçš„ç»“æœç»™ View å±‚</p><p>ä½†æ˜¯å„ä¸ªä¸ç”¨æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»è®©ç³»ç»Ÿå˜å¾—è„†å¼±ä¸”ä¸å¯é¢„æµ‹<br>model å’Œ view ä¹‹é—´çš„é€šä¿¡è®©å±€é¢å˜å¾—çƒ‚ä¸ƒå…«ç³Ÿ</p><p>æ‰€ä»¥å°±æ•´å‡ºè¿™ä¸ª Flux<br>action åˆ° dispatch åˆ° store åˆ° view<br>view é€šè¿‡ action è°ƒç”¨ dispatch</p><p>å­˜åœ¨äº Flux æ¡†æ¶ä¸­çš„ React ç»„ä»¶éœ€è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>åˆ›å»ºæ—¶è¦è¯»å– Store ä¸Šçš„çŠ¶æ€æ¥åˆå§‹åŒ–ç»„ä»¶å†…éƒ¨å½¢æ€</li><li>å½“ Store ä¸ŠçŠ¶æ€å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œç»„ä»¶è¦ç«‹åˆ»åŒæ­¥æ›´æ–°å†…éƒ¨çŠ¶æ€ä¿æŒä¸€è‡´</li><li>view å¦‚æœè¦æ”¹å˜ Store çŠ¶æ€ï¼Œå¿…é¡»ä¸”åªèƒ½æ´¾å‘ action</li></ul><h4 id="Flux-çš„ä¸è¶³"><a href="#Flux-çš„ä¸è¶³" class="headerlink" title="Flux çš„ä¸è¶³"></a>Flux çš„ä¸è¶³</h4><ul><li>åœ¨ Flux ä½“ç³»ä¸­ï¼Œå¦‚æœä¸¤ä¸ª Store ä¹‹é—´æœ‰é€»è¾‘ä¾èµ–å…³ç³»ï¼Œå°±å¿…é¡»ç”¨ä¸Š Dispatcher çš„ waitFor å‡½æ•°ã€‚ä¾èµ–å…³ç³»å¤„ç†ä¸å¤Ÿä¼˜é›…</li><li>éš¾ä»¥è¿›è¡ŒæœåŠ¡å™¨ç«¯çš„æ¸²æŸ“</li><li>stroe æ··æ‚äº†é€»è¾‘å’ŒçŠ¶æ€</li></ul><h3 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h3><p>redux æ˜¯ flux çš„ä¸€ç§å®ç°ã€‚</p><p>redux çš„åŸºæœ¬åŸåˆ™</p><ul><li>å”¯ä¸€æ•°æ®æº<br>åº”ç”¨çš„çŠ¶æ€æ•°æ®ç½®å­˜å‚¨åœ¨å”¯ä¸€çš„ä¸€ä¸ª store ä¸Š</li><li>ä¿æŒçŠ¶æ€åªè¯»<br>è¦ä¿®æ”¹ store çŠ¶æ€ï¼Œå¿…é¡»é€šè¿‡æ´¾å‘ä¸€ä¸ª action å¯¹è±¡å®Œæˆã€‚ä½†æ˜¯æ”¹å˜çŠ¶æ€çš„æ–¹æ³•ä¸æ˜¯å»ä¿®æ”¹çŠ¶æ€ä¸Šçš„å€¼ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€å¯¹è±¡è¿”å›ç»™ Redux</li><li>æ•°æ®æ”¹å˜åªèƒ½é€šè¿‡çº¯å‡½æ•°å®Œæˆ<br>reducer å¿…é¡»æ˜¯çº¯å‡½æ•°<br>reducer åªè´Ÿè´£è®¡ç®—çŠ¶æ€ï¼Œä¸è´Ÿè´£å­˜å‚¨çŠ¶æ€ã€‚</li></ul><h4 id="redux-å®ä¾‹"><a href="#redux-å®ä¾‹" class="headerlink" title="redux å®ä¾‹"></a>redux å®ä¾‹</h4><p>æˆ‘ä»¬åˆ›é€ ä¸€ä¸ª src/Store.js æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶è¾“å‡ºå…¨å±€å”¯ä¸€çš„é‚£ä¸ª Storeï¼Œä»£ç å¦‚ä¸‹:</p><pre><code class="hljs routeros">import &#123;createStore&#125; <span class="hljs-keyword">from</span> â€™reduxâ€™import reducer <span class="hljs-keyword">from</span> â€™. /Reducer.js â€™;const initValues = &#123; â€™Firstâ€™: 0, â€™Secondâ€™: 10, â€™Thirdâ€™: 20 &#125;const store= createStore (reducer, initValues);<span class="hljs-builtin-name">export</span><span class="hljs-built_in"> default </span>store;</code></pre><p>æƒ³è®°ç‚¹ä»€ä¹ˆ åˆæ— ä»ä¸‹æ‰‹ ã€‚ã€‚è¿™æ®µçŸ¥è¯†ï¼Œï¼Œï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆè¡¨è¾¾</p><p>åœ¨ redux æ¡†æ¶ä¸‹ï¼Œä¸€ä¸ª react ç»„ä»¶åŸºæœ¬ä¸Šå°±æ˜¯è¦å®Œæˆä»¥ä¸‹ï¼š</p><ol><li>å’Œ redux store æ‰“äº¤é“ï¼Œè¯»å– store çŠ¶æ€ï¼Œç”¨äºåˆå§‹åŒ–ç»„ä»¶çš„çŠ¶æ€ï¼ŒåŒæ—¶è¿˜è¦ç›‘å¬ store çš„çŠ¶æ€æ”¹å˜<br>å½“ store çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéœ€è¦æ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œä»è€Œé©±åŠ¨ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼›å½“éœ€è¦æ›´æ–° store çŠ¶æ€æ—¶ï¼Œå°±è¦æ´¾å‘ action å¯¹è±¡</li><li>æ ¹æ®å½“å‰ props å’Œ stateï¼Œæ¸²æŸ“å‡ºç”¨æˆ·ç•Œé¢ã€‚</li></ol><p>æ‰€ä»¥æŠŠ react ç»„ä»¶æ‹†åˆ†ä¸ºä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªç»„ä»¶è´Ÿè´£è·Ÿ redux store æ‰“äº¤é“ï¼Œå¤„äºå¤–å±‚ï¼Œç§°ä¸º<strong>å®¹å™¨ç»„ä»¶</strong> ï¼ˆèªæ˜ç»„ä»¶ï¼‰<br>è´Ÿè´£æ¸²æŸ“ç•Œé¢çš„ç»„ä»¶åœ¨å†…å±‚ï¼Œç§°ä¸º<strong>å±•ç¤ºç»„ä»¶</strong> ï¼ˆå‚»ç“œç»„ä»¶ï¼‰</p><h4 id="ç»„ä»¶-Context"><a href="#ç»„ä»¶-Context" class="headerlink" title="ç»„ä»¶ Context"></a>ç»„ä»¶ Context</h4><p>ä¸Šä¸‹æ–‡ç¯å¢ƒ<br>æœå…ˆä¸Šçº§ç»„ä»¶è¦å®£ç§°è‡ªå·±æ”¯æŒ contextï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªå‡½æ•°æ¥è¿”å›ä»£è¡¨ Context çš„ å¯¹è±¡<br>ç„¶åï¼Œè¿™ä¸ªä¸Šçº§ç»„ä»¶ä¹‹ä¸‹çš„æ‰€æœ‰å­å­™ç»„ä»¶ï¼Œåªè¦å®£ç§°è‡ªå·±éœ€è¦è¿™ä¸ª contextï¼Œå°±å¯ä»¥ é€šè¿‡ this.context è®¿é—®åˆ°è¿™ä¸ªå…±åŒçš„ç¯å¢ƒå¯¹è±¡ã€‚</p><h4 id="provider"><a href="#provider" class="headerlink" title="provider"></a>provider</h4><pre><code class="hljs scala"><span class="hljs-keyword">import</span> &#123;<span class="hljs-type">PropTypes</span>, <span class="hljs-type">Component</span>&#125; from â€™reactâ€™;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Provider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123; getChildContext&#123;) &#123;<span class="hljs-keyword">return</span> &#123;store: <span class="hljs-keyword">this</span>.props.storerender() &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.props.children;  &#125;&#125;</code></pre><p>å°±æ˜¯åœ¨æ¯ä¸ªç»„ä»¶å¤–å±‚éƒ½å¥—ä¸Š</p><pre><code class="hljs apache"><span class="hljs-section">&lt;Provider&gt;</span>  <span class="hljs-section">&lt;Children/&gt;</span><span class="hljs-section">&lt;/Provider&gt;</span></code></pre><p>é™¤äº†å§æ¸²æŸ“å·¥ä½œå®Œå…¨äº¤ç»™å­ç»„ä»¶ï¼ŒProvider è¿˜è¦æä¾›ä¸€ä¸ªå‡½æ•° getChildContext ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„å°±æ˜¯ä»£è¡¨ Context çš„å¯¹è±¡ã€‚<br>ä¸ºäº†è®© Provider èƒ½å¤Ÿè¢« React è®¤å¯ä¸ºä¸€ä¸ª Context çš„æä¾›è€…ï¼Œè¿˜éœ€è¦æŒ‡å®š Provider çš„ childContextTypes å±æ€§ï¼Œ ä»£ç å¦‚ä¸‹:</p><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Provider</span>.</span></span>childContextTypes = &#123;   store: <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">PropTypes</span>.</span></span>ob]ect&#125;</code></pre><p>Provider åªæ˜¯æŠŠæ¸²æŸ“å·¥ä½œå®Œå…¨äº¤ç»™å­ç»„ä»¶ï¼Œå®ƒæ‰®æ¼”çš„è§’è‰²åªæ˜¯æä¾› Contextï¼ŒåŒ…ä½äº†æœ€é¡¶å±‚çš„ ç»„ä»¶ï¼Œä¹Ÿå°±è®© context è¦†ç›–äº†æ•´ä¸ªåº”ç”¨ä¸­æ‰€æœ‰ç»„ä»¶ã€‚</p><p>ä¸ºäº†è®© CounterContainer èƒ½å¤Ÿè®¿é—®åˆ° contextï¼Œå¿…é¡»ç»™ CounterContainer ç±»çš„ contextÂ­<br>Types èµ‹å€¼å’Œ Provider.childContextTypes ä¸€æ ·çš„å€¼ï¼Œä¸¤è€…å¿…é¡»ä¸€è‡´ï¼Œä¸ç„¶å°±æ— æ³•è®¿é—®åˆ° contextï¼Œä»£ç å¦‚ä¸‹:<br><code>CounterContainer.contextTypes = { store: PropTypes.ã€‚bject</code><br>åœ¨ CounterContainer ä¸­ï¼Œæ‰€æœ‰å¯¹ store çš„è®¿é—®ï¼Œéƒ½æ˜¯é€šè¿‡ this.context.store å®Œæˆï¼Œå›  ä¸º this.context å°±æ˜¯ Provider æä¾›çš„ context å¯¹è±¡ï¼Œæ‰€ä»¥ getOwnState å‡½æ•°ä»£ç å¦‚ä¸‹:</p><pre><code class="hljs kotlin">getOwnState() &#123;  <span class="hljs-keyword">return</span> &#123;    value: <span class="hljs-keyword">this</span> .context. store .getState () [<span class="hljs-keyword">this</span>. props .caption]  &#125;&#125;</code></pre><p>è¿˜æœ‰ä¸€ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬è‡ªå·±å®šä¹‰äº†æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥è¦ç”¨ä¸Šç¬¬äºŒä¸ªå‚æ•° contextï¼Œä»£ç <br>å¦‚ä¸‹:<br>constructor (props, context) { super(props, context);<br>åœ¨è°ƒç”¨ super çš„æ—¶å€™ï¼Œä¸€å®šè¦å¸¦ä¸Š context å‚æ•°ï¼Œè¿™æ ·æ‰èƒ½è®© React ç»„ä»¶åˆå§‹åŒ–å®ä¾‹<br>ä¸­çš„ contextï¼Œä¸ç„¶ç»„ä»¶çš„å…¶ä»–éƒ¨åˆ†å°±æ— æ³•ä½¿ç”¨ this.contextã€‚</p><h3 id="React-Redux"><a href="#React-Redux" class="headerlink" title="React-Redux"></a>React-Redux</h3><p>connect : é“¾æ¥å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶ï¼Œ<br>æŠŠ store ä¼¤çš„çŠ¶æ€è½¬åŒ–ä¸ºå†…å±‚å‚»ç“œç»„ä»¶çš„ propï¼ŒæŠŠå†…å±‚å‚»ç“œç»„ä»¶ä¸­çš„ç”¨æˆ·åŠ¨ä½œè½¬åŒ–ä¸ºæ´¾é€ç»™ store çš„åŠ¨ä½œ</p><p>Providerï¼šæä¾›åŒ…å« store çš„ context</p><hr><p>export default connect(mapStateToProps, mapDispatchToProps) (Cunter)</p><p>ä¸€ä¸ªçŠ¶æ€èŠ‚ç‚¹åªå±äºä¸€ä¸ªæ¨¡å—ï¼Œè¿™é‡Œçš„â€œæ‹¥æœ‰æƒâ€æŒ‡çš„æ˜¯â€œä¿®æ”¹æƒâ€ï¼Œè€Œä¸æ˜¯â€œè¯»å–æƒâ€ï¼Œ<br>å®é™…ä¸Šï¼ŒRedux Store ä¸Šçš„å…¨éƒ¨çŠ¶æ€ï¼Œåœ¨ä»»ä½•æ—¶å€™ï¼Œå¯¹ä»»ä½•æ¨¡å—éƒ½æ˜¯å¯ä»¥è¯»å–çš„ï¼Œä½†æ˜¯æ›´æ–°ä¿®æ”¹åªèƒ½ä¸Šè·Ÿè‡ªå·±ç›¸å…³çš„é‚£ä¸€éƒ¨åˆ†æ¨¡å—çš„æ•°æ®</p><p>åœ¨è®¾è®¡ redux store çš„çŠ¶æ€æ ‘æ—¶ï¼Œè¦å°½é‡ä¿æŒæ ‘å½¢ç»“æ„çš„æ‰å¹³ã€‚ä¸€ä¸ªå¾ˆå¤æ‚çš„çŠ¶æ€æ ‘æ˜¯éš¾ä»¥ç®¡ç†çš„ã€‚</p><h3 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h3><h4 id="æ“çºµ-prop"><a href="#æ“çºµ-prop" class="headerlink" title="æ“çºµ prop"></a>æ“çºµ prop</h4><p>é«˜é˜¶ç»„ä»¶å¯ä»¥å¢å‡/åˆ é™¤/ä¿®æ”¹ä¼ é€’ç»™åŒ…è£¹ç»„ä»¶çš„ props åˆ—è¡¨</p><pre><code class="hljs scala">const addNewProps = (<span class="hljs-type">WrappedComponent</span>, newProps) =&gt; &#123;  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WrappingComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;    render()&#123;      <span class="hljs-keyword">return</span> &lt;<span class="hljs-type">WrappedComponent</span> &#123;...<span class="hljs-keyword">this</span>.props&#125; &#123;...newProps &#125;&gt;    &#125;  &#125;&#125;</code></pre><h4 id="è®¿é—®-ref"><a href="#è®¿é—®-ref" class="headerlink" title="è®¿é—® ref"></a>è®¿é—® ref</h4><pre><code class="hljs kotlin"><span class="hljs-keyword">const</span> refsHOC =(WrappedComponent) =&gt; &#123;  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HOCComponent</span> <span class="hljs-title">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;    <span class="hljs-keyword">constructor</span>()&#123;      <span class="hljs-keyword">super</span>(...arguments)      <span class="hljs-keyword">this</span>.linkRef = <span class="hljs-keyword">this</span>.linkRef.bind(<span class="hljs-keyword">this</span>)    &#125;    linkRef(wrappedInstance)&#123;      <span class="hljs-keyword">this</span>._root = wrappedInstance;    &#125;    render()&#123;      <span class="hljs-keyword">const</span> props = &#123;...<span class="hljs-keyword">this</span>.props, ref: <span class="hljs-keyword">this</span>.linkRef&#125;      <span class="hljs-keyword">return</span> &lt;WrappedComponent &#123;...props&#125;&gt;    &#125;  &#125;&#125;</code></pre><h4 id="æŠ½å–çŠ¶æ€"><a href="#æŠ½å–çŠ¶æ€" class="headerlink" title="æŠ½å–çŠ¶æ€"></a>æŠ½å–çŠ¶æ€</h4><p>æ¯”å¦‚ react-redux çš„ connect å‡½æ•°<br>åœ¨å‚»ç“œç»„ä»¶é€šå¸¸ä¸è¦ç®¡ç†è‡ªå·±çš„çŠ¶æ€ï¼Œæ‰€æœ‰çŠ¶æ€çš„ç®¡ç†éƒ½äº¤ç»™å¤–é¢ çš„å®¹å™¨ç»„ä»¶ï¼Œè¿™ä¸ªæ¨¡å¼å°±æ˜¯â€œæŠ½å–çŠ¶æ€â€</p><pre><code class="hljs scala">const doNothing = () =&gt; (&#123;&#125;);function connect(mapStateToProps=doNothing,mapDispatchToProps=doNothing)&#123;  <span class="hljs-keyword">return</span> function(<span class="hljs-type">WrappedComponent</span>)&#123;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HOCComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;      <span class="hljs-comment">// åœ¨è¿™é‡Œå®šä¹‰HOCComponentçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</span>    &#125;    <span class="hljs-type">HOCComponent</span>.contextTypes = &#123;      store: <span class="hljs-type">React</span>.<span class="hljs-type">PropTypes</span><span class="hljs-class">.<span class="hljs-keyword">object</span></span><span class="hljs-class">    &#125;</span><span class="hljs-class">    <span class="hljs-title">return</span> <span class="hljs-title">HOCComponent</span></span>;  &#125;&#125;</code></pre><h4 id="åŒ…è£…ç»„ä»¶"><a href="#åŒ…è£…ç»„ä»¶" class="headerlink" title="åŒ…è£…ç»„ä»¶"></a>åŒ…è£…ç»„ä»¶</h4><pre><code class="hljs scala">const styleHOC = (<span class="hljs-type">WrappedComponent</span>, style) =&gt; &#123;  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HOCComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;    render()&#123;      <span class="hljs-keyword">return</span> (        &lt;div style=&#123;style&#125;&gt;          &lt;<span class="hljs-type">WrappedComponent</span> &#123;...<span class="hljs-keyword">this</span>.props&#125;&gt;        &lt;/div&gt;      )    &#125;  &#125;&#125;</code></pre><h3 id="ç»§æ‰¿æ–¹å¼çš„é«˜é˜¶ç»„ä»¶"><a href="#ç»§æ‰¿æ–¹å¼çš„é«˜é˜¶ç»„ä»¶" class="headerlink" title="ç»§æ‰¿æ–¹å¼çš„é«˜é˜¶ç»„ä»¶"></a>ç»§æ‰¿æ–¹å¼çš„é«˜é˜¶ç»„ä»¶</h3><p>æš‚æ—¶ä¸ç†è§£ ï¼Œä¸å†™äº†</p><h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><p>polyfill æŒ‡çš„æ˜¯â€œç”¨äºå®ç°æµè§ˆå™¨ä¸æ”¯æŒåŸç”ŸåŠŸèƒ½çš„ä»£ç â€ï¼Œæ¯”å¦‚ï¼Œç°ä»£æµè§ˆå™¨åº”<br>è¯¥æ”¯æŒ fetch å‡½æ•°ï¼Œå¯¹äºä¸æ”¯æŒçš„æµè§ˆå™¨ï¼Œç½‘é¡µä¸­å¼•å…¥å¯¹åº” fetch çš„ polyfill åï¼Œ è¿™ä¸ª polyfill å°±ç»™å…¨å±€çš„ window å¯¹è±¡ä¸Šå¢åŠ ä¸€ä¸ª fetch å‡½æ•°ï¼Œè®©è¿™ä¸ªç½‘é¡µä¸­çš„ JavaScript å¯ä»¥ç›´æ¥ä½¿ç”¨ fetch å‡½æ•°äº†ï¼Œå°±å¥½åƒæµè§ˆå™¨æœ¬æ¥å°±æ”¯æŒ fetch ä¸€æ · ã€‚ åœ¨ è¿™ä¸ªé“¾æ¥ä¸Š<a href="https://github.com/github/fetchå¯ä»¥æ‰¾åˆ°fetchpolyfillçš„ä¸€ä¸ªå®ç°ã€‚" target="_blank" rel="noopener">https://github.com/github/fetchå¯ä»¥æ‰¾åˆ°fetchpolyfillçš„ä¸€ä¸ªå®ç°ã€‚</a></p><p>react ä½ æœ¬åœ°è°ƒè¯•çš„æ—¶å€™,ä½ ç›´æ¥è¯·æ±‚æ¥å£è‚¯å®šæ˜¯è·¨åŸŸäº†ï¼Œä½ çš„ç½‘é¡µåº”ç”¨åŸŸå localhostï¼Œä½ å¯¹åº”çš„æœåŠ¡å™¨åŸŸåä¹Ÿæ˜¯è¿™ç©æ„ï¼Œæ‰€ä»¥ä½ è·¨åŸŸå•Š<br>ä½†æ˜¯ä¸æ…Œï¼Œcreat react app æœ‰ä»£ç†åŠŸèƒ½ proxy ï¼ˆæ¥è·Ÿæˆ‘å‘éŸ³ï¼ŒæŠ›å…‹è¥¿ï¼‰</p><p>creat react-app é™Œç”Ÿæˆåº”ç”¨çš„ proxy åŠŸèƒ½åªæ˜¯æ–¹ä¾¿å¼€å‘ï¼Œåœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿<br>ç”¨è¿™ä¸ª proxy åŠŸèƒ½å°±ä¸åˆé€‚äº†ï¼Œåº”è¯¥è¦å¼€å‘å‡ºè‡ªå·±çš„ä»£ç†æœåŠ¡å™¨æ¥æ»¡è¶³ç”Ÿäº§ç¯å¢ƒ çš„éœ€è¦ ã€‚</p><h4 id="redux-thunk-ä¸­é—´ä»¶"><a href="#redux-thunk-ä¸­é—´ä»¶" class="headerlink" title="redux-thunk ä¸­é—´ä»¶"></a>redux-thunk ä¸­é—´ä»¶</h4><p>åœ¨ reducer è°ƒç”¨å‰è°ƒç”¨çš„ç©æ„å„¿<br>action =&gt; ä¸­é—´ä»¶ï¼ˆæ¯”å¦‚ thunkï¼‰=&gt; reducer =&gt; state</p><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><p>å•æµ‹æœ‰ä¸€å †æ¡†æ¶ã€‚<br>çœ‹äº†ä¸€éã€‚ã€‚ã€‚è¿˜æ˜¯ä¸æƒ³å†™å•æµ‹</p><h3 id="æ‰©å±•-REDUX"><a href="#æ‰©å±•-REDUX" class="headerlink" title="æ‰©å±• REDUX"></a>æ‰©å±• REDUX</h3><h4 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h4>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>-react -redux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>httpè¯·æ±‚æ–¹æ–¹é¢é¢å®‰æ’ä¸€æ³¢</title>
    <link href="/2020/07/01/request/"/>
    <url>/2020/07/01/request/</url>
    
    <content type="html"><![CDATA[<p>å‰è¨€ï¼šä¸‹è¾¹çš„å†…å®¹æ˜¯ä» XMLHttpRequestï¼Œåˆ°å°è£… XMLHttpRequestï¼Œå†åˆ° axiosã€‚<br>å¼„äº†å¾ˆä¹…å•Šï¼ŒæŸ¥èµ„æ–™ï¼ŒæŸ¥å®˜ç½‘ä¿¡æ¯ï¼Œæ•´ç†å„ç§æ–‡æ¡£ï¼Œè¾“å‡ºå„ç§è§‚ç‚¹ã€‚å·¨ä½¬ä»¬æ…¢æ…¢çœ‹å§ï½</p><h2 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="-XMLHttpRequest"></a>-XMLHttpRequest</h2><p>XMLHttpRequestï¼ˆXHRï¼‰å¯¹è±¡ç”¨äºä¸æœåŠ¡å™¨äº¤äº’ã€‚é€šè¿‡ XMLHttpRequest å¯ä»¥åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹è¯·æ±‚ç‰¹å®š URLï¼Œè·å–æ•°æ®ã€‚è¿™å…è®¸ç½‘é¡µåœ¨ä¸å½±å“ç”¨æˆ·æ“ä½œçš„æƒ…å†µä¸‹ï¼Œæ›´æ–°é¡µé¢çš„å±€éƒ¨å†…å®¹ã€‚XMLHttpRequest åœ¨ AJAX ç¼–ç¨‹ä¸­è¢«å¤§é‡ä½¿ç”¨ã€‚<br>å’±ä»¬ç¡¬æ ¸ä¸€ç‚¹ï¼Œç›´æ¥ä¸Šä»£ç </p><h4 id="ç®€å•ä¾‹å­-ğŸŒ°"><a href="#ç®€å•ä¾‹å­-ğŸŒ°" class="headerlink" title="ç®€å•ä¾‹å­ ğŸŒ°"></a>ç®€å•ä¾‹å­ ğŸŒ°</h4><pre><code class="hljs pgsql">let xhr = <span class="hljs-built_in">new</span> XMLHttpRequest();xhr.<span class="hljs-keyword">open</span>(<span class="hljs-string">'GET'</span>,<span class="hljs-string">'https://www.baidu.com'</span>,<span class="hljs-keyword">true</span>,username,<span class="hljs-keyword">password</span>); // è§£é‡Šä¸€ä¸‹å‚æ•°ã€‚<span class="hljs-keyword">GET</span>é‡Šè¯·æ±‚æ–¹æ³•ï¼Œå¿…é¡»å¾—æœ‰ï¼Œhttpè¯·æ±‚æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¸¸ç”¨post/<span class="hljs-keyword">get</span> ï¼Œè¿™é‡Œçš„å‚æ•°å†™æ³•ä¸åŒºåˆ†å¤§å°å†™ï¼Œå†™æˆâ€˜<span class="hljs-keyword">get</span>â€™ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ // ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯·æ±‚çš„urlï¼Œå¿…é¡»å¾—æœ‰ã€‚ // ç¬¬ä¸‰ä¸ªå‚æ•°è¿™é‡Œçš„<span class="hljs-keyword">true</span> ä»£è¡¨æ˜¯å¦å¼‚æ­¥ ï¼Œå¦‚æœæ˜¯<span class="hljs-keyword">true</span>å°±å¼‚æ­¥ï¼Œ<span class="hljs-keyword">false</span>å°±åŒæ­¥ ã€‚é»˜è®¤ä¸ºå¼‚æ­¥ã€‚ // usernameï¼šå¯é€‰å‚æ•°ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦éªŒè¯ï¼Œè¯¥å‚æ•°æŒ‡å®šç”¨æˆ·åï¼Œå¦‚æœæœªæŒ‡å®šï¼Œå½“æœåŠ¡å™¨éœ€è¦éªŒè¯æ—¶ï¼Œä¼šå¼¹å‡ºéªŒè¯çª—å£ã€‚ // <span class="hljs-keyword">password</span>ï¼šå¯é€‰å‚æ•°ï¼ŒéªŒè¯ä¿¡æ¯ä¸­çš„å¯†ç éƒ¨åˆ†ï¼Œå¦‚æœç”¨æˆ·åä¸ºç©ºï¼Œåˆ™è¯¥å€¼å°†è¢«å¿½ç•¥ã€‚xhr.send(body) // bodyæ˜¯é€šè¿‡è¯¥è¯·æ±‚å‘é€çš„å‚æ•°æ•°æ®å•¥çš„ï¼Œä¸ä¼ å°±ä¸ç”¨å¡«å†™ã€‚</code></pre><p>è¿™é‡Œæ’æ’­ä¸€ä¸‹è¯·æ±‚å¤±è´¥çš„é”™è¯¯ç ï¼Œæƒ³äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯æ”¾åœ¨è¿™ç¯‡æ–‡é‡Œè¾¹å§ï¼Œåæ­£å‘è¯·æ±‚å°±ä¼šæœ‰è¯·æ±‚å¤±è´¥çš„å¯èƒ½å˜›ã€‚<br>1xxï¼šæŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç†ã€‚<br>2xxï¼šæˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å—ã€‚<br>3xxï¼šé‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œã€‚<br>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°ã€‚<br>5xxï¼šæœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚ã€‚å¸¸è§çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°çš„è¯´æ˜å¦‚ä¸‹ã€‚<br>200 OKï¼šå®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸã€‚<br>400 Bad Requestï¼šå®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£ã€‚<br>401 Unauthorizedï¼šè¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’Œ WWW-Authenticate æŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ã€‚<br>403 Forbiddenï¼šæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ã€‚<br>404 Not Foundï¼šè¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œä¸¾ä¸ªä¾‹å­ï¼šè¾“å…¥äº†é”™è¯¯çš„ URLã€‚<br>500 Internal Server Errorï¼šæœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯ã€‚<br>503 Server Unavailableï¼šæœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸ï¼Œä¸¾ä¸ªä¾‹å­ï¼šHTTP/1.1 200 OKï¼ˆCRLFï¼‰ã€‚</p><p><strong>é€šå¸¸æŠ¥ 400 å¤šçš„æ—¶å€™ï¼Œå’±ä»¬å‰ç«¯å°±å·å·è‡ªå·±æ‰¾æ‰¾åŸå› ï¼ŒæŠ¥ 500 å¤šçš„æ—¶å€™ï¼Œç›´æ¥æ‰¾åç«¯å°±è¡Œã€‚</strong></p><p>ä¸Šè¾¹æ˜¯ä¸ªç®€å•çš„æ —å­ ğŸŒ°ï¼Œè®©æˆ‘ä»¬ä¸€ç‚¹ä¸€ç‚¹çš„å¾€ä¸ŠåŠ ä¸œè¥¿ï½</p><h3 id="onreadystatechange"><a href="#onreadystatechange" class="headerlink" title="onreadystatechange"></a>onreadystatechange</h3><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();xhr.open(<span class="hljs-string">'GET'</span>,<span class="hljs-string">'https://www.baidu.com'</span>,<span class="hljs-literal">true</span>,username,password);xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.readyState === <span class="hljs-number">4</span> &amp;&amp; <span class="hljs-keyword">this</span>.status === <span class="hljs-string">'200'</span>)&#123;    <span class="hljs-comment">// è¿™é‡Œthiså°±æ˜¯xhr this.readyState å°±æ˜¯ xhr.readyState</span>    <span class="hljs-keyword">do</span> something  &#125;&#125;xhr.send(body)</code></pre><p>è¿™ä¸ªæ —å­é‡Œ xhr å¤šäº†ä¸€ä¸ªå±æ€§ onreadystatechange ã€‚onreadystatechange æ˜¯ä¸€ä¸ªäº‹ä»¶å¥æŸ„ã€‚åè¾¹æ˜¯äº‹ä»¶è§¦å‘çš„å›è°ƒå‡½æ•°ã€‚å½“ XMLHttpRequest å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šè§¦å‘æ­¤å‡½æ•°ã€‚çŠ¶æ€ä» 0 (uninitialized) åˆ° 4 (complete) è¿›è¡Œå˜åŒ–ã€‚ä»…åœ¨çŠ¶æ€ä¸º 4 æ—¶ï¼Œæˆ‘ä»¬æ‰æ‰§è¡Œä»£ç ã€‚</p><p><em>è¡¥å……ä¸€ä¸‹ readyState çš„çŸ¥è¯†ï¼Œçœ‹çœ‹çŸ¥é“æœ‰è¿™ä¹ˆä¸ªäº‹å°±è¡Œã€‚</em><br><em>0 æœªåˆå§‹åŒ–ã€‚è¡¨ç¤ºå¯¹è±¡å·²ç»å»ºç«‹ï¼Œä½†æ˜¯å°šæœªåˆå§‹åŒ–ï¼Œå°šæœªè°ƒç”¨ open() æ–¹æ³•</em><br><em>1 åˆå§‹åŒ–ã€‚è¡¨ç¤ºå¯¹è±¡å·²ç»å»ºç«‹ï¼Œå°šæœªè°ƒç”¨ send() æ–¹æ³•</em><br><em>2 å‘é€æ•°æ®ã€‚è¡¨ç¤º send() æ–¹æ³•å·²ç»è°ƒç”¨ï¼Œä½†æ˜¯å½“å‰çš„çŠ¶æ€åŠ HTTP å¤´æœªçŸ¥</em><br><em>3 æ•°æ®ä¼ é€ä¸­ã€‚å·²ç»æ¥æ”¶éƒ¨åˆ†æ•°æ®ï¼Œå› ä¸ºå“åº”åŠ HTTP å¤´ä¸å®‰å…¨ï¼Œè¿™æ—¶é€šè¿‡ responseBody å’Œ responseText è·å–éƒ¨åˆ†æ•°æ®ä¼šå‡ºç°é”™è¯¯</em><br><em>4 å®Œæˆã€‚æ•°æ®æ¥æ”¶å®Œæ¯•ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ responseBody å’Œ responseText è·å–å®Œæ•´çš„å“åº”æ•°æ®</em></p><h3 id="å¦‚ä½•è®¾ç½®-request-header"><a href="#å¦‚ä½•è®¾ç½®-request-header" class="headerlink" title="å¦‚ä½•è®¾ç½® request header"></a>å¦‚ä½•è®¾ç½® request header</h3><p>setRequestHeader(name, value)</p><p>name å‚æ•°æ˜¯è¦è®¾ç½®çš„å¤´éƒ¨çš„åç§°ã€‚è¿™ä¸ªå‚æ•°ä¸åº”è¯¥åŒ…æ‹¬ç©ºç™½ã€å†’å·æˆ–æ¢è¡Œã€‚<br>value å‚æ•°æ˜¯å¤´éƒ¨çš„å€¼ã€‚è¿™ä¸ªå‚æ•°ä¸åº”è¯¥åŒ…æ‹¬æ¢è¡Œã€‚</p><pre><code class="hljs vhdl">let xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();xhr.<span class="hljs-keyword">open</span>(<span class="hljs-symbol">'GET</span>',<span class="hljs-symbol">'https</span>://www.baidu.com',<span class="hljs-literal">true</span>,username,password);xhr.setRequestHeader(<span class="hljs-symbol">'Content</span>-<span class="hljs-keyword">Type</span>', <span class="hljs-symbol">'one</span>');xhr.setRequestHeader(<span class="hljs-symbol">'Content</span>-<span class="hljs-keyword">Type</span>', <span class="hljs-symbol">'two</span>');// æœ€ç»ˆrequest headerä¸­<span class="hljs-string">"Content-Type"</span>ä¸º: one, twoxhr.send(<span class="hljs-keyword">body</span>)</code></pre><p>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•° header å¤§å°å†™ä¸æ•æ„Ÿï¼Œå³å¯ä»¥å†™æˆ content-typeï¼Œä¹Ÿå¯ä»¥å†™æˆ Content-Typeï¼Œç”šè‡³å†™æˆ content-Typeã€‚</p><p>Content-Type çš„é»˜è®¤å€¼ä¸å…·ä½“å‘é€çš„æ•°æ®ç±»å‹æœ‰å…³ã€‚</p><p>setRequestHeader å¿…é¡»åœ¨ open()æ–¹æ³•ä¹‹åï¼Œsend()æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå¦åˆ™ä¼šæŠ›é”™ã€‚</p><p>setRequestHeader å¯ä»¥è°ƒç”¨å¤šæ¬¡ï¼Œæœ€ç»ˆçš„å€¼ä¸ä¼šé‡‡ç”¨è¦†ç›– override çš„æ–¹å¼ï¼Œè€Œæ˜¯é‡‡ç”¨è¿½åŠ  append çš„æ–¹å¼ã€‚</p><h3 id="å¦‚ä½•æŒ‡å®š-xhr-response-çš„æ•°æ®ç±»å‹"><a href="#å¦‚ä½•æŒ‡å®š-xhr-response-çš„æ•°æ®ç±»å‹" class="headerlink" title="å¦‚ä½•æŒ‡å®š xhr.response çš„æ•°æ®ç±»å‹"></a>å¦‚ä½•æŒ‡å®š xhr.response çš„æ•°æ®ç±»å‹</h3><p>xhr.overrideMimeType(â€˜text/plain; charset=utf-8â€™) // xhr level 1 ä½¿ç”¨çš„æ–¹æ³•ã€‚</p><p>xhr.responseType = â€˜blobâ€™ // xhr level 2 å¯ä»¥ç”¨çš„ï¼Œæ¯”ä¸Šé¢ç®€å•å¾ˆå¤šï¼Œä½†æ˜¯è¯´æ˜¯å…¼å®¹æ€§ç¨å¾®å·®ä¸€ç‚¹ç‚¹ã€‚ä¸è¿‡æˆ‘æ²¡å‘ç°è¿‡ä»»ä½•é—®é¢˜ï¼Œæ¨èç”¨ä¸‹è¾¹çš„å†™æ³•</p><h3 id="å¦‚ä½•è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´"><a href="#å¦‚ä½•è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´" class="headerlink" title="å¦‚ä½•è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´"></a>å¦‚ä½•è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´</h3><p>å¦‚æœè¯·æ±‚è¿‡äº†å¾ˆä¹…è¿˜æ²¡æœ‰æˆåŠŸï¼Œä¸ºäº†ä¸ä¼šç™½ç™½å ç”¨çš„ç½‘ç»œèµ„æºï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä¸»åŠ¨ç»ˆæ­¢è¯·æ±‚ã€‚XMLHttpRequest æä¾›äº† timeout å±æ€§æ¥å…è®¸è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ã€‚<br>xhr.timeout = 0<br>å•ä½ï¼šmilliseconds æ¯«ç§’<br>é»˜è®¤å€¼ï¼š0ï¼Œå³ä¸è®¾ç½®è¶…æ—¶</p><p>âš ï¸ æ³¨æ„ï¼š<strong>å½“ xhr ä¸ºä¸€ä¸ª sync åŒæ­¥è¯·æ±‚æ—¶</strong>ï¼Œxhr.timeout å¿…é¡»ç½®ä¸º 0ï¼Œå¦åˆ™ä¼šæŠ›é”™ã€‚å¹¶ä¸” xhr.withCredentials å¿…é¡»ä¸º false</p><p>xhr.responseType å¿…é¡»ä¸ºâ€â€ï¼ˆæ³¨æ„ç½®ä¸ºâ€textâ€ä¹Ÿä¸å…è®¸ï¼‰</p><h3 id="å¦‚ä½•è·å–ä¸Šä¼ ã€ä¸‹è½½çš„è¿›åº¦"><a href="#å¦‚ä½•è·å–ä¸Šä¼ ã€ä¸‹è½½çš„è¿›åº¦" class="headerlink" title="å¦‚ä½•è·å–ä¸Šä¼ ã€ä¸‹è½½çš„è¿›åº¦"></a>å¦‚ä½•è·å–ä¸Šä¼ ã€ä¸‹è½½çš„è¿›åº¦</h3><p>åœ¨ä¸Šä¼ æˆ–è€…ä¸‹è½½æ¯”è¾ƒå¤§çš„æ–‡ä»¶æ—¶ï¼Œå®æ—¶æ˜¾ç¤ºå½“å‰çš„ä¸Šä¼ ã€ä¸‹è½½è¿›åº¦æ˜¯å¾ˆæ™®éçš„äº§å“éœ€æ±‚ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ onprogress äº‹ä»¶æ¥å®æ—¶æ˜¾ç¤ºè¿›åº¦ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿™ä¸ªäº‹ä»¶æ¯ 50ms è§¦å‘ä¸€æ¬¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šä¼ è¿‡ç¨‹å’Œä¸‹è½½è¿‡ç¨‹è§¦å‘çš„æ˜¯ä¸åŒå¯¹è±¡çš„ onprogress äº‹ä»¶ï¼š</p><p>ä¸Šä¼ è§¦å‘çš„æ˜¯ xhr.upload å¯¹è±¡çš„ onprogress äº‹ä»¶</p><p>ä¸‹è½½è§¦å‘çš„æ˜¯ xhr å¯¹è±¡çš„ onprogress äº‹ä»¶</p><pre><code class="hljs cs">xhr.onprogress = updateProgress;xhr.upload.onprogress = updateProgress;<span class="hljs-function">function <span class="hljs-title">updateProgress</span>(<span class="hljs-params"><span class="hljs-keyword">event</span></span>)</span> &#123;    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.lengthComputable) &#123;      <span class="hljs-keyword">var</span> completedPercent = <span class="hljs-keyword">event</span>.loaded / <span class="hljs-keyword">event</span>.total;    &#125; &#125;</code></pre><h3 id="å¦‚ä½•æ‰èƒ½ä¸­æ­¢è¯·æ±‚"><a href="#å¦‚ä½•æ‰èƒ½ä¸­æ­¢è¯·æ±‚" class="headerlink" title="å¦‚ä½•æ‰èƒ½ä¸­æ­¢è¯·æ±‚"></a>å¦‚ä½•æ‰èƒ½ä¸­æ­¢è¯·æ±‚</h3><p>xhr.onreadystatechange = function () {}; //æ¸…ç†äº‹ä»¶å“åº”å‡½æ•°<br>xhr.abort(); //ä¸­æ­¢è¯·æ±‚</p><p>åœ¨è°ƒç”¨ abort() æ–¹æ³•å‰ï¼Œåº”å…ˆæ¸…é™¤ onreadystatechange äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå› ä¸º IE å’Œ Mozilla åœ¨è¯·æ±‚ä¸­æ­¢åä¹Ÿä¼šæ¿€æ´»è¿™ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ã€‚å¦‚æœç»™ onreadystatechange å±æ€§è®¾ç½®ä¸º nullï¼Œåˆ™ IE ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œæ‰€ä»¥ä¸ºå®ƒè®¾ç½®ä¸€ä¸ªç©ºå‡½æ•°ã€‚</p><h3 id="è¯·æ±‚æˆåŠŸçš„å›è°ƒ"><a href="#è¯·æ±‚æˆåŠŸçš„å›è°ƒ" class="headerlink" title="è¯·æ±‚æˆåŠŸçš„å›è°ƒ"></a>è¯·æ±‚æˆåŠŸçš„å›è°ƒ</h3><p>å‰é¢å†™è¿‡ï¼Œå°±æ˜¯åœ¨ onreadystatechange åˆ¤æ–­ readyState == 4 ã€‚ã€‚ã€‚ã€‚ã€‚å»ä¸Šé¢çœ‹å“ˆ<br>å½“ç„¶å•¦ ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯æˆ‘æ¯”è¾ƒæ¨èçš„ï¼Œ</p><pre><code class="hljs lua">xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span></span> &#123;   //å¦‚æœè¯·æ±‚æˆåŠŸ   <span class="hljs-keyword">if</span>((xhr.<span class="hljs-built_in">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-built_in">status</span> &lt; <span class="hljs-number">300</span>) || xhr.<span class="hljs-built_in">status</span> == <span class="hljs-number">304</span>)&#123;     //<span class="hljs-keyword">do</span> successCallback   &#125; &#125;</code></pre><h3 id="æ¯”è¾ƒå®Œæ•´çš„-http-è¯·æ±‚ï¼Œæ–¹ä¾¿å¤§å®¶ç”¨çš„æ—¶å€™å¤åˆ¶ç²˜è´´ï¼Œå˜¿å˜¿"><a href="#æ¯”è¾ƒå®Œæ•´çš„-http-è¯·æ±‚ï¼Œæ–¹ä¾¿å¤§å®¶ç”¨çš„æ—¶å€™å¤åˆ¶ç²˜è´´ï¼Œå˜¿å˜¿" class="headerlink" title="æ¯”è¾ƒå®Œæ•´çš„ http è¯·æ±‚ï¼Œæ–¹ä¾¿å¤§å®¶ç”¨çš„æ—¶å€™å¤åˆ¶ç²˜è´´ï¼Œå˜¿å˜¿"></a>æ¯”è¾ƒå®Œæ•´çš„ http è¯·æ±‚ï¼Œæ–¹ä¾¿å¤§å®¶ç”¨çš„æ—¶å€™å¤åˆ¶ç²˜è´´ï¼Œå˜¿å˜¿</h3><pre><code class="hljs javascript"> <span class="hljs-keyword">let</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();<span class="hljs-comment">// è¯·æ±‚æˆåŠŸå›è°ƒå‡½æ•°</span>xhr.onload = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request success'</span>);&#125;;<span class="hljs-comment">// è¯·æ±‚ç»“æŸ</span>xhr.onloadend = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request loadend'</span>);&#125;;<span class="hljs-comment">// è¯·æ±‚å‡ºé”™</span>xhr.onerror = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request error'</span>);&#125;;<span class="hljs-comment">// è¯·æ±‚è¶…æ—¶</span>xhr.ontimeout = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request timeout'</span>);&#125;;<span class="hljs-comment">// è¯·æ±‚å›è°ƒå‡½æ•°.XMLHttpRequestæ ‡å‡†åˆåˆ†ä¸ºLevel 1å’ŒLevel 2,è¿™æ˜¯Level 1å’Œçš„å›è°ƒå¤„ç†æ–¹å¼</span><span class="hljs-comment">// xhr.onreadystatechange = () =&gt; &#123;</span><span class="hljs-comment">//  if (xhr.readyState !== 4) &#123;</span><span class="hljs-comment">//  return;</span><span class="hljs-comment">//  &#125;</span><span class="hljs-comment">//  const status = xhr.status;</span><span class="hljs-comment">//  if ((status &gt;= 200 &amp;&amp; status &lt; 300) || status === 304) &#123;</span><span class="hljs-comment">//  console.log('request success');</span><span class="hljs-comment">//  &#125; else &#123;</span><span class="hljs-comment">//  console.log('request error');</span><span class="hljs-comment">//  &#125;</span><span class="hljs-comment">//  &#125;;</span>xhr.timeout = <span class="hljs-number">0</span>; <span class="hljs-comment">// è®¾ç½®è¶…æ—¶æ—¶é—´,0è¡¨ç¤ºæ°¸ä¸è¶…æ—¶</span><span class="hljs-comment">// åˆå§‹åŒ–è¯·æ±‚</span>xhr.open(<span class="hljs-string">'GET/POST/DELETE/...'</span>, <span class="hljs-string">'/url'</span>, <span class="hljs-literal">true</span> || <span class="hljs-literal">false</span>);<span class="hljs-comment">// è®¾ç½®æœŸæœ›çš„è¿”å›æ•°æ®ç±»å‹ 'json' 'text' 'document' ...</span>xhr.responseType = <span class="hljs-string">''</span>;<span class="hljs-comment">// è®¾ç½®è¯·æ±‚å¤´</span>xhr.setRequestHeader(<span class="hljs-string">''</span>, <span class="hljs-string">''</span>);<span class="hljs-comment">// å‘é€è¯·æ±‚</span>xhr.send(<span class="hljs-literal">null</span> || <span class="hljs-keyword">new</span> FormData || <span class="hljs-string">'a=1&amp;b=2'</span> || <span class="hljs-string">'jsonå­—ç¬¦ä¸²'</span>);</code></pre><h2 id="å°è£…-XMLHttpRequest"><a href="#å°è£…-XMLHttpRequest" class="headerlink" title="-å°è£… XMLHttpRequest"></a>-å°è£… XMLHttpRequest</h2><h3 id="åˆæ­¥å°è£…"><a href="#åˆæ­¥å°è£…" class="headerlink" title="åˆæ­¥å°è£…"></a>åˆæ­¥å°è£…</h3><p>ä¸‹é¢çš„ä»£ç æœ‰ç‚¹å¤šï¼Œä¸çˆ±çœ‹å¯ä»¥ä¸çœ‹ï¼Œæ²¡ä»€ä¹ˆéš¾ç‚¹ã€‚å¤§ä½“æ€è·¯æˆ‘è¿™é‡Œå‘Šè¯‰ä½ ï¼š<br>å…ˆå†™ä¸€ä¸ªé»˜è®¤çš„è¯·æ±‚éœ€è¦çš„ä¸€äº›å‚æ•°å•¥çš„ï¼Œæ¯”å¦‚é»˜è®¤ get æ–¹æ³•ï¼Œé»˜è®¤å¼‚æ­¥è¯·æ±‚ç­‰ã€‚<br>å¦‚æœæ˜¯ get è¯·æ±‚ï¼ŒæŠŠè¯·æ±‚å‚æ•°æ”¾è¿› url é‡Œé¢æ ¼å¼ä¸º <a href="https://www.wanghaojvlao.com?wanghao=jvlao&amp;wanghao=shadiaoè¿™æ ·" target="_blank" rel="noopener">https://www.wanghaojvlao.com?wanghao=jvlao&amp;wanghao=shadiaoè¿™æ ·</a><br>å¦‚æœæ˜¯ postï¼Œè½¬åŒ–è¯·æ±‚ä½“ä¸­çš„ date ç±»å‹ä¸ºå­—ç¬¦ä¸²ç±»å‹<br>å¤§æ¦‚æ€è·¯å°±æ˜¯è¿™æ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï½</p><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> http = &#123;  <span class="hljs-comment">/**</span><span class="hljs-comment">   * jså°è£…ajaxè¯·æ±‚</span><span class="hljs-comment">   * &gt;&gt;ä½¿ç”¨new XMLHttpRequest åˆ›å»ºè¯·æ±‚å¯¹è±¡,æ‰€ä»¥ä¸è€ƒè™‘ä½ç«¯IEæµè§ˆå™¨(IE6åŠä»¥ä¸‹ä¸æ”¯æŒXMLHttpRequest)</span><span class="hljs-comment">   * &gt;&gt;ä½¿ç”¨es6è¯­æ³•,å¦‚æœéœ€è¦åœ¨æ­£å¼ç¯å¢ƒä½¿ç”¨,åˆ™å¯ä»¥ç”¨babelè½¬æ¢ä¸ºes5è¯­æ³• https://babeljs.cn/docs/setup/#installation</span><span class="hljs-comment">   *  @param settings è¯·æ±‚å‚æ•°æ¨¡ä»¿jQuery ajax</span><span class="hljs-comment">   *  è°ƒç”¨è¯¥æ–¹æ³•,dataå‚æ•°éœ€è¦å’Œè¯·æ±‚å¤´Content-Typeå¯¹åº”</span><span class="hljs-comment">   *  Content-Type                        data                                     æè¿°</span><span class="hljs-comment">   *  application/x-www-form-urlencoded   'name=å“ˆå“ˆ&amp;age=12'æˆ–&#123;name:'å“ˆå“ˆ',age:12&#125;  æŸ¥è¯¢å­—ç¬¦ä¸²,ç”¨&amp;åˆ†å‰²</span><span class="hljs-comment">   *  application/json                     name=å“ˆå“ˆ&amp;age=12'                        jsonå­—ç¬¦ä¸²</span><span class="hljs-comment">   *  multipart/form-data                  new FormData()                           FormDataå¯¹è±¡,å½“ä¸ºFormDataç±»å‹,ä¸è¦æ‰‹åŠ¨è®¾ç½®Content-Type</span><span class="hljs-comment">   *  æ³¨æ„:è¯·æ±‚å‚æ•°å¦‚æœåŒ…å«æ—¥æœŸç±»å‹.æ˜¯å¦èƒ½è¯·æ±‚æˆåŠŸéœ€è¦åå°æ¥å£é…åˆ</span><span class="hljs-comment">   */</span>  ajax: <span class="hljs-function">(<span class="hljs-params">settings = &#123;&#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// åˆå§‹åŒ–è¯·æ±‚å‚æ•°</span>    <span class="hljs-keyword">let</span> _s = <span class="hljs-built_in">Object</span>.assign(&#123;      url: <span class="hljs-string">''</span>, <span class="hljs-comment">// string</span>      <span class="hljs-keyword">type</span>: <span class="hljs-string">'GET'</span>, <span class="hljs-comment">// string 'GET' 'POST' 'DELETE'</span>      dataType: <span class="hljs-string">'json'</span>, <span class="hljs-comment">// string æœŸæœ›çš„è¿”å›æ•°æ®ç±»å‹:'json' 'text' 'document' ...</span>      <span class="hljs-keyword">async</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//  boolean true:å¼‚æ­¥è¯·æ±‚ false:åŒæ­¥è¯·æ±‚ required</span>      data: <span class="hljs-literal">null</span>, <span class="hljs-comment">// any è¯·æ±‚å‚æ•°,dataéœ€è¦å’Œè¯·æ±‚å¤´Content-Typeå¯¹åº”</span>      headers: &#123;&#125;, <span class="hljs-comment">// object è¯·æ±‚å¤´</span>      timeout: <span class="hljs-number">1000</span>, <span class="hljs-comment">// string è¶…æ—¶æ—¶é—´:0è¡¨ç¤ºä¸è®¾ç½®è¶…æ—¶</span>      beforeSend: <span class="hljs-function">(<span class="hljs-params">xhr</span>) =&gt;</span> &#123;      &#125;,      success: <span class="hljs-function">(<span class="hljs-params">result, status, xhr</span>) =&gt;</span> &#123;      &#125;,      error: <span class="hljs-function">(<span class="hljs-params">xhr, status, error</span>) =&gt;</span> &#123;      &#125;,      complete: <span class="hljs-function">(<span class="hljs-params">xhr, status</span>) =&gt;</span> &#123;      &#125;    &#125;, settings);    <span class="hljs-comment">// å‚æ•°éªŒè¯</span>    <span class="hljs-keyword">if</span> (!_s.url || !_s.type || !_s.dataType || !_s.async) &#123;      alert(<span class="hljs-string">'å‚æ•°æœ‰è¯¯'</span>);      <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// åˆ›å»ºXMLHttpRequestè¯·æ±‚å¯¹è±¡</span>    <span class="hljs-keyword">let</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();    <span class="hljs-comment">// è¯·æ±‚å¼€å§‹å›è°ƒå‡½æ•°</span>    xhr.addEventListener(<span class="hljs-string">'loadstart'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;      _s.beforeSend(xhr);    &#125;);    <span class="hljs-comment">// è¯·æ±‚æˆåŠŸå›è°ƒå‡½æ•°</span>    xhr.addEventListener(<span class="hljs-string">'load'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;      <span class="hljs-keyword">const</span> status = xhr.status;      <span class="hljs-keyword">if</span> ((status &gt;= <span class="hljs-number">200</span> &amp;&amp; status &lt; <span class="hljs-number">300</span>) || status === <span class="hljs-number">304</span>) &#123;        <span class="hljs-keyword">let</span> result;        <span class="hljs-keyword">if</span> (xhr.responseType === <span class="hljs-string">'text'</span>) &#123;          result = xhr.responseText;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (xhr.responseType === <span class="hljs-string">'document'</span>) &#123;          result = xhr.responseXML;        &#125; <span class="hljs-keyword">else</span> &#123;          result = xhr.response;        &#125;        <span class="hljs-comment">// æ³¨æ„:çŠ¶æ€ç 200è¡¨ç¤ºè¯·æ±‚å‘é€/æ¥å—æˆåŠŸ,ä¸è¡¨ç¤ºä¸šåŠ¡å¤„ç†æˆåŠŸ</span>        _s.success(result, status, xhr);      &#125; <span class="hljs-keyword">else</span> &#123;        _s.error(xhr, status, e);      &#125;    &#125;);    <span class="hljs-comment">// è¯·æ±‚ç»“æŸ</span>    xhr.addEventListener(<span class="hljs-string">'loadend'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;      _s.complete(xhr, xhr.status);    &#125;);    <span class="hljs-comment">// è¯·æ±‚å‡ºé”™</span>    xhr.addEventListener(<span class="hljs-string">'error'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;      _s.error(xhr, xhr.status, e);    &#125;);    <span class="hljs-comment">// è¯·æ±‚è¶…æ—¶</span>    xhr.addEventListener(<span class="hljs-string">'timeout'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;      _s.error(xhr, <span class="hljs-number">408</span>, e);    &#125;);    <span class="hljs-keyword">let</span> useUrlParam = <span class="hljs-literal">false</span>;    <span class="hljs-keyword">let</span> sType = _s.type.toUpperCase();    <span class="hljs-comment">// å¦‚æœæ˜¯"ç®€å•"è¯·æ±‚,åˆ™æŠŠdataå‚æ•°ç»„è£…åœ¨urlä¸Š</span>    <span class="hljs-keyword">if</span> (sType === <span class="hljs-string">'GET'</span> || sType === <span class="hljs-string">'DELETE'</span>) &#123;      useUrlParam = <span class="hljs-literal">true</span>;      _s.url += http.getUrlParam(_s.url, _s.data);    &#125;    <span class="hljs-comment">// åˆå§‹åŒ–è¯·æ±‚</span>    xhr.open(_s.type, _s.url, _s.async);    <span class="hljs-comment">// è®¾ç½®æœŸæœ›çš„è¿”å›æ•°æ®ç±»å‹</span>    xhr.responseType = _s.dataType;    <span class="hljs-comment">// è®¾ç½®è¯·æ±‚å¤´</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key of <span class="hljs-built_in">Object</span>.keys(_s.headers)) &#123;      xhr.setRequestHeader(key, _s.headers[key]);    &#125;    <span class="hljs-comment">// è®¾ç½®è¶…æ—¶æ—¶é—´</span>    <span class="hljs-keyword">if</span> (_s.async &amp;&amp; _s.timeout) &#123;      xhr.timeout = _s.timeout;    &#125;    <span class="hljs-comment">// å‘é€è¯·æ±‚.å¦‚æœæ˜¯ç®€å•è¯·æ±‚,è¯·æ±‚å‚æ•°åº”ä¸ºnull.å¦åˆ™,è¯·æ±‚å‚æ•°ç±»å‹éœ€è¦å’Œè¯·æ±‚å¤´Content-Typeå¯¹åº”</span>    xhr.send(useUrlParam ? <span class="hljs-literal">null</span> : http.getQueryData(_s.data));  &#125;,  <span class="hljs-comment">// æŠŠå‚æ•°dataè½¬ä¸ºurlæŸ¥è¯¢å‚æ•°</span>  getUrlParam: <span class="hljs-function">(<span class="hljs-params">url, data</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (!data) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;    &#125;    <span class="hljs-keyword">let</span> paramsStr = data <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span> ? http.getQueryString(data) : data;    <span class="hljs-keyword">return</span> (url.indexOf(<span class="hljs-string">'?'</span>) !== <span class="hljs-number">-1</span>) ? paramsStr : <span class="hljs-string">'?'</span> + paramsStr;  &#125;,  <span class="hljs-comment">// è·å–ajaxè¯·æ±‚å‚æ•°</span>  getQueryData: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (!data) &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;    &#125;    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data === <span class="hljs-string">'string'</span>) &#123;      <span class="hljs-keyword">return</span> data;    &#125;    <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> FormData) &#123;      <span class="hljs-keyword">return</span> data;    &#125;    <span class="hljs-keyword">return</span> http.getQueryString(data);  &#125;,  <span class="hljs-comment">// æŠŠå¯¹è±¡è½¬ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²</span>  getQueryString: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;    <span class="hljs-keyword">let</span> paramsArr = [];    <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span>) &#123;      <span class="hljs-built_in">Object</span>.keys(data).forEach(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;        <span class="hljs-keyword">let</span> val = data[key];        <span class="hljs-comment">// todo å‚æ•°Dateç±»å‹éœ€è¦æ ¹æ®åå°apié…Œæƒ…å¤„ç†</span>        <span class="hljs-keyword">if</span> (val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>) &#123;          <span class="hljs-comment">// val = dateFormat(val, 'yyyy-MM-dd hh:mm:ss');</span>        &#125;        paramsArr.push(<span class="hljs-built_in">encodeURIComponent</span>(key) + <span class="hljs-string">'='</span> + <span class="hljs-built_in">encodeURIComponent</span>(val));      &#125;);    &#125;    <span class="hljs-keyword">return</span> paramsArr.join(<span class="hljs-string">'&amp;'</span>);  &#125;&#125;</code></pre><p>è¿™æ—¶å€™è°ƒç”¨çš„ä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="hljs coffeescript">http.ajax(&#123;  url: url,  type: <span class="hljs-string">'POST'</span>,  data: &#123;name: <span class="hljs-string">'å“ˆå“ˆ'</span>, age: <span class="hljs-number">12</span>&#125;, <span class="hljs-regexp">//</span>æˆ– data: <span class="hljs-string">'name=å“ˆå“ˆ&amp;age=12'</span>,  headers: &#123;    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded; charset=UTF-8'</span>  &#125;,  beforeSend: <span class="hljs-function"><span class="hljs-params">(xhr)</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request show loading...'</span>);  &#125;,  success: function (result, status, xhr) &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request success...'</span>);  &#125;,  error: <span class="hljs-function"><span class="hljs-params">(xhr, status, error)</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request error...'</span>);  &#125;,  complete: <span class="hljs-function"><span class="hljs-params">(xhr, status)</span> =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request hide loading...'</span>);  &#125;&#125;);</code></pre><p>å¯ä»¥çœ‹å‡ºæ¥å“ˆï¼Œè¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œä½ æ€»ä¸èƒ½æ¯æ¬¡è¯·æ±‚éƒ½æ•´çœŸä¹ˆä¸€å¤§å †ä»£ç å§ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­å°è£…ï¼</p><h3 id="è¿›ä¸€æ­¥å°è£…"><a href="#è¿›ä¸€æ­¥å°è£…" class="headerlink" title="è¿›ä¸€æ­¥å°è£…"></a>è¿›ä¸€æ­¥å°è£…</h3><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> http = &#123;  <span class="hljs-comment">/**</span><span class="hljs-comment">   * æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè£…é¥° ajax æ–¹æ³•</span><span class="hljs-comment">   * å¦‚:ç»Ÿä¸€å¼‚å¸¸å¤„ç†,æ·»åŠ httpè¯·æ±‚å¤´,è¯·æ±‚å±•ç¤ºloadingç­‰</span><span class="hljs-comment">   * <span class="hljs-doctag">@param <span class="hljs-variable">settings</span></span></span><span class="hljs-comment">   */</span>  request: <span class="hljs-function">(<span class="hljs-params">settings = &#123;&#125;</span>) =&gt;</span> &#123;    <span class="hljs-comment">// ç»Ÿä¸€å¼‚å¸¸å¤„ç†å‡½æ•°</span>    <span class="hljs-keyword">let</span> errorHandle = <span class="hljs-function">(<span class="hljs-params">xhr, status</span>) =&gt;</span> &#123;      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request error...'</span>);      <span class="hljs-keyword">if</span> (status === <span class="hljs-number">401</span>) &#123;        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request æ²¡æœ‰æƒé™...'</span>);      &#125;      <span class="hljs-keyword">if</span> (status === <span class="hljs-number">408</span>) &#123;        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request timeout'</span>);      &#125;    &#125;;    <span class="hljs-comment">// ä½¿ç”¨beforeæ‹¦æˆªå‚æ•°çš„ beforeSend å›è°ƒå‡½æ•°</span>    settings.beforeSend = (settings.beforeSend || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    &#125;).before(<span class="hljs-function"><span class="hljs-params">xhr</span> =&gt;</span> &#123;      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request show loading...'</span>);    &#125;);    <span class="hljs-comment">// ä¿å­˜å‚æ•°successå›è°ƒå‡½æ•°</span>    <span class="hljs-keyword">let</span> successFn = settings.success;    <span class="hljs-comment">// è¦†ç›–å‚æ•°successå›è°ƒå‡½æ•°</span>    settings.success = <span class="hljs-function">(<span class="hljs-params">result, status, xhr</span>) =&gt;</span> &#123;      <span class="hljs-comment">// todo æ ¹æ®åå°apiåˆ¤æ–­æ˜¯å¦è¯·æ±‚æˆåŠŸ</span>      <span class="hljs-keyword">if</span> (result &amp;&amp; result <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span> &amp;&amp; result.code !== <span class="hljs-number">1</span>) &#123;        errorHandle(xhr, status);      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request success'</span>);        successFn &amp;&amp; successFn(result, status, xhr);      &#125;    &#125;;    <span class="hljs-comment">// æ‹¦æˆªå‚æ•°çš„ error</span>    settings.error = (settings.error || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    &#125;).before(<span class="hljs-function">(<span class="hljs-params">result, status, xhr</span>) =&gt;</span> &#123;      errorHandle(xhr, status);    &#125;);    <span class="hljs-comment">// æ‹¦æˆªå‚æ•°çš„ complete</span>    settings.complete = (settings.complete || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    &#125;).after(<span class="hljs-function">(<span class="hljs-params">xhr, status</span>) =&gt;</span> &#123;      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request hide loading...'</span>);    &#125;);    <span class="hljs-comment">// è¯·æ±‚æ·»åŠ æƒé™å¤´,ç„¶åè°ƒç”¨http.ajaxæ–¹æ³•</span>    (http.ajax.before(http.addAuthorizationHeader))(settings);  &#125;,  <span class="hljs-comment">// æ·»åŠ æƒé™è¯·æ±‚å¤´</span>  addAuthorizationHeader: <span class="hljs-function">(<span class="hljs-params">settings</span>) =&gt;</span> &#123;    settings.headers = settings.headers || &#123;&#125;;    <span class="hljs-keyword">const</span> headerKey = <span class="hljs-string">'Authorization'</span>; <span class="hljs-comment">// todo æƒé™å¤´åç§°</span>    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨æƒé™header</span>    <span class="hljs-keyword">let</span> hasAuthorization = <span class="hljs-built_in">Object</span>.keys(settings.headers).some(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;      <span class="hljs-keyword">return</span> key === headerKey;    &#125;);    <span class="hljs-keyword">if</span> (!hasAuthorization) &#123;      settings.headers[headerKey] = <span class="hljs-string">'test'</span>; <span class="hljs-comment">// todo ä»ç¼“å­˜ä¸­è·å–headerKeyçš„å€¼</span>    &#125;  &#125;&#125;;<span class="hljs-built_in">Function</span>.prototype.before = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">beforeFn</span>) </span>&#123; <span class="hljs-comment">// eslint-disable-line</span>  <span class="hljs-keyword">let</span> _self = <span class="hljs-keyword">this</span>;  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    beforeFn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);    _self.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);  &#125;;&#125;;<span class="hljs-built_in">Function</span>.prototype.after = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">afterFn</span>) </span>&#123; <span class="hljs-comment">// eslint-disable-line</span>  <span class="hljs-keyword">let</span> _self = <span class="hljs-keyword">this</span>;  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    _self.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);    afterFn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);  &#125;;&#125;;</code></pre><p>å¥½æäº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è°ƒç”¨çš„ä»£ç æ›´ç®€æ´äº›äº†ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="hljs javascript">http.request(&#123;  url: url,  type: <span class="hljs-string">'POST'</span>,  data: &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">'å“ˆå“ˆ'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">12</span>&#125;, <span class="hljs-comment">// data: 'name=å“ˆå“ˆ&amp;age=12',</span>  headers: &#123;    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded; charset=UTF-8'</span>  &#125;,  success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">result, status, xhr</span>) </span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'å°±å¯ä»¥æ“ä½œä¸€æ³¢å•¦'</span>);  &#125;&#125;);<span class="hljs-comment">//å¯¹æ¯”ä¸‹åˆšåˆšçš„</span>http.ajax(&#123;  url: url,  type: <span class="hljs-string">'POST'</span>,  data: &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">'å“ˆå“ˆ'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">12</span>&#125;, <span class="hljs-comment">//æˆ– data: 'name=å“ˆå“ˆ&amp;age=12',</span>  headers: &#123;    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded; charset=UTF-8'</span>  &#125;,  beforeSend: <span class="hljs-function">(<span class="hljs-params">xhr</span>) =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request show loading...'</span>);  &#125;,  success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">result, status, xhr</span>) </span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request success...'</span>);  &#125;,  error: <span class="hljs-function">(<span class="hljs-params">xhr, status, error</span>) =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request error...'</span>);  &#125;,  complete: <span class="hljs-function">(<span class="hljs-params">xhr, status</span>) =&gt;</span> &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'request hide loading...'</span>);  &#125;&#125;);</code></pre><p>å˜¿å˜¿ï¼Œä¸è¦åœï¼Œè®©æˆ‘ä»¬ç»§ç»­å°è£…ä¸€ä¸‹ï½ ğŸ˜</p><h3 id="ç»ˆæå°è£…"><a href="#ç»ˆæå°è£…" class="headerlink" title="ç»ˆæå°è£…"></a>ç»ˆæå°è£…</h3><pre><code class="hljs lasso">const http = &#123;  get: (url, <span class="hljs-built_in">data</span>, successCallback, dataType = <span class="hljs-string">'json'</span>) =&gt; &#123;    http.request(&#123;      url: url,      <span class="hljs-keyword">type</span>: <span class="hljs-string">'GET'</span>,      dataType: dataType,      <span class="hljs-built_in">data</span>: <span class="hljs-built_in">data</span>,      success: successCallback    &#125;);  &#125;,  delete: (url, <span class="hljs-built_in">data</span>, successCallback, dataType = <span class="hljs-string">'json'</span>) =&gt; &#123;    http.request(&#123;      url: url,      <span class="hljs-keyword">type</span>: <span class="hljs-string">'DELETE'</span>,      dataType: dataType,      <span class="hljs-built_in">data</span>: <span class="hljs-built_in">data</span>,      success: successCallback    &#125;);  &#125;,  <span class="hljs-comment">// è°ƒç”¨æ­¤æ–¹æ³•,å‚æ•°dataåº”ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–æ™®é€šå¯¹è±¡</span>  post: (url, <span class="hljs-built_in">data</span>, successCallback, dataType = <span class="hljs-string">'json'</span>) =&gt; &#123;    http.request(&#123;      url: url,      <span class="hljs-keyword">type</span>: <span class="hljs-string">'POST'</span>,      dataType: dataType,      <span class="hljs-built_in">data</span>: <span class="hljs-built_in">data</span>,      headers: &#123;        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded; charset=UTF-8'</span>      &#125;,      success: successCallback    &#125;);  &#125;,  <span class="hljs-comment">// è°ƒç”¨æ­¤æ–¹æ³•,å‚æ•°dataåº”ä¸ºjsonå­—ç¬¦ä¸²</span>  postBody: (url, <span class="hljs-built_in">data</span>, successCallback, dataType = <span class="hljs-string">'json'</span>) =&gt; &#123;    http.request(&#123;      url: url,      <span class="hljs-keyword">type</span>: <span class="hljs-string">'POST'</span>,      dataType: dataType,      <span class="hljs-built_in">data</span>: <span class="hljs-built_in">data</span>,      headers: &#123;        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json; charset=UTF-8'</span>      &#125;,      success: successCallback    &#125;);  &#125;&#125;;</code></pre><p>æ­¤æ—¶ï¼Œæ­¤æ—¶æ­¤åˆ»ï¼Œright now ï¼ let us see see ğŸ˜‚</p><pre><code class="hljs coffeescript">http.get(url + <span class="hljs-string">'?name=å“ˆå“ˆ&amp;age=12'</span>, <span class="hljs-literal">null</span>, <span class="hljs-function"><span class="hljs-params">(result, status, xhr)</span> =&gt;</span> &#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ä½ éšä¾¿å¹²å•¥éƒ½è¡Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ'</span>);&#125;);</code></pre><p>ç¥ä¼¼ jquery çš„ $.ajax() å¯¹ä¸å¯¹ï¼Ÿå¾ˆå¼€å¿ƒäº†è§£äº†è¿™ä¹ˆå¤šä¸œè¥¿å§ï½ï¼Œok é‚£ä¹ˆæˆ‘ä»¬æ¥ç€çœ‹ä¸‹ä¸€ä¸ªç©æ„å„¿ï½</p><h2 id="axios"><a href="#axios" class="headerlink" title="-axios"></a>-axios</h2><h3 id="axios-ç®€ä»‹"><a href="#axios-ç®€ä»‹" class="headerlink" title="axios ç®€ä»‹"></a>axios ç®€ä»‹</h3><p>Axios æ˜¯ä¸€ä¸ªåŸºäº promise çš„ HTTP åº“ï¼Œå¯ä»¥ç”¨åœ¨æµè§ˆå™¨å’Œ node.js ä¸­ã€‚</p><p><strong>ç‰¹æ€§ï¼š</strong></p><ul><li>ä»æµè§ˆå™¨ä¸­åˆ›å»º XMLHttpRequests</li><li>ä» node.js åˆ›å»º http è¯·æ±‚</li><li>æ”¯æŒ Promise API</li><li>æ‹¦æˆªè¯·æ±‚å’Œå“åº”</li><li>è½¬æ¢è¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ®</li><li>å–æ¶ˆè¯·æ±‚</li><li>è‡ªåŠ¨è½¬æ¢ JSON æ•°æ®</li><li>å®¢æˆ·ç«¯æ”¯æŒé˜²å¾¡ XSRF</li></ul><p>é‚£ä¹ˆ axios å’Œ ajax çš„åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿaxios å’Œ XMLHttpRequest å…³è”åˆåœ¨å“ªé‡Œå‘¢ï¼Ÿ<br>Axios åœ¨ NPM ä¸Šçš„æè¿°æ˜¯ï¼šPromise based HTTP client for the browser and node.jsï¼Œæ˜¯ä¸€ç§åŸºäº Promise å°è£…çš„ HTTP å®¢æˆ·ç«¯ã€‚<br>AJAX å®Œæ•´æ˜¯ Asynchronous Javascript And XML . å¼‚æ­¥ js å’Œ xmlï¼Œæ˜¯ä¸€ç§å¼‚æ­¥è¯·æ±‚çš„æŠ€æœ¯ã€‚</p><p>å•¥æ„æ€ï¼ŸAxios æ˜¯é€šè¿‡ Promise å®ç° XHR å°è£…ï¼Œå…¶ä¸­ Promise æ˜¯æ§åˆ¶æ‰‹æ®µï¼ŒXHR æ˜¯å®é™…å‘é€ Http è¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚å°±åƒ$.ajax æ˜¯é€šè¿‡ callback+XHR å®ç°ä¸€æ ·å°±åƒæˆ‘ä»¬åˆšåˆšåœ¨ä¸Šé¢å°è£…çš„é‚£ä¸ªä¸€ä¸ªæ„æ€çš„ï¼Œéƒ½æ˜¯ AJAX æŠ€æœ¯çš„ä¸€ç§è¿ç”¨ã€‚ AJAX æŠ€æœ¯æ˜¯å®ç°ç½‘é¡µçš„å±€éƒ¨æ•°æ®åˆ·æ–°ï¼Œä½ å¯ä»¥é€šè¿‡ XHRã€Fetchã€WebSocket ç­‰ API å®ç°ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><p>ç¡¬æ ¸ä¸€ç‚¹ï¼Œç›´æ¥ä¸Šå®˜ç½‘ä»£ç ï¼Œä¸€ç›®äº†ç„¶ï½</p><pre><code class="hljs scilab"><span class="hljs-comment">// get</span>axios.get(<span class="hljs-string">'/user'</span>, &#123;    params: &#123;      ID: <span class="hljs-number">12345</span>    &#125;  &#125;)  .<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(response)</span> &#123;</span>    console.<span class="hljs-built_in">log</span>(response);  &#125;)  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(error)</span> &#123;</span>    console.<span class="hljs-built_in">log</span>(<span class="hljs-built_in">error</span>);  &#125;);<span class="hljs-comment">// post</span>axios.post(<span class="hljs-string">'/user'</span>, &#123;    firstName: <span class="hljs-string">'Fred'</span>,    lastName: <span class="hljs-string">'Flintstone'</span>  &#125;)  .<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(response)</span> &#123;</span>    console.<span class="hljs-built_in">log</span>(response);  &#125;)  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(error)</span> &#123;</span>    console.<span class="hljs-built_in">log</span>(<span class="hljs-built_in">error</span>);  &#125;);<span class="hljs-comment">// å¹¶å‘</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserAccount</span><span class="hljs-params">()</span> &#123;</span>  <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">'/user/12345'</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserPermissions</span><span class="hljs-params">()</span> &#123;</span>  <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">'/user/12345/permissions'</span>);&#125;axios.all([getUserAccount(), getUserPermissions()])  .<span class="hljs-keyword">then</span>(axios.spread(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(acct, perms)</span> &#123;</span>    <span class="hljs-comment">// ä¸¤ä¸ªè¯·æ±‚ç°åœ¨éƒ½æ‰§è¡Œå®Œæˆ</span>  &#125;));</code></pre><h3 id="axios-çš„è¯·æ±‚é…ç½®"><a href="#axios-çš„è¯·æ±‚é…ç½®" class="headerlink" title="axios çš„è¯·æ±‚é…ç½®"></a>axios çš„è¯·æ±‚é…ç½®</h3><p>1ã€å¯ä»¥é€šè¿‡ axios.defaults è®¾ç½®å…¨å±€é»˜è®¤å€¼ï¼Œåœ¨æ‰€æœ‰è¯·æ±‚ä¸­éƒ½ç”Ÿæ•ˆã€‚</p><pre><code class="hljs stylus">axios<span class="hljs-selector-class">.defaults</span><span class="hljs-selector-class">.headers</span><span class="hljs-selector-class">.common</span>[<span class="hljs-string">"token"</span>] = <span class="hljs-string">""</span>axios<span class="hljs-selector-class">.defaults</span><span class="hljs-selector-class">.headers</span><span class="hljs-selector-class">.post</span>[<span class="hljs-string">"Content-type"</span>] = <span class="hljs-string">"application/json"</span>axios<span class="hljs-selector-class">.defaults</span><span class="hljs-selector-class">.baseURL</span> = <span class="hljs-string">'https://zhujun.zhenhao.com; //è®¾ç½®ç»Ÿä¸€è·¯å¾„å‰ç¼€</span></code></pre><p>2ã€ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å®ä¾‹çš„é»˜è®¤å€¼ï¼Œä»¥åŠä¿®æ”¹å®ä¾‹çš„é…ç½®</p><pre><code class="hljs cs"><span class="hljs-keyword">let</span> zhujun = axios.create(&#123;  baseURL: <span class="hljs-string">'http://zhujun.zhenbang.com'</span>,  <span class="hljs-keyword">params</span>: &#123; name: <span class="hljs-string">'æœ±å†›'</span> &#125;&#125;);<span class="hljs-comment">// ä¿®æ”¹é…ç½®åï¼Œè¶…æ—¶è®¾ç½®ä¸º4ç§’</span>zhujun.defaults.timeout = <span class="hljs-number">4000</span>;</code></pre><p>3ã€ä¹Ÿå¯ä»¥åœ¨æ¯ä¸ªè¯·æ±‚ä¸­è®¾ç½®ç›¸å…³çš„é…ç½®ã€‚</p><pre><code class="hljs less"><span class="hljs-selector-tag">axios</span>(<span class="hljs-string">'/app/mock/zhujun'</span>, &#123;  <span class="hljs-attribute">params</span>: &#123;    <span class="hljs-attribute">name</span>: <span class="hljs-string">'æœ±å†›'</span>  &#125;,  <span class="hljs-attribute">baseURL</span>: <span class="hljs-string">'http://zhujun.zhenshuai.com'</span>&#125;)</code></pre><pre><code class="hljs actionscript">&#123;   <span class="hljs-comment">// `url` æ˜¯ç”¨äºè¯·æ±‚çš„æœåŠ¡å™¨ URL</span>  url: <span class="hljs-string">'/user'</span>,  <span class="hljs-comment">// `method` æ˜¯åˆ›å»ºè¯·æ±‚æ—¶ä½¿ç”¨çš„æ–¹æ³•</span>  method: <span class="hljs-string">'get'</span>, <span class="hljs-comment">// default</span>  <span class="hljs-comment">// `baseURL` å°†è‡ªåŠ¨åŠ åœ¨ `url` å‰é¢ï¼Œé™¤é `url` æ˜¯ä¸€ä¸ªç»å¯¹ URLã€‚</span>  <span class="hljs-comment">// å®ƒå¯ä»¥é€šè¿‡è®¾ç½®ä¸€ä¸ª `baseURL` ä¾¿äºä¸º axios å®ä¾‹çš„æ–¹æ³•ä¼ é€’ç›¸å¯¹ URL</span>  baseURL: <span class="hljs-string">'https://some-domain.com/api/'</span>,  <span class="hljs-comment">// `transformRequest` å…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®</span>  <span class="hljs-comment">// åªèƒ½ç”¨åœ¨ 'PUT', 'POST' å’Œ 'PATCH' è¿™å‡ ä¸ªè¯·æ±‚æ–¹æ³•</span>  <span class="hljs-comment">// åé¢æ•°ç»„ä¸­çš„å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ– ArrayBufferï¼Œæˆ– Stream</span>  transformRequest: [<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data, headers)</span> </span>&#123;    <span class="hljs-comment">// å¯¹ data è¿›è¡Œä»»æ„è½¬æ¢å¤„ç†</span>    <span class="hljs-keyword">return</span> data;  &#125;],  <span class="hljs-comment">// `transformResponse` åœ¨ä¼ é€’ç»™ then/catch å‰ï¼Œå…è®¸ä¿®æ”¹å“åº”æ•°æ®</span>  transformResponse: [<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> </span>&#123;    <span class="hljs-comment">// å¯¹ data è¿›è¡Œä»»æ„è½¬æ¢å¤„ç†</span>    <span class="hljs-keyword">return</span> data;  &#125;],  <span class="hljs-comment">// `headers` æ˜¯å³å°†è¢«å‘é€çš„è‡ªå®šä¹‰è¯·æ±‚å¤´</span>  headers: &#123;<span class="hljs-string">'X-Requested-With'</span>: <span class="hljs-string">'XMLHttpRequest'</span>&#125;,  <span class="hljs-comment">// `params` æ˜¯å³å°†ä¸è¯·æ±‚ä¸€èµ·å‘é€çš„ URL å‚æ•°</span>  <span class="hljs-comment">// å¿…é¡»æ˜¯ä¸€ä¸ªæ— æ ¼å¼å¯¹è±¡(plain object)æˆ– URLSearchParams å¯¹è±¡</span>  params: &#123;    ID: <span class="hljs-number">12345</span>  &#125;,   <span class="hljs-comment">// `paramsSerializer` æ˜¯ä¸€ä¸ªè´Ÿè´£ `params` åºåˆ—åŒ–çš„å‡½æ•°</span>  <span class="hljs-comment">// (e.g. https://www.npmjs.com/package/qs, http://api.jquery.com/jquery.param/)</span>  paramsSerializer: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>&#123;    <span class="hljs-keyword">return</span> Qs.stringify(params, &#123;arrayFormat: <span class="hljs-string">'brackets'</span>&#125;)  &#125;,  <span class="hljs-comment">// `data` æ˜¯ä½œä¸ºè¯·æ±‚ä¸»ä½“è¢«å‘é€çš„æ•°æ®</span>  <span class="hljs-comment">// åªé€‚ç”¨äºè¿™äº›è¯·æ±‚æ–¹æ³• 'PUT', 'POST', å’Œ 'PATCH'</span>  <span class="hljs-comment">// åœ¨æ²¡æœ‰è®¾ç½® `transformRequest` æ—¶ï¼Œå¿…é¡»æ˜¯ä»¥ä¸‹ç±»å‹ä¹‹ä¸€ï¼š</span>  <span class="hljs-comment">// - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams</span>  <span class="hljs-comment">// - æµè§ˆå™¨ä¸“å±ï¼šFormData, File, Blob</span>  <span class="hljs-comment">// - Node ä¸“å±ï¼š Stream</span>  data: &#123;    firstName: <span class="hljs-string">'Fred'</span>  &#125;,  <span class="hljs-comment">// `timeout` æŒ‡å®šè¯·æ±‚è¶…æ—¶çš„æ¯«ç§’æ•°(0 è¡¨ç¤ºæ— è¶…æ—¶æ—¶é—´)</span>  <span class="hljs-comment">// å¦‚æœè¯·æ±‚è¯è´¹äº†è¶…è¿‡ `timeout` çš„æ—¶é—´ï¼Œè¯·æ±‚å°†è¢«ä¸­æ–­</span>  timeout: <span class="hljs-number">1000</span>,   <span class="hljs-comment">// `withCredentials` è¡¨ç¤ºè·¨åŸŸè¯·æ±‚æ—¶æ˜¯å¦éœ€è¦ä½¿ç”¨å‡­è¯</span>  withCredentials: <span class="hljs-literal">false</span>, <span class="hljs-comment">// default</span>  <span class="hljs-comment">// `adapter` å…è®¸è‡ªå®šä¹‰å¤„ç†è¯·æ±‚ï¼Œä»¥ä½¿æµ‹è¯•æ›´è½»æ¾</span>  <span class="hljs-comment">// è¿”å›ä¸€ä¸ª promise å¹¶åº”ç”¨ä¸€ä¸ªæœ‰æ•ˆçš„å“åº” (æŸ¥é˜… [response docs](#response-api)).</span>  adapter: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(config)</span> </span>&#123;    <span class="hljs-comment">/* ... */</span>  &#125;, <span class="hljs-comment">// `auth` è¡¨ç¤ºåº”è¯¥ä½¿ç”¨ HTTP åŸºç¡€éªŒè¯ï¼Œå¹¶æä¾›å‡­æ®</span>  <span class="hljs-comment">// è¿™å°†è®¾ç½®ä¸€ä¸ª `Authorization` å¤´ï¼Œè¦†å†™æ‰ç°æœ‰çš„ä»»æ„ä½¿ç”¨ `headers` è®¾ç½®çš„è‡ªå®šä¹‰ `Authorization`å¤´</span>  auth: &#123;    username: <span class="hljs-string">'janedoe'</span>,    password: <span class="hljs-string">'s00pers3cret'</span>  &#125;,   <span class="hljs-comment">// `responseType` è¡¨ç¤ºæœåŠ¡å™¨å“åº”çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥æ˜¯ 'arraybuffer', 'blob', 'document', 'json', 'text', 'stream'</span>  responseType: <span class="hljs-string">'json'</span>, <span class="hljs-comment">// default</span>  <span class="hljs-comment">// `responseEncoding` indicates encoding to use for decoding responses</span>  <span class="hljs-comment">// Note: Ignored for `responseType` of 'stream' or client-side requests</span>  responseEncoding: <span class="hljs-string">'utf8'</span>, <span class="hljs-comment">// default</span>   <span class="hljs-comment">// `xsrfCookieName` æ˜¯ç”¨ä½œ xsrf token çš„å€¼çš„cookieçš„åç§°</span>  xsrfCookieName: <span class="hljs-string">'XSRF-TOKEN'</span>, <span class="hljs-comment">// default</span>  <span class="hljs-comment">// `xsrfHeaderName` is the name of the http header that carries the xsrf token value</span>  xsrfHeaderName: <span class="hljs-string">'X-XSRF-TOKEN'</span>, <span class="hljs-comment">// default</span>   <span class="hljs-comment">// `onUploadProgress` å…è®¸ä¸ºä¸Šä¼ å¤„ç†è¿›åº¦äº‹ä»¶</span>  onUploadProgress: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(progressEvent)</span> </span>&#123;    <span class="hljs-comment">// Do whatever you want with the native progress event</span>  &#125;,  <span class="hljs-comment">// `onDownloadProgress` å…è®¸ä¸ºä¸‹è½½å¤„ç†è¿›åº¦äº‹ä»¶</span>  onDownloadProgress: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(progressEvent)</span> </span>&#123;    <span class="hljs-comment">// å¯¹åŸç”Ÿè¿›åº¦äº‹ä»¶çš„å¤„ç†</span>  &#125;,   <span class="hljs-comment">// `maxContentLength` å®šä¹‰å…è®¸çš„å“åº”å†…å®¹çš„æœ€å¤§å°ºå¯¸</span>  maxContentLength: <span class="hljs-number">2000</span>,  <span class="hljs-comment">// `validateStatus` å®šä¹‰å¯¹äºç»™å®šçš„HTTP å“åº”çŠ¶æ€ç æ˜¯ resolve æˆ– reject  promise ã€‚å¦‚æœ `validateStatus` è¿”å› `true` (æˆ–è€…è®¾ç½®ä¸º `null` æˆ– `undefined`)ï¼Œpromise å°†è¢« resolve; å¦åˆ™ï¼Œpromise å°†è¢« rejecte</span>  validateStatus: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> </span>&#123;    <span class="hljs-keyword">return</span> status &gt;= <span class="hljs-number">200</span> &amp;&amp; status &lt; <span class="hljs-number">300</span>; <span class="hljs-comment">// default</span>  &#125;,  <span class="hljs-comment">// `maxRedirects` å®šä¹‰åœ¨ node.js ä¸­ follow çš„æœ€å¤§é‡å®šå‘æ•°ç›®</span>  <span class="hljs-comment">// å¦‚æœè®¾ç½®ä¸º0ï¼Œå°†ä¸ä¼š follow ä»»ä½•é‡å®šå‘</span>  maxRedirects: <span class="hljs-number">5</span>, <span class="hljs-comment">// default</span>  <span class="hljs-comment">// `socketPath` defines a UNIX Socket to be used in node.js.</span>  <span class="hljs-comment">// e.g. '/var/run/docker.sock' to send requests to the docker daemon.</span>  <span class="hljs-comment">// Only either `socketPath` or `proxy` can be specified.</span>  <span class="hljs-comment">// If both are specified, `socketPath` is used.</span>  socketPath: <span class="hljs-literal">null</span>, <span class="hljs-comment">// default</span>  <span class="hljs-comment">// `httpAgent` å’Œ `httpsAgent` åˆ†åˆ«åœ¨ node.js ä¸­ç”¨äºå®šä¹‰åœ¨æ‰§è¡Œ http å’Œ https æ—¶ä½¿ç”¨çš„è‡ªå®šä¹‰ä»£ç†ã€‚å…è®¸åƒè¿™æ ·é…ç½®é€‰é¡¹ï¼š</span>  <span class="hljs-comment">// `keepAlive` é»˜è®¤æ²¡æœ‰å¯ç”¨</span>  httpAgent: <span class="hljs-keyword">new</span> http.Agent(&#123; keepAlive: <span class="hljs-literal">true</span> &#125;),  httpsAgent: <span class="hljs-keyword">new</span> https.Agent(&#123; keepAlive: <span class="hljs-literal">true</span> &#125;),  <span class="hljs-comment">// 'proxy' å®šä¹‰ä»£ç†æœåŠ¡å™¨çš„ä¸»æœºåç§°å’Œç«¯å£</span>  <span class="hljs-comment">// `auth` è¡¨ç¤º HTTP åŸºç¡€éªŒè¯åº”å½“ç”¨äºè¿æ¥ä»£ç†ï¼Œå¹¶æä¾›å‡­æ®</span>  <span class="hljs-comment">// è¿™å°†ä¼šè®¾ç½®ä¸€ä¸ª `Proxy-Authorization` å¤´ï¼Œè¦†å†™æ‰å·²æœ‰çš„é€šè¿‡ä½¿ç”¨ `header` è®¾ç½®çš„è‡ªå®šä¹‰ `Proxy-Authorization` å¤´ã€‚</span>  proxy: &#123;    host: <span class="hljs-string">'127.0.0.1'</span>,    port: <span class="hljs-number">9000</span>,    auth: &#123;      username: <span class="hljs-string">'mikeymike'</span>,      password: <span class="hljs-string">'rapunz3l'</span>    &#125;  &#125;,  <span class="hljs-comment">// `cancelToken` æŒ‡å®šç”¨äºå–æ¶ˆè¯·æ±‚çš„ cancel token</span>  <span class="hljs-comment">// ï¼ˆæŸ¥çœ‹åé¢çš„ Cancellation è¿™èŠ‚äº†è§£æ›´å¤šï¼‰</span>  cancelToken: <span class="hljs-keyword">new</span> CancelToken(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(cancel)</span> </span>&#123;  &#125;)&#125;</code></pre><h4 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h4><p>å¯ä»¥åˆ†åˆ«è®¾ç½®è¯·æ±‚æ‹¦æˆªå’Œå“åº”æ‹¦æˆªï¼Œåœ¨å‘å‡ºè¯·æ±‚å’Œå“åº”åˆ°è¾¾ then ä¹‹å‰è¿›è¡Œåˆ¤æ–­å¤„ç†ã€‚</p><pre><code class="hljs typescript">axios.interceptors.response.use(  res =&gt; &#123;    <span class="hljs-keyword">if</span> (res) &#123;      <span class="hljs-keyword">return</span> res;    &#125;  &#125;,  err =&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(error);  &#125;);</code></pre><p>æŠŠä¸Šé¢çš„ response æ¢æˆ request å°±æ˜¯è¯·æ±‚å‘å‡ºå‰çš„æ‹¦æˆªå™¨ï½<br>æ‹¦æˆªå™¨æ˜¯å¯ä»¥ç§»é™¤çš„ï¼Œåœ¨ç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œä¼šç”¨åˆ°ç§»é™¤æ‹¦æˆªå™¨ã€‚ï¼ˆæˆ‘å…¶å®ä¹Ÿä¸çŸ¥é“å•¥æƒ…å†µéœ€è¦å¦‚æ­¤è«åå…¶å¦™çš„æ“ä½œï¼‰</p><pre><code class="hljs actionscript"><span class="hljs-keyword">const</span> clearInterceptors = axios.interceptors.request.use(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>&#123;&#125;);axios.interceptors.request.eject(clearInterceptors);<span class="hljs-comment">// ç§»é™¤æ‹¦æˆªå™¨ï¼Œå’Œç§»é™¤jså®šæ—¶å™¨ä¸€æ ·ã€‚</span></code></pre><h3 id="è·¨åŸŸé…ç½®"><a href="#è·¨åŸŸé…ç½®" class="headerlink" title="è·¨åŸŸé…ç½®"></a>è·¨åŸŸé…ç½®</h3><pre><code class="hljs less"><span class="hljs-attribute">proxy</span>: &#123;  <span class="hljs-string">'/api'</span>: &#123;    <span class="hljs-attribute">target</span>: <span class="hljs-string">'https://www.xxx.com'</span>, <span class="hljs-comment">//ç›®æ ‡è·¯å¾„ï¼Œåˆ«å¿˜äº†åŠ httpå’Œç«¯å£å·</span>    <span class="hljs-attribute">changeOrigin</span>: true, <span class="hljs-comment">//æ˜¯å¦è·¨åŸŸ</span>    <span class="hljs-attribute">ws</span>: true,    <span class="hljs-attribute">pathRewrite</span>: &#123;      <span class="hljs-string">'^/api'</span>: <span class="hljs-string">''</span> <span class="hljs-comment">//é‡å†™è·¯å¾„</span>    &#125;  &#125;&#125;</code></pre><h3 id="EXTRA"><a href="#EXTRA" class="headerlink" title="EXTRA"></a>EXTRA</h3><p>æ•´ç‚¹é¢å¤–çš„æƒŠå–œï¼Œç¡¬æ ¸èµ·æ¥ä¸Šä»£ç ï¼</p><pre><code class="hljs php">import axios from <span class="hljs-string">'axios'</span>;import &#123; getLocale &#125; from <span class="hljs-string">'umi-plugin-react/locale'</span>;import &#123; getToken &#125; from <span class="hljs-string">'../token'</span>;<span class="hljs-comment">// Add a request interceptor è¿™æ˜¯åŠ ä¸ªæ‹¦æˆªå™¨ï¼Œåœ¨ request å‘å‡ºè¯·æ±‚ä¹‹å‰ï¼Œå¯ä»¥åšä¸€äº›æ“ä½œçš„ï½</span>axios.interceptors.request.<span class="hljs-keyword">use</span>(<span class="hljs-title">function</span>(<span class="hljs-title">config</span>) &#123;// <span class="hljs-title">Do</span> <span class="hljs-title">something</span> <span class="hljs-title">before</span> <span class="hljs-title">request</span> <span class="hljs-title">is</span> <span class="hljs-title">sent</span><span class="hljs-title">return</span> <span class="hljs-title">config</span>;&#125;,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> </span>&#123;<span class="hljs-comment">// Do something with request error</span><span class="hljs-keyword">return</span> Promise.reject(error);&#125;);<span class="hljs-comment">// Add a response interceptor è¿™ä¹Ÿæ˜¯ä¸ªæ‹¦æˆªï¼Œåœ¨å“åº”åˆ°è¾¾ then ä¹‹å‰ä¹Ÿå¯ä»¥æ“ä½œä¸€æ³¢ï¼Œè¿™é‡Œåšäº†ä¸ªå¦‚æœè¯·æ±‚å¤±è´¥ï¼Œè‡ªåŠ¨é‡æ–°è¯·æ±‚çš„æ“ä½œ</span>axios.interceptors.response.<span class="hljs-keyword">use</span>(<span class="hljs-title">function</span>(<span class="hljs-title">response</span>) &#123;// <span class="hljs-title">Do</span> <span class="hljs-title">something</span> <span class="hljs-title">with</span> <span class="hljs-title">response</span> <span class="hljs-title">data</span><span class="hljs-title">return</span> <span class="hljs-title">response</span>;&#125;,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> </span>&#123;<span class="hljs-comment">// Do something with response error</span><span class="hljs-keyword">const</span> &#123; config, response &#125; = error;<span class="hljs-keyword">if</span> (config) &#123;<span class="hljs-keyword">if</span> (config.retry &amp;&amp;[<span class="hljs-string">'get'</span>, <span class="hljs-string">'put'</span>, <span class="hljs-string">'delete'</span>].includes(config.method) &amp;&amp;(!response || (response.status &gt;= <span class="hljs-number">500</span> &amp;&amp; response.status &lt;= <span class="hljs-number">599</span>))) &#123;<span class="hljs-keyword">const</span> &#123; headers &#125; = config;<span class="hljs-keyword">const</span> retryCountHeaderKey = <span class="hljs-string">'X-Retry-Count'</span>;<span class="hljs-keyword">const</span> retryCountHeaderValue = parseInt(headers[retryCountHeaderKey] || <span class="hljs-string">'0'</span>, <span class="hljs-number">10</span>) + <span class="hljs-number">1</span>;<span class="hljs-keyword">if</span> (retryCountHeaderValue &lt;= <span class="hljs-number">3</span>) &#123; <span class="hljs-comment">// å¦‚æœå¤±è´¥ï¼Œè‡ªåŠ¨è¯·æ±‚ 3 æ¬¡</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Promise(resolve =&gt; &#123;setTimeout(() =&gt;resolve(axios(&#123;...config,headers: &#123;...headers,[retryCountHeaderKey]: `$&#123;retryCountHeaderValue&#125;`,&#125;,&#125;)),<span class="hljs-number">1000</span> \* retryCountHeaderValue);&#125;);&#125;&#125; <span class="hljs-comment">// é‡å‘â€œå®‰å…¨è¯·æ±‚â€</span>&#125;<span class="hljs-keyword">return</span> Promise.reject(error);&#125;);/\*\*- request æ–¹æ³•ï¼Œaxios çš„ç®€å•å°è£…  \*/  export <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">request</span><span class="hljs-params">(url, config = &#123;&#125;)</span> </span>&#123;  axios.defaults.headers.common.Authorization = getToken(); <span class="hljs-comment">// è·å– token</span>  axios.defaults.headers.common[<span class="hljs-string">'Accept-Language'</span>] = `$&#123;getLocale()&#125;;q=<span class="hljs-number">0.9</span>`; <span class="hljs-comment">// å›½é™…åŒ–â€œAccept-Language:zh-CN,zh;q=0.9â€ =&gt; zh-CN æˆ– en-US</span><span class="hljs-keyword">const</span> &#123;method = <span class="hljs-string">'get'</span>,responseType,body = &#123;&#125;,headers = &#123;&#125;,cache = <span class="hljs-keyword">false</span>,download = <span class="hljs-keyword">false</span>,retry = <span class="hljs-keyword">true</span>, <span class="hljs-comment">// eslint-disable-line</span>...rest&#125; = config;<span class="hljs-keyword">const</span> newBody = /(put|post|patch)/i.test(method) ? &#123; data: body &#125; : &#123; params: body &#125;; <span class="hljs-comment">// data å‚æ•°ï¼Œåœ¨ä»¥ä¸‹â€œè¯·æ±‚ç±»å‹â€ä¸­å¯ç”¨ï¼šput, post, patch</span><span class="hljs-keyword">const</span> newResponseType = responseType || (download ? <span class="hljs-string">'arraybuffer'</span> : <span class="hljs-string">'json'</span>);<span class="hljs-keyword">return</span> axios.request(&#123;url, <span class="hljs-comment">// URL åœ°å€</span>method, <span class="hljs-comment">// è¯·æ±‚ç±»å‹ï¼Œget, post, put, delete...</span>responseType: newResponseType, <span class="hljs-comment">// å“åº”æ•°æ®ç±»å‹</span>      headers: &#123;        ...headers,        ...(cache          ? &#123; <span class="hljs-string">'Cache-Control'</span>: <span class="hljs-string">'public, max-age=86400'</span> &#125;          : &#123; <span class="hljs-string">'Cache-Control'</span>: <span class="hljs-string">'no-cache, no-store, must-revalidate'</span>, Pragma: <span class="hljs-string">'no-cache'</span> &#125;),      &#125;,      ...newBody, <span class="hljs-comment">// è¯·æ±‚å‚æ•°</span>      ...rest, <span class="hljs-comment">// å‰©ä½™å‚æ•°</span>    &#125;)    .then(response =&gt; (&#123;      success: <span class="hljs-keyword">true</span>,      response,    &#125;))    .<span class="hljs-keyword">catch</span>(error =&gt; &#123;      <span class="hljs-keyword">const</span> &#123; response &#125; = error;      <span class="hljs-keyword">const</span> &#123; status &#125; = response;      <span class="hljs-keyword">const</span> errorName = `Error$&#123;status&#125; - $&#123;response.config.url&#125;`;      <span class="hljs-keyword">const</span> errorMessage = response.statusText;      console.log(errorName);      console.log(errorMessage);<span class="hljs-comment">// å¦‚æœä¸æ˜¯ç™»é™†é¡µï¼Œä½†æ˜¯çŠ¶æ€ç  401 é‚£ä¹ˆè·³è½¬é¡µé¢åˆ°ç™»é™†é¡µ</span><span class="hljs-keyword">if</span> (window.location.href.indexOf(<span class="hljs-string">'login'</span>) === <span class="hljs-number">-1</span> &amp;&amp; status === <span class="hljs-number">401</span>) &#123;window.location.href = `/g/login?redirect=$&#123; window.location.href.split(window.location.host)[<span class="hljs-number">1</span>] &#125;`;&#125;      <span class="hljs-keyword">return</span> &#123;        success: <span class="hljs-keyword">false</span>,        response: &#123; ...response, data: response.data || &#123; message: <span class="hljs-string">'504 Gateway Timeout'</span> &#125; &#125;,      &#125;;    &#125;);&#125;```<span class="hljs-comment">#### åœ¨é¡¹ç›®ä¸­çš„ç”¨æ³•</span>```         onClick=&#123;() =&gt; &#123;              this.setState(&#123;                spinning: <span class="hljs-keyword">true</span>,              &#125;);              request(`/server/api/declarationfiles/$&#123;record.id&#125;`, &#123;                method: <span class="hljs-string">'get'</span>,                download: <span class="hljs-keyword">true</span>,                onDownloadProgress: e =&gt; &#123;                  <span class="hljs-keyword">if</span> (e.loaded / e.total === <span class="hljs-number">1</span>) &#123;                    this.setState(&#123;                      spinning: <span class="hljs-keyword">false</span>,                    &#125;);                  &#125;                &#125;,              &#125;).then(wrappedResponse =&gt; &#123;                <span class="hljs-keyword">const</span> &#123; response &#125; = wrappedResponse;                download(record.fileName, response.data);              &#125;);            &#125;&#125;                <span class="hljs-comment">//  ç›´æ¥åœ¨é¡µé¢é‡Œå†™è¯·æ±‚ï¼Œé€‚ç”¨äºè°ƒç”¨æ¬¡æ•°å°‘ï¼Œç‹¬ç«‹ä¸“å±äºæŸä¸ªé¡µé¢ä½¿ç”¨çš„æƒ…å†µã€‚æ¯”å¦‚æ–‡ä»¶ä¸‹è½½ç­‰</span>```---```\*retrieveRules(&#123; payload &#125;, &#123; call, put, select &#125;) &#123;<span class="hljs-keyword">const</span> newRules = <span class="hljs-keyword">yield</span> select(models =&gt; &#123;<span class="hljs-keyword">const</span> &#123; pagination, searcher &#125; = models[<span class="hljs-keyword">namespace</span>];<span class="hljs-keyword">return</span> &#123;pagination,searcher,...payload,&#125;;&#125;);<span class="hljs-keyword">const</span> &#123; pagination, searcher &#125; = newRules;<span class="hljs-keyword">const</span> wrappedResponse = <span class="hljs-keyword">yield</span> call(request, `/server/api/projectwarningrules`, &#123;method: <span class="hljs-string">'get'</span>,body: &#123;...pagination,...searcher,&#125;,&#125;);&#125;               <span class="hljs-comment">// å†™åœ¨model å±‚çš„effecté‡Œé¢ï¼Œé€‚ç”¨äºè°ƒç”¨æ¬¡æ•°å¤šï¼Œ æ¯”å¦‚è¯·æ±‚åˆ—è¡¨æ•°æ®ï¼Œå¢åˆ æ”¹æŸ¥æ“ä½œåéœ€è¦å†æ¬¡è°ƒç”¨è¯·æ±‚æ•°æ®</span>``````</code></pre>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>XMLHttpRequest request axios</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç»œåè®®</title>
    <link href="/2020/06/24/network-protocol/"/>
    <url>/2020/06/24/network-protocol/</url>
    
    <content type="html"><![CDATA[<h3 id="äº”å±‚åè®®ä½“ç³»ç»“æ„-ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€è¿è¾“å±‚ã€åº”ç”¨å±‚"><a href="#äº”å±‚åè®®ä½“ç³»ç»“æ„-ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€è¿è¾“å±‚ã€åº”ç”¨å±‚" class="headerlink" title="äº”å±‚åè®®ä½“ç³»ç»“æ„:ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€è¿è¾“å±‚ã€åº”ç”¨å±‚."></a>äº”å±‚åè®®ä½“ç³»ç»“æ„:ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€è¿è¾“å±‚ã€åº”ç”¨å±‚.</h3><h2 id="ç‰©ç†å±‚"><a href="#ç‰©ç†å±‚" class="headerlink" title="ç‰©ç†å±‚"></a>ç‰©ç†å±‚</h2><ul><li>ç‰©ç†å±‚çš„ä¸»è¦ä»»åŠ¡æ˜¯ç¡®å®šä¸ä¼ è¾“åª’ä½“æ¥å£çš„ç‰¹æ€§.å¦‚æœºæ¢°ç‰¹æ€§ã€ç”µæ°”ç‰¹æ€§ã€åŠŸèƒ½ç‰¹æ€§ã€è¿‡ç¨‹ç‰¹æ€§.</li><li>ä¸­ç»§å™¨ï¼šåˆå«è½¬å‘å™¨ï¼ŒåŠŸèƒ½æ˜¯å°†ä¿¡å·æ•´å½¢æ”¾å¤§å†è½¬å‘å‡ºå»ï¼Œä»¥æ¶ˆé™¤ä¿¡å·çš„å¤±çœŸå’Œè¡°å‡ï¼Œæ‰©å¤§ç½‘ç»œä¼ è¾“çš„è·ç¦»ï¼Œå…¶åŸç†æ˜¯ä¿¡å·å†ç”Ÿï¼Œä»…ä½œç”¨äºç”µæ°”éƒ¨åˆ†ï¼Œä¸ç®¡æ•°æ®ä¸­æ˜¯å¦æœ‰é”™è¯¯</li><li>é›†çº¿å™¨(HUB):å®è´¨ä¸Šæ˜¯å¤šç«¯å£çš„ä¸­ç»§å™¨ï¼Œä¹Ÿå·¥ä½œåœ¨ç‰©ç†å±‚ã€‚ä¸€å£æ¥å—æ•°æ®ä¿¡å·ï¼Œå°†å…¶æ•´å½¢æ”¾å¤§è½¬å‘åˆ°å…¶ä»–æ‰€æœ‰(è¾“å…¥ç«¯é™¤å¤–)å¤„äºå·¥ä½œçŠ¶æ€çš„ç«¯å£ä¸Šï¼Œå¤šå£è¾“å…¥ï¼Œå†²çª-&gt;æ— æ•ˆ</li><li>ç å…ƒ:åœ¨ä½¿ç”¨æ—¶é—´åŸŸï¼ˆæˆ–ç®€ç§°ä¸ºæ—¶åŸŸï¼‰çš„æ³¢å½¢è¡¨ç¤ºæ•°å­—ä¿¡å·æ—¶ï¼Œä»£è¡¨ä¸åŒç¦»æ•£æ•°å€¼çš„åŸºæœ¬æ³¢å½¢.</li><li>å‡ ç§é€šä¿¡:å•å·¥é€šä¿¡ã€åŠåŒå·¥é€šä¿¡(åŒæ–¹äº¤æ›¿)ã€å…¨åŒå·¥é€šä¿¡</li><li>ç å…ƒä¼ è¾“çš„é€Ÿç‡è¶Šé«˜ï¼Œæˆ–ä¿¡å·ä¼ è¾“çš„è·ç¦»è¶Šè¿œï¼Œåœ¨ä¿¡é“çš„è¾“å‡ºç«¯çš„æ³¢å½¢çš„å¤±çœŸå°±è¶Šä¸¥é‡ã€‚</li><li>å¥ˆæ°å‡†åˆ™:åœ¨ä»»ä½•ä¿¡é“ä¸­ï¼Œç å…ƒä¼ è¾“çš„é€Ÿç‡æ˜¯æœ‰ä¸Šé™çš„ï¼Œå¦åˆ™å°±ä¼šå‡ºç°ç é—´ä¸²æ‰°çš„é—®é¢˜ï¼Œä½¿æ¥æ”¶ç«¯å¯¹ç å…ƒçš„åˆ¤å†³ï¼ˆå³è¯†åˆ«ï¼‰æˆä¸ºä¸å¯èƒ½.</li><li>ä¿¡é“çš„æé™ä¿¡æ¯ä¼ è¾“é€Ÿç‡ C : C = W log2(1+S/N) b/s ; W ä¸ºä¿¡é“çš„å¸¦å®½ï¼ˆä»¥ Hz ä¸ºå•ä½ï¼‰ï¼›S ä¸ºä¿¡é“å†…æ‰€ä¼ ä¿¡å·çš„å¹³å‡åŠŸç‡ï¼›N ä¸ºä¿¡é“å†…éƒ¨çš„é«˜æ–¯å™ªå£°åŠŸç‡ã€‚ Â·</li><li>å¯¼å¼•å‹ä¼ æ’­åª’ä½“:åŒç»çº¿(å±è”½ã€æ— å±è”½)ã€åŒè½´ç”µç¼†ã€å…‰ç¼†(å•æ¨¡å…‰çº¤ã€åŒæ¨¡å…‰çº¤)ã€éå¯¼å¼•å‹ä¼ è¾“åª’ä½“:æ— çº¿ä¼ è¾“ä»‹è´¨:æ— çº¿ç”µæ³¢ã€å¾®æ³¢ã€çº¢å¤–çº¿ã€æ¿€å…‰.</li><li>é¢‘åˆ†å¤ç”¨:æ‰€æœ‰ç”¨æˆ·åœ¨åŒæ ·çš„æ—¶é—´å ç”¨é¢‘ç‡ä¸åŒçš„å¸¦å®½èµ„æº.</li><li>æ—¶åˆ†å¤ç”¨åˆ™æ˜¯å°†æ—¶é—´åˆ’åˆ†ä¸ºä¸€æ®µæ®µç­‰é•¿çš„æ—¶åˆ†å¤ç”¨å¸§ï¼ˆTDM å¸§ï¼‰ã€‚æ¯ä¸€ä¸ªæ—¶åˆ†å¤ç”¨çš„ç”¨æˆ·åœ¨æ¯ä¸€ä¸ª TDM å¸§ä¸­å ç”¨å›ºå®šåºå·çš„æ—¶éš™</li><li>æ³¢åˆ†å¤ç”¨ï¼šå…‰çš„é¢‘åˆ†å¤ç”¨</li><li>ç åˆ†å¤ç”¨:å„ç”¨æˆ·ä½¿ç”¨ç»è¿‡ç‰¹æ®ŠæŒ‘é€‰çš„ä¸åŒç å‹ï¼Œå› æ­¤å½¼æ­¤ä¸ä¼šé€ æˆå¹²æ‰°ã€‚è¿™ç§ç³»ç»Ÿå‘é€çš„ä¿¡å·æœ‰å¾ˆå¼ºçš„æŠ—å¹²æ‰°èƒ½åŠ›ï¼Œå…¶é¢‘è°±ç±»ä¼¼äºç™½å™ªå£°ï¼Œä¸æ˜“è¢«æ•Œäººå‘ç°</li><li>å®½å¸¦æ¥å…¥æŠ€æœ¯:ADSLã€HFCã€FTTx</li></ul><h2 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h2><ul><li>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“:ç‚¹å¯¹ç‚¹ä¿¡é“ ppp åè®®å’Œå¹¿æ’­ä¿¡é“.</li><li>é“¾è·¯(link)æ˜¯ä¸€æ¡æ— æºçš„ç‚¹åˆ°ç‚¹çš„ç‰©ç†çº¿è·¯æ®µï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•å…¶ä»–çš„äº¤æ¢ç»“ç‚¹ã€‚</li><li>ä¸€æ¡é“¾è·¯åªæ˜¯ä¸€æ¡é€šè·¯çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚æ•°æ®é“¾è·¯(data link) é™¤äº†ç‰©ç†çº¿è·¯å¤–ï¼Œè¿˜å¿…é¡»æœ‰é€šä¿¡åè®®æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“ã€‚è‹¥æŠŠå®ç°è¿™äº›åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°é“¾è·¯ä¸Šï¼Œå°±æ„æˆäº†æ•°æ®é“¾è·¯ã€‚</li><li>æ•°æ®é“¾è·¯çš„åŸºæœ¬å•ä½æ˜¯å¸§.</li><li>æ•°æ®é“¾è·¯å±‚è§£å†³çš„ä¸‰ä¸ªé—®é¢˜æ˜¯å°è£…æˆå¸§ã€é€æ˜ä¼ è¾“ã€å·®é”™æ§åˆ¶</li><li>å°è£…æˆå¸§(framing)å°±æ˜¯åœ¨ä¸€æ®µæ•°æ®çš„å‰ååˆ†åˆ«æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œç„¶åå°±æ„æˆäº†ä¸€ä¸ªå¸§ã€‚ç¡®å®šå¸§çš„ç•Œé™ã€‚</li><li>é€æ˜ä¼ è¾“:åŸå§‹æ•°æ®ä¸­å‡ºç°æ§åˆ¶ç¬¦å¦‚ä½•è½¬ä¹‰.0 æ¯”ç‰¹å¡«å…….</li><li>å¾ªç¯å†—ä½™æ£€éªŒ CRC:ç°åœ¨ k = 6, M = 101001ã€‚è®¾ n = 3, é™¤æ•° P = 1101ï¼Œè¢«é™¤æ•°æ˜¯ 2nM = 101001000ã€‚ æ¨¡ 2 è¿ç®—çš„ç»“æœæ˜¯ï¼šå•† Q = 110101ï¼Œä½™æ•° R = 001ã€‚æŠŠä½™æ•° R ä½œä¸ºå†—ä½™ç æ·»åŠ åœ¨æ•°æ® M çš„åé¢å‘é€å‡ºå»ã€‚å‘é€çš„æ•°æ®æ˜¯ï¼š2nM + R å³ï¼š101001001ï¼Œå…± (k + n) ä½ã€‚<br>åœ¨æ•°æ®åé¢æ·»åŠ ä¸Šçš„å†—ä½™ç ç§°ä¸ºå¸§æ£€éªŒåºåˆ— FCS . CRC æ˜¯ä¸€ç§å¸¸ç”¨çš„æ£€é”™æ–¹æ³•ï¼Œè€Œ FCS æ˜¯æ·»åŠ åœ¨æ•°æ®åé¢çš„å†—ä½™ç ã€‚FCS å¯ä»¥ç”¨ CRC è¿™ç§æ–¹æ³•å¾—å‡ºï¼Œä½† CRC å¹¶éç”¨æ¥è·å¾— FCS çš„å”¯ä¸€æ–¹æ³•</li><li>CRC ä¸èƒ½å®ç°å¯é ä¼ è¾“,éœ€è¦ç¡®è®¤å’Œé‡ä¼ æœºåˆ¶.</li><li>0 æ¯”ç‰¹å¡«å……:è¿ç»­äº”ä¸ª 1 ä¹‹ååŠ å…¥ä¸€ä¸ª 0.</li><li>æ•°æ®é“¾è·¯å±‚çš„ä¸¤ä¸ªå­å±‚:é€»è¾‘é“¾è·¯æ§åˆ¶ LLC (Logical Link Control)å­å±‚</li><li>åª’ä½“æ¥å…¥æ§åˆ¶ MAC (Medium Access Control)å­å±‚.</li><li>é€šä¿¡é€‚é…å™¨,ä¹Ÿå°±æ˜¯ç½‘å¡,ä½œç”¨æ˜¯:è¿›è¡Œä¸²è¡Œ/å¹¶è¡Œè½¬æ¢ã€‚å¯¹æ•°æ®è¿›è¡Œç¼“å­˜ã€‚åœ¨è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿå®‰è£…è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚å®ç°ä»¥å¤ªç½‘åè®®ã€‚</li><li>CSMA/CD åè®®: Carrier Sense Multiple Access with Collision Detection.â€œå¤šç‚¹æ¥å…¥â€è¡¨ç¤ºè®¸å¤šè®¡ç®—æœºä»¥å¤šç‚¹æ¥å…¥çš„æ–¹å¼è¿æ¥åœ¨ä¸€æ ¹æ€»çº¿ä¸Šã€‚â€œè½½æ³¢ç›‘å¬â€æ˜¯æŒ‡æ¯ä¸€ä¸ªç«™åœ¨å‘é€æ•°æ®ä¹‹å‰å…ˆè¦æ£€æµ‹ä¸€ä¸‹æ€»çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–è®¡ç®—æœºåœ¨å‘é€æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™æš‚æ—¶ä¸è¦å‘é€æ•°æ®ï¼Œä»¥å…å‘ç”Ÿç¢°æ’ã€‚ â€œç¢°æ’æ£€æµ‹â€å°±æ˜¯è®¡ç®—æœºè¾¹å‘é€æ•°æ®è¾¹æ£€æµ‹ä¿¡é“ä¸Šçš„ä¿¡å·ç”µå‹å¤§å°ã€‚å½“å‡ ä¸ªç«™åŒæ—¶åœ¨æ€»çº¿ä¸Šå‘é€æ•°æ®æ—¶ï¼Œæ€»çº¿ä¸Šçš„ä¿¡å·ç”µå‹æ‘†åŠ¨å€¼å°†ä¼šå¢å¤§ï¼ˆäº’ç›¸å åŠ ï¼‰ã€‚å½“ä¸€ä¸ªç«™æ£€æµ‹åˆ°çš„ä¿¡å·ç”µå‹æ‘†åŠ¨å€¼è¶…è¿‡ä¸€å®šçš„é—¨é™å€¼æ—¶ï¼Œå°±è®¤ä¸ºæ€»çº¿ä¸Šè‡³å°‘æœ‰ä¸¤ä¸ªç«™åŒæ—¶åœ¨å‘é€æ•°æ®ï¼Œè¡¨æ˜äº§ç”Ÿäº†ç¢°æ’ã€‚åªèƒ½å®ç°åŠåŒå·¥é€šä¿¡.</li><li>é€€é¿ç®—æ³•:å‘ç”Ÿç¢°æ’çš„ç«™åœ¨åœæ­¢å‘é€æ•°æ®åï¼Œè¦æ¨è¿Ÿï¼ˆé€€é¿ï¼‰ä¸€ä¸ªéšæœºæ—¶é—´æ‰èƒ½å†å‘é€æ•°æ®ã€‚</li><li>åœ¨å±€åŸŸç½‘ä¸­ï¼Œç¡¬ä»¶åœ°å€åˆç§°ä¸ºç‰©ç†åœ°å€ï¼Œæˆ– MAC åœ°å€ã€‚</li><li>é›†çº¿å™¨çš„ä¼˜ç¼ºç‚¹:ä½¿åŸæ¥å±äºä¸åŒç¢°æ’åŸŸçš„å±€åŸŸç½‘ä¸Šçš„è®¡ç®—æœºèƒ½å¤Ÿè¿›è¡Œè·¨ç¢°æ’åŸŸçš„é€šä¿¡,æ‰©å¤§äº†å±€åŸŸç½‘è¦†ç›–çš„åœ°ç†èŒƒå›´.ç¼ºç‚¹æ˜¯ç¢°æ’åŸŸå¢å¤§äº†ï¼Œä½†æ€»çš„ååé‡å¹¶æœªæé«˜ã€‚å¦‚æœä¸åŒçš„ç¢°æ’åŸŸä½¿ç”¨ä¸åŒçš„æ•°æ®ç‡ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ç”¨é›†çº¿å™¨å°†å®ƒä»¬äº’è¿èµ·æ¥ã€‚</li><li>ç½‘æ¡¥:åœ¨æ•°æ®é“¾è·¯å±‚æ‰©å±•å±€åŸŸç½‘.æ ¹æ® MAC å¸§çš„ç›®çš„åœ°å€å¯¹æ”¶åˆ°çš„å¸§è¿›è¡Œè½¬å‘.å…·æœ‰è¿‡æ»¤å¸§çš„åŠŸèƒ½<br>ç½‘æ¡¥çš„ä¼˜ç¼ºç‚¹: è¿‡æ»¤é€šä¿¡é‡ã€‚ æ‰©å¤§äº†ç‰©ç†èŒƒå›´ã€‚æé«˜äº†å¯é æ€§ã€‚å¯äº’è¿ä¸åŒç‰©ç†å±‚ã€ä¸åŒ MAC å­å±‚å’Œä¸åŒé€Ÿç‡ï¼ˆå¦‚ 10 Mb/s å’Œ 100 Mb/s ä»¥å¤ªç½‘ï¼‰çš„å±€åŸŸç½‘ã€‚ç¼ºç‚¹:å­˜å‚¨è½¬å‘å¢åŠ äº†æ—¶å»¶ã€‚ åœ¨ MAC å­å±‚å¹¶æ²¡æœ‰æµé‡æ§åˆ¶åŠŸèƒ½ã€‚ å…·æœ‰ä¸åŒ MAC å­å±‚çš„ç½‘æ®µæ¡¥æ¥åœ¨ä¸€èµ·æ—¶æ—¶å»¶æ›´å¤§ã€‚ç½‘æ¡¥åªé€‚åˆäºç”¨æˆ·æ•°ä¸å¤ªå¤š(ä¸è¶…è¿‡å‡ ç™¾ä¸ª)å’Œé€šä¿¡é‡ä¸å¤ªå¤§çš„å±€åŸŸç½‘ï¼Œå¦åˆ™æœ‰æ—¶è¿˜ä¼šå› ä¼ æ’­è¿‡å¤šçš„å¹¿æ’­ä¿¡æ¯è€Œäº§ç”Ÿç½‘ç»œæ‹¥å¡ã€‚è¿™å°±æ˜¯æ‰€è°“çš„å¹¿æ’­é£æš´ã€‚</li><li>ç½‘æ¡¥å’Œé›†çº¿å™¨çš„ä¸åŒ:é›†çº¿å™¨è½¬å‘æ—¶ä¸è¿›è¡Œæ£€æŸ¥,è€Œç½‘æ¡¥ä¼šè¿›è¡Œ CSMA/CD ç®—æ³•.</li><li>é€æ˜ç½‘æ¡¥:â€œé€æ˜â€æ˜¯æŒ‡å±€åŸŸç½‘ä¸Šçš„ç«™ç‚¹å¹¶ä¸çŸ¥é“æ‰€å‘é€çš„å¸§å°†ç»è¿‡å“ªå‡ ä¸ªç½‘æ¡¥ï¼Œå› ä¸ºç½‘æ¡¥å¯¹å„ç«™æ¥è¯´æ˜¯çœ‹ä¸è§çš„ã€‚<br>åœ¨ç½‘æ¡¥çš„è½¬å‘è¡¨ä¸­å†™å…¥çš„ä¿¡æ¯é™¤äº†åœ°å€å’Œæ¥å£å¤–ï¼Œè¿˜æœ‰å¸§è¿›å…¥è¯¥ç½‘æ¡¥çš„æ—¶é—´ã€‚<br>é¿å…äº§ç”Ÿè½¬å‘çš„å¸§åœ¨ç½‘ç»œä¸­ä¸æ–­åœ°å…œåœˆå­çš„æ–¹æ³•æ˜¯ç”Ÿæˆæ ‘.</li><li>ä»¥å¤ªç½‘äº¤æ¢æœº:ä»¥å¤ªç½‘äº¤æ¢æœºçš„æ¯ä¸ªæ¥å£éƒ½ç›´æ¥ä¸ä¸»æœºç›¸è¿ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½å·¥ä½œåœ¨å…¨åŒå·¥æ–¹å¼ã€‚äº¤æ¢æœºèƒ½åŒæ—¶è¿é€šè®¸å¤šå¯¹çš„æ¥å£ï¼Œä½¿æ¯ä¸€å¯¹ç›¸äº’é€šä¿¡çš„ä¸»æœºéƒ½èƒ½åƒç‹¬å é€šä¿¡åª’ä½“é‚£æ ·ï¼Œè¿›è¡Œæ— ç¢°æ’åœ°ä¼ è¾“æ•°æ®ã€‚ ä»¥å¤ªç½‘äº¤æ¢æœºç”±äºä½¿ç”¨äº†ä¸“ç”¨çš„äº¤æ¢ç»“æ„èŠ¯ç‰‡ï¼Œå…¶äº¤æ¢é€Ÿç‡å°±è¾ƒé«˜ã€‚<br>è™šæ‹Ÿå±€åŸŸç½‘:è™šæ‹Ÿå±€åŸŸç½‘ VLAN æ˜¯ç”±ä¸€äº›å±€åŸŸç½‘ç½‘æ®µæ„æˆçš„ä¸ç‰©ç†ä½ç½®æ— å…³çš„é€»è¾‘ç»„ã€‚è¿™äº›ç½‘æ®µå…·æœ‰æŸäº›å…±åŒçš„éœ€æ±‚ã€‚æ¯ä¸€ä¸ª VLAN çš„å¸§éƒ½æœ‰ä¸€ä¸ªæ˜ç¡®çš„æ ‡è¯†ç¬¦ï¼ŒæŒ‡æ˜å‘é€è¿™ä¸ªå¸§çš„å·¥ä½œç«™æ˜¯å±äºå“ªä¸€ä¸ª VLANã€‚</li></ul><h2 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h2><ul><li>è™šç”µè·¯è¡¨ç¤ºè¿™åªæ˜¯ä¸€æ¡é€»è¾‘ä¸Šçš„è¿æ¥ï¼Œåˆ†ç»„éƒ½æ²¿ç€è¿™æ¡é€»è¾‘è¿æ¥æŒ‰ç…§å­˜å‚¨è½¬å‘æ–¹å¼ä¼ é€ï¼Œè€Œå¹¶ä¸æ˜¯çœŸæ­£å»ºç«‹äº†ä¸€æ¡ç‰©ç†è¿æ¥ã€‚</li><li>ç½‘ç»œå±‚å‘ä¸Šåªæä¾›ç®€å•çµæ´»çš„ã€æ— è¿æ¥çš„ã€å°½æœ€å¤§åŠªåŠ›äº¤ä»˜çš„æ•°æ®æŠ¥æœåŠ¡ã€‚<br>IP åè®®.åœ°å€è§£æåè®® ARP.(IP åœ°å€-&gt;ç‰©ç†åœ°å€)é€†åœ°å€è§£æåè®® RARP.ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMP.ç½‘é™…ç»„ç®¡ç†åè®® IGMP éƒ½æ˜¯ç½‘ç»œå±‚çš„åè®®,TCPã€UDP æ˜¯è¿è¾“å±‚çš„åè®®.</li><li>ä¸­é—´è®¾å¤‡åˆç§°ä¸ºä¸­é—´ç³»ç»Ÿæˆ–ä¸­ç»§(relay)ç³»ç»Ÿã€‚ç‰©ç†å±‚ä¸­ç»§ç³»ç»Ÿï¼šè½¬å‘å™¨(repeater)ã€‚æ•°æ®é“¾è·¯å±‚ä¸­ç»§ç³»ç»Ÿï¼šç½‘æ¡¥æˆ–æ¡¥æ¥å™¨(bridge)ã€‚ç½‘ç»œå±‚ä¸­ç»§ç³»ç»Ÿï¼šè·¯ç”±å™¨(router)ã€‚ç½‘æ¡¥å’Œè·¯ç”±å™¨çš„æ··åˆç‰©ï¼šæ¡¥è·¯å™¨(brouter)ã€‚ç½‘ç»œå±‚ä»¥ä¸Šçš„ä¸­ç»§ç³»ç»Ÿï¼šç½‘å…³(gateway)ã€‚</li><li>å››ç±» IP åœ°å€:A ç±» 0 å¼€å¤´ç½‘ç»œå· 8 ä½,ä¸»æœºå· 24 ä½.B ç±» 10 å¼€å¤´ç½‘ç»œå· 16 ä½.C ç±» 110 å¼€å¤´ç½‘ç»œå· 24 ä½.D ç±» 1110 å¼€å¤´,å¤šæ’­åœ°å€.E ç±» 1111 å¼€å¤´,ä¿ç•™åœ°å€.</li><li>IP åˆ†ç½‘ç»œå·å’Œä¸»æœºå·:ç¬¬ä¸€ï¼ŒIP åœ°å€ç®¡ç†æœºæ„åœ¨åˆ†é… IP åœ°å€æ—¶åªåˆ†é…ç½‘ç»œå·ï¼Œè€Œå‰©ä¸‹çš„ä¸»æœºå·åˆ™ç”±å¾—åˆ°è¯¥ç½‘ç»œå·çš„å•ä½è‡ªè¡Œåˆ†é…ã€‚è¿™æ ·å°±æ–¹ä¾¿äº† IP åœ°å€çš„ç®¡ç†ã€‚ç¬¬äºŒï¼Œè·¯ç”±å™¨ä»…æ ¹æ®ç›®çš„ä¸»æœºæ‰€è¿æ¥çš„ç½‘ç»œå·æ¥è½¬å‘åˆ†ç»„ï¼ˆè€Œä¸è€ƒè™‘ç›®çš„ä¸»æœºå·ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®æ•°å¤§å¹…åº¦å‡å°‘ï¼Œä»è€Œå‡å°äº†è·¯ç”±è¡¨æ‰€å çš„å­˜å‚¨ç©ºé—´ã€‚</li><li>ARP:æ¯ä¸€ä¸ªä¸»æœºéƒ½è®¾æœ‰ä¸€ä¸ª ARP é«˜é€Ÿç¼“å­˜(ARP cache)ï¼Œé‡Œé¢æœ‰æ‰€åœ¨çš„å±€åŸŸç½‘ä¸Šçš„å„ä¸»æœºå’Œè·¯ç”±å™¨çš„ IP åœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„è¡¨ã€‚</li><li>ICMP:ICMP å…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Š.æœ‰ä¸¤ç§æŠ¥æ–‡ç§ç±»:å³ ICMP å·®é”™æŠ¥å‘ŠæŠ¥æ–‡å’Œ ICMP è¯¢é—®æŠ¥æ–‡.Ping å’Œ Traceroute æŒ‡ä»¤é€šè¿‡ ICMP åè®®,ä¸ç»è¿‡ TCP æˆ–è€… UDP.</li><li>è·¯ç”±é€‰æ‹©åè®®:å†…éƒ¨ç½‘å…³åè®® IGP( RIP å’Œ OSPF)å’Œå¤–éƒ¨ç½‘å…³åè®® EGP( BGP-4)</li><li>RIP:æ˜¯ä¸€ç§åˆ†å¸ƒå¼çš„åŸºäºè·ç¦»å‘é‡çš„è·¯ç”±é€‰æ‹©åè®®,æ¯ä¸€ä¸ªè·¯ç”±å™¨éƒ½è¦ç»´æŠ¤ä»å®ƒè‡ªå·±åˆ°å…¶ä»–æ¯ä¸€ä¸ªç›®çš„ç½‘ç»œçš„è·ç¦»è®°å½•.RIP å…è®¸ä¸€æ¡è·¯å¾„æœ€å¤šåªèƒ½åŒ…å« 15 ä¸ªè·¯ç”±å™¨.</li><li>RIP åè®®ä¸‰ä¸ªè¦ç‚¹:ä»…å’Œç›¸é‚»è·¯ç”±å™¨äº¤æ¢ä¿¡æ¯ã€‚ äº¤æ¢çš„ä¿¡æ¯æ˜¯å½“å‰æœ¬è·¯ç”±å™¨æ‰€çŸ¥é“çš„å…¨éƒ¨ä¿¡æ¯ï¼Œå³è‡ªå·±çš„è·¯ç”±è¡¨ã€‚ æŒ‰å›ºå®šçš„æ—¶é—´é—´éš”äº¤æ¢è·¯ç”±ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œæ¯éš” 30 ç§’ã€‚</li><li>RIP çš„ä¼˜ç¼ºç‚¹:ä¼˜ç‚¹:å®ç°ç®€å•å¼€é”€å°,ç¼ºç‚¹æ˜¯æ•…éšœä¼ è¾“æ…¢ã€ç½‘ç»œè§„æ¨¡å°.</li><li>OSPF åè®®:æ˜¯åˆ†å¸ƒå¼çš„é“¾è·¯çŠ¶æ€åè®®.OSPF ä¸ç”¨ UDP è€Œæ˜¯ç›´æ¥ç”¨ IP æ•°æ®æŠ¥ä¼ é€ã€‚</li><li>OSPF çš„ä¸‰ä¸ªè¦ç‚¹:å‘æœ¬è‡ªæ²»ç³»ç»Ÿä¸­æ‰€æœ‰è·¯ç”±å™¨å‘é€ä¿¡æ¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ–¹æ³•æ˜¯æ´ªæ³›æ³•ã€‚å‘é€çš„ä¿¡æ¯å°±æ˜¯ä¸æœ¬è·¯ç”±å™¨ç›¸é‚»çš„æ‰€æœ‰è·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€ï¼Œä½†è¿™åªæ˜¯è·¯ç”±å™¨æ‰€çŸ¥é“çš„éƒ¨åˆ†ä¿¡æ¯ã€‚åªæœ‰å½“é“¾è·¯çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè·¯ç”±å™¨æ‰ç”¨æ´ªæ³›æ³•å‘æ‰€æœ‰è·¯ç”±å™¨å‘é€æ­¤ä¿¡æ¯ã€‚<br>ä¸ºäº†ä½¿ OSPF èƒ½å¤Ÿç”¨äºè§„æ¨¡å¾ˆå¤§çš„ç½‘ç»œï¼ŒOSPF å°†ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªæ›´å°çš„èŒƒå›´ï¼Œå«ä½œåŒºåŸŸã€‚å‡å°‘äº†æ•´ä¸ªç½‘ç»œä¸Šçš„é€šä¿¡é‡ã€‚<br>OSPF çš„äº”ç§åˆ†ç»„ç±»å‹:é—®å€™ã€æ•°æ®åº“æè¿°ã€é“¾è·¯çŠ¶æ€è¯·æ±‚ã€é“¾è·¯çŠ¶æ€æ›´æ–°ã€é“¾è·¯çŠ¶æ€ç¡®è®¤.<br>MTU(è·¯å¾„æœ€å¤§ä¼ è¾“å•å…ƒ)</li><li>CIDR:æ— ç±»åˆ«åŸŸé—´è·¯ç”±.ç¼“è§£äº†åœ°å€æ¯ç«­çš„è¶‹åŠ¿ï¼›æ§åˆ¶ç”šè‡³ç¼©å‡äº†è·¯ç”±è¡¨çš„å¼€é”€<br>åˆ†é… IP åœ°å€çš„æ—¶å€™ä¸å†ä»¥ç±»åˆ«æ¥åˆ†ï¼Œè€Œæ˜¯æŒ‰ç…§å¯å˜é•¿çš„åœ°å€å—æ¥åˆ†é….åŸºäºå¯å˜é•¿å­ç½‘æ©ç  VLSM.</li><li>æ‹¥å¡æ§åˆ¶:æµé‡æ„ŸçŸ¥è·¯ç”±ã€å‡†å…¥æ§åˆ¶ã€æµé‡è°ƒèŠ‚ã€è´Ÿè½½ä¸¢å¼ƒã€éšæœºæ—©æœŸæ£€æµ‹ RED.</li><li>æµé‡æ•´å½¢:æ¼æ¡¶ã€ä»¤ç‰Œæ¡¶.</li></ul><h2 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h2><ul><li>åº”ç”¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡åˆç§°ä¸ºç«¯åˆ°ç«¯çš„é€šä¿¡ã€‚ è¿è¾“å±‚çš„ä¸€ä¸ªå¾ˆé‡è¦çš„åŠŸèƒ½å°±æ˜¯å¤ç”¨å’Œåˆ†ç”¨ã€‚åº”ç”¨å±‚ä¸åŒè¿›ç¨‹çš„æŠ¥æ–‡é€šè¿‡ä¸åŒçš„ç«¯å£å‘ä¸‹äº¤åˆ°è¿è¾“å±‚ï¼Œå†å¾€ä¸‹å°±å…±ç”¨ç½‘ç»œå±‚æä¾›çš„æœåŠ¡ã€‚IP åè®®æä¾›ä¸»æœºä¹‹é—´çš„é€»è¾‘é€šä¿¡,è€Œ TCP/UDP æä¾›è¿›ç¨‹ä¹‹é—´çš„é€»è¾‘é€šä¿¡.</li><li>ç”¨æˆ·æ•°æ®æŠ¥åè®® UDP å’Œ ä¼ è¾“æ§åˆ¶åè®® TCP ,TCP è¦æä¾›å¯é çš„ã€é¢å‘è¿æ¥çš„è¿è¾“æœåŠ¡.</li><li>ä¸¤ä¸ªå¯¹ç­‰è¿è¾“å®ä½“åœ¨é€šä¿¡æ—¶ä¼ é€çš„æ•°æ®å•ä½å«ä½œè¿è¾“åè®®æ•°æ®å•å…ƒ TPDU .</li><li>UDP åªåœ¨ IP çš„æ•°æ®æŠ¥æœåŠ¡ä¹‹ä¸Šå¢åŠ äº†å¾ˆå°‘ä¸€ç‚¹çš„åŠŸèƒ½ï¼Œå³ç«¯å£çš„åŠŸèƒ½å’Œå·®é”™æ£€æµ‹çš„åŠŸèƒ½,ä¸ä¿è¯å¯é äº¤ä»˜ï¼ŒåŒæ—¶ä¹Ÿä¸ä½¿ç”¨æ‹¥å¡æ§åˆ¶</li><li>TCP æ˜¯é¢å‘è¿æ¥çš„è¿è¾“å±‚åè®®ã€‚æ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹(endpoint)ï¼Œæ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„ï¼ˆä¸€å¯¹ä¸€ï¼‰ã€‚ TCP æä¾›å¯é äº¤ä»˜çš„æœåŠ¡ã€‚ TCP æä¾›å…¨åŒå·¥é€šä¿¡ã€‚é¢å‘å­—èŠ‚æµã€‚</li><li>TCP è¿æ¥çš„ç«¯ç‚¹å«åšå¥—æ¥å­—(socket)æˆ–æ’å£ã€‚</li><li>ARQ:ä½¿ç”¨ä¸Šè¿°çš„ç¡®è®¤å’Œé‡ä¼ æœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸å¯é çš„ä¼ è¾“ç½‘ç»œä¸Šå®ç°å¯é çš„é€šä¿¡ã€‚è¿™ç§å¯é ä¼ è¾“åè®®å¸¸ç§°ä¸ºè‡ªåŠ¨é‡ä¼ è¯·æ±‚ ARQ (Automatic Repeat reQuest), ARQ è¡¨æ˜é‡ä¼ çš„è¯·æ±‚æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ã€‚æ¥æ”¶æ–¹ä¸éœ€è¦è¯·æ±‚å‘é€æ–¹é‡ä¼ æŸä¸ªå‡ºé”™çš„åˆ†ç»„ ã€‚</li><li>è¿ç»­ ARQ å’Œå›é€€ NARQ.</li></ul><h2 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h2><p>DNS:åŒæ—¶ä½¿ç”¨ TCP å’Œ UDP:53<br>FTP:TCP:21<br>NFS:UDP<br>TFTP:UDP<br>TELNET:TCP:23<br>RPC:TCP<br>HTTP:TCP:80<br>SMTP:TCP:25,å‘é‚®ä»¶<br>POP3:TCP:110<br>IMAP:TCP<br>MIME:MIME ç±»å‹æ˜¯ä¸€ç§é€šçŸ¥å®¢æˆ·ç«¯å…¶æ¥æ”¶æ–‡ä»¶çš„å¤šæ ·æ€§çš„æœºåˆ¶:<br>DHCP:UDP<br>SNMP:UDP<br>POP3 å’Œ IMAP çš„åŒºåˆ«:POP3 åè®®å…è®¸ç”µå­é‚®ä»¶å®¢æˆ·ç«¯ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ï¼Œä½†æ˜¯åœ¨å®¢æˆ·ç«¯çš„æ“ä½œï¼ˆå¦‚ç§»åŠ¨é‚®ä»¶ã€æ ‡è®°å·²è¯»ç­‰ï¼‰ï¼Œä¸ä¼šåé¦ˆåˆ°æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚é€šè¿‡å®¢æˆ·ç«¯æ”¶å–äº†é‚®ç®±ä¸­çš„ 3 å°é‚®ä»¶å¹¶ç§»åŠ¨åˆ°å…¶ä»–æ–‡ä»¶å¤¹ï¼Œé‚®ç®±æœåŠ¡å™¨ä¸Šçš„è¿™äº›é‚®ä»¶æ˜¯æ²¡æœ‰åŒæ—¶è¢«ç§»åŠ¨çš„ ã€‚è€Œ IMAP æä¾› webmail ä¸ç”µå­é‚®ä»¶å®¢æˆ·ç«¯ä¹‹é—´çš„åŒå‘é€šä¿¡ï¼Œå®¢æˆ·ç«¯çš„æ“ä½œéƒ½ä¼šåé¦ˆåˆ°æœåŠ¡å™¨ä¸Šï¼Œå¯¹é‚®ä»¶è¿›è¡Œçš„æ“ä½œï¼ŒæœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ä¹Ÿä¼šåšç›¸åº”çš„åŠ¨ä½œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>http tcp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•ç›¸å…³</title>
    <link href="/2020/06/23/phone-interview/"/>
    <url>/2020/06/23/phone-interview/</url>
    
    <content type="html"><![CDATA[<p><a href="https://vevlins.github.io/2018/03/14/%E9%9D%A2%E8%AF%95%E8%A6%81%E7%82%B9%E6%95%B4%E7%90%86/" target="_blank" rel="noopener">åˆ«äººçš„åšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç”µè¯é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½œç”¨åŸŸ</title>
    <link href="/2020/06/23/scope/"/>
    <url>/2020/06/23/scope/</url>
    
    <content type="html"><![CDATA[<h2 id="ä½œç”¨åŸŸå°±æ˜¯å˜é‡ä¸å‡½æ•°çš„å¯è®¿é—®èŒƒå›´ï¼Œå³ä½œç”¨åŸŸæ§åˆ¶ç€å˜é‡ä¸å‡½æ•°çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚"><a href="#ä½œç”¨åŸŸå°±æ˜¯å˜é‡ä¸å‡½æ•°çš„å¯è®¿é—®èŒƒå›´ï¼Œå³ä½œç”¨åŸŸæ§åˆ¶ç€å˜é‡ä¸å‡½æ•°çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚" class="headerlink" title="ä½œç”¨åŸŸå°±æ˜¯å˜é‡ä¸å‡½æ•°çš„å¯è®¿é—®èŒƒå›´ï¼Œå³ä½œç”¨åŸŸæ§åˆ¶ç€å˜é‡ä¸å‡½æ•°çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚"></a>ä½œç”¨åŸŸå°±æ˜¯å˜é‡ä¸å‡½æ•°çš„å¯è®¿é—®èŒƒå›´ï¼Œå³ä½œç”¨åŸŸæ§åˆ¶ç€å˜é‡ä¸å‡½æ•°çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚</h2><h3 id="1-å…¨å±€ä½œç”¨åŸŸ"><a href="#1-å…¨å±€ä½œç”¨åŸŸ" class="headerlink" title="1. å…¨å±€ä½œç”¨åŸŸ"></a>1. å…¨å±€ä½œç”¨åŸŸ</h3><p>ä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®åˆ°çš„å¯¹è±¡æ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸã€‚<br>1.1 å‡½æ•°å¤–é¢å®šä¹‰çš„å˜é‡æ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸ<br>1.2 æœªå®šä¹‰ç›´æ¥èµ‹å€¼çš„å˜é‡è‡ªåŠ¨å£°æ˜ä¸ºæ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸ<br>1.3.window å¯¹è±¡çš„å±æ€§æ‹¥æœ‰å…¨å±€ä½œç”¨</p><h3 id="2-å±€éƒ¨ä½œç”¨åŸŸ"><a href="#2-å±€éƒ¨ä½œç”¨åŸŸ" class="headerlink" title="2. å±€éƒ¨ä½œç”¨åŸŸ"></a>2. å±€éƒ¨ä½œç”¨åŸŸ</h3><p>å‡½æ•°å†…éƒ¨çš„ä½œç”¨åŸŸä¸ºå±€éƒ¨ä½œç”¨åŸŸ</p><h2 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h2><p>é€šä¿—åœ°è®²ï¼Œå½“å£°æ˜ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå±€éƒ¨ä½œç”¨åŸŸä¸€çº§ä¸€çº§å‘ä¸ŠåŒ…èµ·æ¥ï¼Œå°±æ˜¯ä½œç”¨åŸŸé“¾ã€‚</p><p>1.å½“æ‰§è¡Œå‡½æ•°æ—¶ï¼Œæ€»æ˜¯å…ˆä»å‡½æ•°å†…éƒ¨æ‰¾å¯»å±€éƒ¨å˜é‡</p><p>2.å¦‚æœå†…éƒ¨æ‰¾ä¸åˆ°ï¼ˆå‡½æ•°çš„å±€éƒ¨ä½œç”¨åŸŸæ²¡æœ‰ï¼‰ï¼Œåˆ™ä¼šå‘åˆ›å»ºå‡½æ•°çš„ä½œç”¨åŸŸï¼ˆå£°æ˜å‡½æ•°çš„ä½œç”¨åŸŸï¼‰å¯»æ‰¾ï¼Œä¾æ¬¡å‘ä¸Š</p><hr><pre><code class="hljs delphi"><span class="hljs-keyword">var</span> bb = <span class="hljs-number">1</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(bb)</span><span class="hljs-comment">&#123;</span></span><span class="hljs-function"><span class="hljs-comment">  bb = 2 ;</span></span><span class="hljs-function"><span class="hljs-comment">  alert(bb)</span></span><span class="hljs-function"><span class="hljs-comment">&#125;</span></span><span class="hljs-function"><span class="hljs-title">fn</span><span class="hljs-params">(bb)</span>;</span>alert(bb)<span class="hljs-comment">//  2,1</span><span class="hljs-keyword">var</span> bb = <span class="hljs-number">1</span> ;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">()</span><span class="hljs-comment">&#123;</span></span><span class="hljs-function"><span class="hljs-comment">  alert(bb)</span></span><span class="hljs-function"><span class="hljs-comment">&#125;</span></span><span class="hljs-function"></span><span class="hljs-function"><span class="hljs-title">fn</span><span class="hljs-params">()</span></span><span class="hljs-function"><span class="hljs-comment">// undefined</span></span></code></pre>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä½œç”¨åŸŸ ä½œç”¨åŸŸé“¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»è¾“å…¥URLåˆ°é¡µé¢æ¸²æŸ“</title>
    <link href="/2020/06/18/hardcore-process/"/>
    <url>/2020/06/18/hardcore-process/</url>
    
    <content type="html"><![CDATA[<p>å‰è¨€ï¼šä¸çŸ¥é“è¿™ç©æ„å„¿ï¼Œå‰ç«¯ä¹Ÿèƒ½å¹²æ´»ã€‚ä½†æ˜¯å¾—è¿›æ­¥å•Šã€‚å½“å­¦ä¼šäº†è¿™ç©æ„å„¿ï¼Œå¯¹ç½‘ç»œçš„ç†è§£ä¼šä¸¾å¤´æœ›æ˜æœˆï¼Œæ›´ä¸Šä¸€å±‚æ¥¼ã€‚<br>åæ­£ç™¾åˆ©è€Œæ— ä¸€å®³ã€‚å˜¿å˜¿ï¼Œå¼€å§‹æ•´æ´»ï½</p><p>ç¬¬ä¸€æ­¥ï¼Œæ‰‹æ”¾åœ¨é”®ç›˜ä¸Šæ•²å‡º urlï¼Œç„¶åå›è½¦ï¼Œå’”å“’ä¸€æ•²ï¼ç„¶åé¡µé¢å°±å‡ºæ¥äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï½ ğŸ˜<br>è®©æˆ‘ä»¬çš„å­¦ä¹ æ°”æ°›è½»æ¾èµ·æ¥ï½ ä¸‹é¢æ­£å¼å¼€å§‹ï¼Œæˆ‘æ•²ä¸ª urlï¼š</p><p><a href="https://onepunchx.github.io/archives/" target="_blank" rel="noopener">https://onepunchx.github.io/archives/</a></p><h2 id="è¯¦ç»†è§£æ"><a href="#è¯¦ç»†è§£æ" class="headerlink" title="è¯¦ç»†è§£æ"></a>è¯¦ç»†è§£æ</h2><p>è¾“å…¥å®Œè¿™ä¸ªç½‘å€ï¼Œæ•²å›è½¦ï¼æµè§ˆå™¨åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ è§£æè¿™ä¸ª urlï¼š</p><ol><li><strong>é€šè¿‡ <em>DNS_ï¼ˆdomain name systemï¼‰ æŠŠåŸŸåï¼ˆdomain nameï¼‰è§£æç¨‹ _IP</em> åœ°å€</strong></li></ol><p>IP åœ°å€è¿™ç©æ„å„¿ï¼Œå°±ç›¸å½“äºæˆ‘ä»¬æ¯ä¸ªäººçš„èº«ä»½è¯å·ç ï¼Œèº«ä»½è¯å·å¯ä»¥å”¯ä¸€ã€ç²¾å‡†çš„åŒ¹é…åˆ°ä¸€ä¸ªäººï¼Œé‚£ä¹ˆ IP åœ°å€å°±å¯ä»¥å”¯ä¸€ã€ç²¾å‡†çš„åŒ¹é…åˆ°å¯¹åº”çš„è®¡ç®—æœºã€‚<br>ä½†æ˜¯èº«ä»½è¯å·ç è¿™ç©æ„ï¼Œä½ èƒ½è®°ä½å‡ ä¸ªï¼Ÿèƒ½è®°ä½è‡ªå·±çš„å°±ä¸é”™äº†ï¼Œé€šå¸¸ä½ è®°ä½çš„éƒ½æ˜¯åˆ«äººçš„åå­—ï¼Œé‚£ä¹ˆè¿™ä¸ªåŸŸå/ç½‘å€/URL å°±ç›¸å½“äºè®¡ç®—æœºçš„åå­—<br>å½¢è±¡ä¸€ç‚¹çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><table><thead><tr><th>è¡¨å¤´</th><th>è¡¨å¤´</th></tr></thead><tbody><tr><td>åå­—</td><td>èº«ä»½è¯å·ç </td></tr><tr><td>ç‹æ˜Š</td><td>211232199608135438</td></tr><tr><td>åŸŸå</td><td>IP</td></tr><tr><td><a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></td><td>220.181.111.188</td></tr></tbody></table><ol start="2"><li><strong>ç„¶ååº”ç”¨æ›¾ç”Ÿæˆ HTTP è¯·æ±‚æŠ¥æ–‡</strong><br>å•¥æ˜¯è¯·æ±‚æŠ¥æ–‡ï¼Ÿ<br>è¯·æ±‚æŠ¥æ–‡ æœ‰èµ·å§‹è¡Œ é¦–éƒ¨ å’Œ ä¸»ä½“éƒ¨åˆ†ï¼Œè¯´èµ·æ¥å¤ªä¸å½¢è±¡å…·ä½“äº†ï¼Œç›´æ¥ä¸Šä»£ç ï¼</li></ol><p>GET <a href="https://www.baidu.com/" target="_blank" rel="noopener">https://www.baidu.com/</a> HTTP/1.1 ï¼ˆèµ·å§‹è¡Œï¼‰</p><p>Host: <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a><br>Connection: keep-alive<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8<br>X-Client-Data: CKm1yQEIhbbJAQijtskBCMG2yQEIqZ3KAQioo8oB<br>Accept-Encoding: gzip, deflate, br<br>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8<br>ï¼ˆé¦–éƒ¨ï¼‰</p><p>ç„¶åæ˜¯ä¸»ä½“å†…å®¹ï¼Œget è¯·æ±‚çš„ä¸»ä½“å†…å®¹ä¸ºç©ºï¼Œpost çš„è¯·æ±‚ä¸»ä½“å†…å®¹å°±æ˜¯è¯·æ±‚ä½“ï¼Œbody é‡Œé¢çš„å†…å®¹</p><p>è¿™ä¸ª http è¯·æ±‚æŠ¥æ–‡è¯´èµ·æ¥é‡Œé¢å­¦é—®å¾ˆå¤§ï¼Œæœ‰æœºä¼šçš„è¯å•ç‹¬å†™ä¸€æ¬¡ã€‚è¿™é‡Œç»™è‡ªå·±å…ˆæŒ–ä¸ªå‘ã€‚ã€‚ã€‚</p><ol start="3"><li><p><strong>ä¼ è¾“å±‚å»ºç«‹ TCP è¿æ¥</strong><br>3 æ¬¡æ¡æ‰‹ï¼Œ4 æ¬¡æŒ¥æ‰‹ã€‚<br>è¿™é‡Œä¸ç»†è¯´ï¼Œç­‰å¾…åç»­å¡«å‘</p></li><li><p><strong>ç½‘ç»œå±‚ä½¿ç”¨ IP åè®®æ¥é€‰æ‹©è·¯çº¿</strong><br>å¤„ç†æ¥è‡ªä¼ è¾“å±‚çš„æ•°æ®æ®µ segmentï¼Œå°†æ•°æ®æ®µ segment è£…å…¥æ•°æ®åŒ… packetï¼Œå¡«å……åŒ…å¤´ï¼Œä¸»è¦å°±æ˜¯æ·»åŠ æºå’Œç›®çš„ IP åœ°å€ï¼Œç„¶åå‘é€æ•°æ®ã€‚åœ¨æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼ŒIP åè®®è´Ÿè´£é€‰æ‹©ä¼ é€çš„è·¯çº¿ï¼Œç§°ä¸ºè·¯ç”±åŠŸèƒ½</p></li><li><p><strong>æ•°æ®é“¾è·¯å±‚å®ç°ç½‘ç»œç›¸é‚»ç»“ç‚¹é—´å¯é çš„æ•°æ®é€šä¿¡</strong><br>ã€€ã€€ä¸ºäº†ä¿è¯æ•°æ®çš„å¯é ä¼ è¾“ï¼ŒæŠŠæ•°æ®åŒ… packet å°è£…æˆå¸§(Frame)ï¼Œå¹¶æŒ‰é¡ºåºä¼ é€å„å¸§ã€‚ç”±äºç‰©ç†çº¿è·¯çš„ä¸å¯é ï¼Œå‘å‡ºçš„æ•°æ®å¸§æœ‰å¯èƒ½åœ¨çº¿è·¯ä¸Šå‡ºé”™æˆ–ä¸¢å¤±ï¼Œäºæ˜¯ä¸ºæ¯ä¸ªæ•°æ®åˆ†å—è®¡ç®—å‡º CRC(å¾ªç¯å†—ä½™æ£€éªŒ)ï¼Œå¹¶æŠŠ CRC æ·»åŠ åˆ°å¸§ä¸­ï¼Œè¿™æ ·æ¥æ”¶æ–¹å°±å¯ä»¥é€šè¿‡é‡æ–°è®¡ç®— CRC æ¥åˆ¤æ–­æ•°æ®æ¥æ”¶çš„æ­£ç¡®æ€§ã€‚ä¸€æ—¦å‡ºé”™å°±é‡ä¼ </p></li></ol><p>å°†æ•°æ®åŒ… packet å°è£…æˆå¸§(Frame)ï¼ŒåŒ…æ‹¬å¸§å¤´å’Œå¸§å°¾ã€‚å¸§å°¾æ˜¯æ·»åŠ è¢«ç§°åš CRC çš„å¾ªç¯å†—ä½™æ ¡éªŒéƒ¨åˆ†ã€‚å¸§å¤´ä¸»è¦æ˜¯æ·»åŠ æ•°æ®é“¾è·¯å±‚çš„åœ°å€ï¼Œå³æ•°æ®é“¾è·¯å±‚çš„æºåœ°å€å’Œç›®çš„åœ°å€ï¼Œå³ç½‘ç»œç›¸é‚»ç»“ç‚¹é—´çš„æº MAC åœ°å€å’Œç›®çš„ MAC åœ°å€</p><ol start="6"><li><p><strong>æ•°æ®é“¾è·¯å±‚çš„å¸§(Frame)è½¬æ¢æˆäºŒè¿›åˆ¶å½¢å¼çš„æ¯”ç‰¹(Bit)æµï¼Œä»ç½‘å¡å‘é€å‡ºå»ï¼Œå†æŠŠæ¯”ç‰¹è½¬æ¢æˆç”µå­ã€å…‰å­¦æˆ–å¾®æ³¢ä¿¡å·åœ¨ç½‘ç»œä¸­ä¼ è¾“</strong><br>å…‰çº¤ï¼Œç”µç¼†å•¥çš„è¿™æ—¶å€™å°±æ´¾ä¸Šç”¨åœºå•¦</p></li><li><p><strong>æœåŠ¡å™¨å¤„ç†</strong><br>é€šä¿—æ¥è¯´ï¼Œå°±æ˜¯å…ˆå¼„æ¸…æ¥šæµè§ˆå™¨éœ€è¦ä»€ä¹ˆï¼Œç„¶åæ‰¾åˆ°ç›¸å…³æ•°æ®ï¼Œç„¶åå°è£…è¿™äº›æ•°æ®ï¼Œç„¶åå‡†å¤‡ä¼ å›å»ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥äº†ç™¾åº¦çš„ç½‘å€<br><a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a><br>é‚£ä¹ˆè¿™é‡ŒæœåŠ¡å™¨å°±ä¼šæŠŠç™¾åº¦çš„é¦–é¡µçš„ html ç»™æµè§ˆå™¨ä¼ è¿‡å»</p></li><li><p><strong>æœåŠ¡å™¨å¤„ç†å®Œäº‹ï¼Œç»™æµè§ˆå™¨ä¼ å›å»ï¼Œè·Ÿä¼ è¿‡æ¥çš„æ—¶å€™å·®ä¸å¤š</strong></p></li><li><p><strong>æµè§ˆå™¨æ¸²æŸ“</strong><br>è¿™æ—¶å€™ä½ çš„ç”µè„‘å°±æ¥æ”¶åˆ°äº†æœåŠ¡å™¨ä¼ è¿‡æ¥çš„æ•°æ®ï¼Œç„¶åç»è¿‡å¤„ç†ï¼Œå‡†å¤‡æ¸²æŸ“ï¼Œè¿™ä¸ªè¿‡ç¨‹é‡Œå‘¢å°±æ˜¯é‡è§äº† html é‡Œé¢éœ€è¦å•¥ï¼Œå°±å‘è¯·æ±‚è·å–å•¥ã€‚<br>æ¯”å¦‚è¯´<br>æµè§ˆå™¨å¼€å§‹è½½å…¥ html ä»£ç ï¼Œå‘ç°<head>æ ‡ç­¾å†…æœ‰ä¸€ä¸ª<link>æ ‡ç­¾å¼•ç”¨å¤–éƒ¨ CSS æ–‡ä»¶<br>æµè§ˆå™¨åˆå‘å‡º CSS æ–‡ä»¶çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›è¿™ä¸ª CSS æ–‡ä»¶<br>æµè§ˆå™¨ç»§ç»­è½½å…¥ html ä¸­<body>éƒ¨åˆ†çš„ä»£ç ï¼Œå¹¶ä¸” CSS æ–‡ä»¶å·²ç»æ‹¿åˆ°æ‰‹äº†ï¼Œå¯ä»¥å¼€å§‹æ¸²æŸ“é¡µé¢äº†<br>æµè§ˆå™¨åœ¨ä»£ç ä¸­å‘ç°ä¸€ä¸ª<img>æ ‡ç­¾å¼•ç”¨äº†ä¸€å¼ å›¾ç‰‡ï¼Œå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚æ­¤æ—¶æµè§ˆå™¨ä¸ä¼šç­‰åˆ°å›¾ç‰‡ä¸‹è½½å®Œï¼Œè€Œæ˜¯ç»§ç»­æ¸²æŸ“åé¢çš„ä»£ç ã€‚<br>æœåŠ¡å™¨è¿”å›å›¾ç‰‡æ–‡ä»¶ï¼Œç”±äºå›¾ç‰‡å ç”¨äº†ä¸€å®šé¢ç§¯ï¼Œå½±å“äº†åé¢æ®µè½çš„æ’å¸ƒï¼Œå› æ­¤æµè§ˆå™¨éœ€è¦å›è¿‡å¤´æ¥é‡æ–°æ¸²æŸ“è¿™éƒ¨åˆ†ä»£ç ã€‚<br>æµè§ˆå™¨å‘ç°äº†ä¸€ä¸ªåŒ…å«ä¸€è¡Œ Javascript ä»£ç çš„ script æ ‡ç­¾ï¼Œèµ¶å¿«è¿è¡Œå®ƒã€‚<br>Javascript è„šæœ¬æ‰§è¡Œäº†è¿™æ¡è¯­å¥ï¼Œå®ƒå‘½ä»¤æµè§ˆå™¨éšè—æ‰ä»£ç ä¸­çš„æŸä¸ª styleï¼ˆstyle.display=â€noneâ€ï¼‰ã€‚æ¯å…·å•Šï¼Œçªç„¶å°±å°‘äº†è¿™ä¹ˆä¸€ä¸ªå…ƒç´ ï¼Œæµè§ˆå™¨ä¸å¾—ä¸é‡æ–°æ¸²æŸ“è¿™éƒ¨åˆ†ä»£ç ã€‚<br>å°±è¿™æ ·ï¼Œæµè§ˆå™¨å­å‘²ç˜ªè‚šçš„ç»ˆäºæŠŠé¡µé¢é¼“æ£å‡ºæ¥äº†ï¼</p></li></ol><p>è¿™å°±æ˜¯æ•´ä¸ªè¿‡ç¨‹å•¦ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¹ˆå›äº‹ï½</p><p><strong>é¡µé¢æ¸²æŸ“éœ€è¦åšè¿™äº›äº‹</strong></p><ul><li>è§£æ htmlï¼Œåˆ›å»º dom æ ‘</li><li>è§£æ css ï¼Œ ç»™é¡µé¢ç¾å®¹</li><li>è§£æ js ï¼Œç»™é¡µé¢äº¤äº’å“åº”</li></ul><h3 id="ext-é‡ç»˜å’Œå›æµ"><a href="#ext-é‡ç»˜å’Œå›æµ" class="headerlink" title="ext é‡ç»˜å’Œå›æµ"></a>ext é‡ç»˜å’Œå›æµ</h3><h4 id="å›æµ"><a href="#å›æµ" class="headerlink" title="å›æµ"></a>å›æµ</h4><p>å›æµæ˜¯æŒ‡çª—å£å°ºå¯¸è¢«ä¿®æ”¹ã€å‘ç”Ÿæ»šåŠ¨æ“ä½œï¼Œæˆ–è€…å…ƒç´ ä½ç½®ç›¸å…³å±æ€§è¢«æ›´æ–°æ—¶ä¼šè§¦å‘å¸ƒå±€è¿‡ç¨‹ï¼Œåœ¨å¸ƒå±€è¿‡ç¨‹ä¸­è¦è®¡ç®—æ‰€æœ‰å…ƒç´ çš„ä½ç½®ä¿¡æ¯ã€‚<br>ï¼ˆå°ºå¯¸é•¿å®½é«˜æ”¹å˜ï¼Œæ˜¾éšå°±ä¼šå›æµå•¦ï¼‰<br>ç”±äº HTML ä½¿ç”¨çš„æ˜¯æµå¼å¸ƒå±€ï¼Œå¦‚æœé¡µé¢ä¸­çš„ä¸€ä¸ªå…ƒç´ çš„å°ºå¯¸å‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™å…¶åç»­çš„å…ƒç´ ä½ç½®éƒ½è¦è·Ÿç€å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿå°±æ˜¯é‡æ–°è¿›è¡Œæµå¼å¸ƒå±€çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è¢«ç§°ä¹‹ä¸ºå›æµ</p><h4 id="é‡ç»˜"><a href="#é‡ç»˜" class="headerlink" title="é‡ç»˜"></a>é‡ç»˜</h4><p>é‡ç»˜æ˜¯æŒ‡å½“ä¸è§†è§‰ç›¸å…³çš„æ ·å¼å±æ€§å€¼è¢«æ›´æ–°æ—¶ä¼šè§¦å‘ç»˜åˆ¶è¿‡ç¨‹ï¼Œåœ¨ç»˜åˆ¶è¿‡ç¨‹ä¸­è¦é‡æ–°è®¡ç®—å…ƒç´ çš„è§†è§‰ä¿¡æ¯ï¼Œä½¿å…ƒç´ å‘ˆç°æ–°çš„å¤–è§‚<br>å½“ä¸€äº›å…ƒç´ éœ€è¦æ›´æ–°å±æ€§ï¼Œè€Œè¿™äº›å±æ€§åªæ˜¯å½±å“å…ƒç´ çš„å¤–è§‚ï¼Œé£æ ¼ï¼Œè€Œä¸ä¼šå½±å“å¸ƒå±€çš„ï¼Œæ¯”å¦‚ background-colorã€‚åˆ™å°±å«ç§°ä¸ºé‡ç»˜ã€‚</p><p>å›æµä¸€å®šé‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šå›æµã€‚<br>åªæœ‰é¢œè‰²æ”¹å˜çš„æ—¶å€™å°±åªä¼šå‘ç”Ÿé‡ç»˜è€Œä¸ä¼šå¼•èµ·å›æµ<br>å½“é¡µé¢å¸ƒå±€å’Œå‡ ä½•å±æ€§æ”¹å˜æ—¶å°±éœ€è¦å›æµ<br>æ¯”å¦‚ï¼šæ·»åŠ æˆ–è€…åˆ é™¤å¯è§çš„ DOM å…ƒç´ ï¼Œå…ƒç´ ä½ç½®æ”¹å˜ï¼Œå…ƒç´ å°ºå¯¸æ”¹å˜â€”â€”è¾¹è·ã€å¡«å……ã€è¾¹æ¡†ã€å®½åº¦å’Œé«˜åº¦ï¼Œå†…å®¹æ”¹å˜</p><p>ä¸‹é¢åˆ—ä¸¾ä¸€äº›å‡å°‘å›æµæ¬¡æ•°çš„æ–¹æ³•ï¼ˆæ¥è‡ªç™¾åº¦ï¼‰</p><p>ï¼ˆ1ï¼‰ä¸è¦ä¸€æ¡ä¸€æ¡åœ°ä¿®æ”¹ DOM æ ·å¼ï¼Œè€Œæ˜¯ä¿®æ”¹ className æˆ–è€…ä¿®æ”¹ style.cssText</p><p>ï¼ˆ2ï¼‰åœ¨å†…å­˜ä¸­å¤šæ¬¡æ“ä½œèŠ‚ç‚¹ï¼Œå®Œæˆåå†æ·»åŠ åˆ°æ–‡æ¡£ä¸­å»</p><p>ï¼ˆ3ï¼‰å¯¹äºä¸€ä¸ªå…ƒç´ è¿›è¡Œå¤æ‚çš„æ“ä½œæ—¶ï¼Œå¯ä»¥å…ˆéšè—å®ƒï¼Œæ“ä½œå®Œæˆåå†æ˜¾ç¤º</p><p>ï¼ˆ4ï¼‰åœ¨éœ€è¦ç»å¸¸è·å–é‚£äº›å¼•èµ·æµè§ˆå™¨å›æµçš„å±æ€§å€¼æ—¶ï¼Œè¦ç¼“å­˜åˆ°å˜é‡ä¸­</p><p>ï¼ˆ5ï¼‰ä¸è¦ä½¿ç”¨ table å¸ƒå±€ï¼Œå› ä¸ºä¸€ä¸ªå°æ”¹åŠ¨å¯èƒ½ä¼šé€ æˆæ•´ä¸ª table é‡æ–°å¸ƒå±€ã€‚è€Œä¸” table æ¸²æŸ“é€šå¸¸è¦ 3 å€äºåŒç­‰å…ƒç´ æ—¶é—´</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>DNS è§£æ URL åœ°å€</li><li>ç”Ÿæˆ HTTP è¯·æ±‚æŠ¥æ–‡</li><li>æ„å»º TCP è¿æ¥</li><li>ä½¿ç”¨ IP åè®®é€‰æ‹©ä¼ è¾“è·¯çº¿</li><li>æ•°æ®é“¾è·¯å±‚ä¿è¯æ•°æ®çš„å¯é ä¼ è¾“</li><li>ç‰©ç†å±‚å°†æ•°æ®è½¬æ¢æˆç”µå­ã€å…‰å­¦æˆ–å¾®æ³¢ä¿¡å·è¿›è¡Œä¼ è¾“</li><li>æœåŠ¡å™¨å¤„ç†æ•°æ®ï¼Œå¹¶è¿”å›æµè§ˆå™¨æ‰€éœ€èµ„æº</li><li>æµè§ˆå™¨å¤„ç†æ•°æ®</li><li>é¡µé¢æ¸²æŸ“</li></ol>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>http tcp é‡ç»˜å›æµ DNS IP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React åˆæˆäº‹ä»¶</title>
    <link href="/2020/06/17/react-syntheticevent/"/>
    <url>/2020/06/17/react-syntheticevent/</url>
    
    <content type="html"><![CDATA[<p>è¿™ä¸ªä¸æ˜¯å¾ˆé‡è¦ï¼Œè€Œä¸”æƒ³çœŸå¼„æ‡‚ï¼Œå¾—çœ‹æºç ã€‚æˆ‘çœ‹çš„æ˜¯ä¸€å¤´é›¾æ°´ã€‚ä½†æ˜¯å¤§æ¦‚æ€è·¯å¯ä»¥è¡¨è¾¾å‡ºæ¥</p><h3 id="React-åˆæˆäº‹ä»¶ä¸€å¥—æœºåˆ¶ï¼šReact-å¹¶ä¸æ˜¯å°†-click-äº‹ä»¶ç›´æ¥ç»‘å®šåœ¨-dom-ä¸Šé¢ï¼Œè€Œæ˜¯é‡‡ç”¨äº‹ä»¶å†’æ³¡çš„å½¢å¼å†’æ³¡åˆ°-document-ä¸Šé¢ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡è‡³-document-å¤„æ—¶ï¼ŒReact-å°†äº‹ä»¶å†…å®¹å°è£…äº¤ç»™ä¸­é—´å±‚-SyntheticEventï¼ˆè´Ÿè´£æ‰€æœ‰äº‹ä»¶åˆæˆï¼‰ï¼Œç„¶å-React-å°†äº‹ä»¶å°è£…ç»™æ­£å¼çš„å‡½æ•°å¤„ç†è¿è¡Œå’Œå¤„ç†ã€‚"><a href="#React-åˆæˆäº‹ä»¶ä¸€å¥—æœºåˆ¶ï¼šReact-å¹¶ä¸æ˜¯å°†-click-äº‹ä»¶ç›´æ¥ç»‘å®šåœ¨-dom-ä¸Šé¢ï¼Œè€Œæ˜¯é‡‡ç”¨äº‹ä»¶å†’æ³¡çš„å½¢å¼å†’æ³¡åˆ°-document-ä¸Šé¢ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡è‡³-document-å¤„æ—¶ï¼ŒReact-å°†äº‹ä»¶å†…å®¹å°è£…äº¤ç»™ä¸­é—´å±‚-SyntheticEventï¼ˆè´Ÿè´£æ‰€æœ‰äº‹ä»¶åˆæˆï¼‰ï¼Œç„¶å-React-å°†äº‹ä»¶å°è£…ç»™æ­£å¼çš„å‡½æ•°å¤„ç†è¿è¡Œå’Œå¤„ç†ã€‚" class="headerlink" title="React åˆæˆäº‹ä»¶ä¸€å¥—æœºåˆ¶ï¼šReact å¹¶ä¸æ˜¯å°† click äº‹ä»¶ç›´æ¥ç»‘å®šåœ¨ dom ä¸Šé¢ï¼Œè€Œæ˜¯é‡‡ç”¨äº‹ä»¶å†’æ³¡çš„å½¢å¼å†’æ³¡åˆ° document ä¸Šé¢ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡è‡³ document å¤„æ—¶ï¼ŒReact å°†äº‹ä»¶å†…å®¹å°è£…äº¤ç»™ä¸­é—´å±‚ SyntheticEventï¼ˆè´Ÿè´£æ‰€æœ‰äº‹ä»¶åˆæˆï¼‰ï¼Œç„¶å React å°†äº‹ä»¶å°è£…ç»™æ­£å¼çš„å‡½æ•°å¤„ç†è¿è¡Œå’Œå¤„ç†ã€‚"></a>React åˆæˆäº‹ä»¶ä¸€å¥—æœºåˆ¶ï¼šReact å¹¶ä¸æ˜¯å°† click äº‹ä»¶ç›´æ¥ç»‘å®šåœ¨ dom ä¸Šé¢ï¼Œè€Œæ˜¯é‡‡ç”¨äº‹ä»¶å†’æ³¡çš„å½¢å¼å†’æ³¡åˆ° document ä¸Šé¢ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡è‡³ document å¤„æ—¶ï¼ŒReact å°†äº‹ä»¶å†…å®¹å°è£…äº¤ç»™ä¸­é—´å±‚ SyntheticEventï¼ˆè´Ÿè´£æ‰€æœ‰äº‹ä»¶åˆæˆï¼‰ï¼Œç„¶å React å°†äº‹ä»¶å°è£…ç»™æ­£å¼çš„å‡½æ•°å¤„ç†è¿è¡Œå’Œå¤„ç†ã€‚</h3><p>ä¸ºå•¥æœ‰è¿™ç§ react åˆæˆäº‹ä»¶ è¿™ç§ä¸œè¥¿ï¼Ÿ å­˜åœ¨å³åˆç†ã€‚<br>å¦‚æœ dom ä¸Šç»‘å®šäº†ç‰¹åˆ«å¤šçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œé‚£æŒ‡å®šä¼šå¡ã€‚ä¸ºäº†ä¸ä¼šå¡ï¼Œæ‰€ä»¥æœ‰äº†è¿™ä¸ª react åˆæˆäº‹ä»¶ï¼Œå¹¶ä¸”å¯¹æµè§ˆå™¨å…¼å®¹æ€§ï¼Œä¸ç”¨æ‹…å¿ƒ ie çš„å‘äº†ã€‚</p><h3 id="æ³¨æ„ï¼šReact-äº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ€å¥½ä¸è¦æ··ç”¨ã€‚åŸç”Ÿäº‹ä»¶ä¸­å¦‚æœæ‰§è¡Œäº†-stopPropagation-æ–¹æ³•ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»–-React-äº‹ä»¶å¤±æ•ˆã€‚å› ä¸ºæ‰€æœ‰å…ƒç´ çš„äº‹ä»¶å°†æ— æ³•å†’æ³¡åˆ°-document-ä¸Šï¼Œå¯¼è‡´æ‰€æœ‰çš„-React-äº‹ä»¶éƒ½å°†æ— æ³•è¢«è§¦å‘ã€‚"><a href="#æ³¨æ„ï¼šReact-äº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ€å¥½ä¸è¦æ··ç”¨ã€‚åŸç”Ÿäº‹ä»¶ä¸­å¦‚æœæ‰§è¡Œäº†-stopPropagation-æ–¹æ³•ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»–-React-äº‹ä»¶å¤±æ•ˆã€‚å› ä¸ºæ‰€æœ‰å…ƒç´ çš„äº‹ä»¶å°†æ— æ³•å†’æ³¡åˆ°-document-ä¸Šï¼Œå¯¼è‡´æ‰€æœ‰çš„-React-äº‹ä»¶éƒ½å°†æ— æ³•è¢«è§¦å‘ã€‚" class="headerlink" title="æ³¨æ„ï¼šReact äº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ€å¥½ä¸è¦æ··ç”¨ã€‚åŸç”Ÿäº‹ä»¶ä¸­å¦‚æœæ‰§è¡Œäº† stopPropagation æ–¹æ³•ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»– React äº‹ä»¶å¤±æ•ˆã€‚å› ä¸ºæ‰€æœ‰å…ƒç´ çš„äº‹ä»¶å°†æ— æ³•å†’æ³¡åˆ° document ä¸Šï¼Œå¯¼è‡´æ‰€æœ‰çš„ React äº‹ä»¶éƒ½å°†æ— æ³•è¢«è§¦å‘ã€‚"></a>æ³¨æ„ï¼šReact äº‹ä»¶å’ŒåŸç”Ÿäº‹ä»¶æœ€å¥½ä¸è¦æ··ç”¨ã€‚åŸç”Ÿäº‹ä»¶ä¸­å¦‚æœæ‰§è¡Œäº† stopPropagation æ–¹æ³•ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»– React äº‹ä»¶å¤±æ•ˆã€‚å› ä¸ºæ‰€æœ‰å…ƒç´ çš„äº‹ä»¶å°†æ— æ³•å†’æ³¡åˆ° document ä¸Šï¼Œå¯¼è‡´æ‰€æœ‰çš„ React äº‹ä»¶éƒ½å°†æ— æ³•è¢«è§¦å‘ã€‚</h3><p>ä¸‹é¢ç•™ä¸ªé“¾æ¥ï¼Œæ˜¯å¤§ä½¬åˆ†ææºç çš„ä¸œè¥¿ã€‚<br><a href="https://zhuanlan.zhihu.com/p/25883536" target="_blank" rel="noopener">ç‚¹å‡»è·³è½¬</a></p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>reactåˆæˆäº‹ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>event.stopPropagation()å’Œevent.preventDefault()</title>
    <link href="/2020/06/17/stoppropagation-preventDefault/"/>
    <url>/2020/06/17/stoppropagation-preventDefault/</url>
    
    <content type="html"><![CDATA[<h3 id="ç¡¬æ ¸æ•´æ´»ã€‚å°±-3-ä¸ªç©æ„å„¿ï¼š"><a href="#ç¡¬æ ¸æ•´æ´»ã€‚å°±-3-ä¸ªç©æ„å„¿ï¼š" class="headerlink" title="ç¡¬æ ¸æ•´æ´»ã€‚å°± 3 ä¸ªç©æ„å„¿ï¼š"></a>ç¡¬æ ¸æ•´æ´»ã€‚å°± 3 ä¸ªç©æ„å„¿ï¼š</h3><ol><li><p>event.stopPropagation() é˜»æ­¢å†’æ³¡</p></li><li><p>event.preventDefault() é˜»æ­¢é»˜è®¤äº‹ä»¶</p></li><li><p>return false åŒæ—¶é˜»æ­¢å†’æ³¡å’Œé»˜è®¤äº‹ä»¶</p></li></ol><h3 id="é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œèƒ½å’‹æ»´ï¼Ÿ"><a href="#é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œèƒ½å’‹æ»´ï¼Ÿ" class="headerlink" title="é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œèƒ½å’‹æ»´ï¼Ÿ"></a>é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œèƒ½å’‹æ»´ï¼Ÿ</h3><p>el.addEventListener(â€clickâ€œ,function(){console.log(â€˜xxxâ€™)},false) æ¥å—ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªå›è°ƒå‡½æ•°å§ï¼Ÿå‡½æ•°é‡Œæœ‰æ“ä½œå§ï¼Œæœ‰å¹²æ´»å§ï¼Ÿ<br>è¿™ä¸ªé˜»æ­¢å†’æ³¡ï¼Œå°±é˜»æ­¢è¿™ä¸ªå›è°ƒå‡½æ•°å¹²æ´»ã€‚è¯´çš„æ˜¯å†’æ³¡å¥¥ï¼Œæ•è·ä¸é˜»æ­¢çš„å¥¥ã€‚</p><h3 id="é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œèƒ½å’‹æ»´ï¼Ÿ"><a href="#é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œèƒ½å’‹æ»´ï¼Ÿ" class="headerlink" title="é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œèƒ½å’‹æ»´ï¼Ÿ"></a>é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œèƒ½å’‹æ»´ï¼Ÿ</h3><p>é¦–å…ˆä½ å¾—çŸ¥é“å•¥æ˜¯é»˜è®¤äº‹ä»¶ï¼Œä½ çŸ¥ä¸çŸ¥é“ï¼Ÿ<br>ä¸çŸ¥é“æˆ‘å‘Šè¯‰ä½ å‘—ï¼Œåæ­£ä¹Ÿæ˜¯æˆ‘ç™¾åº¦çš„ã€‚èŒä¸šå¤åˆ¶ç²˜è´´å·¥ç¨‹å¸ˆï¼Œç»™ä½ å¤åˆ¶ä¸€ä¸‹ï¼š<br>å°±æ˜¯æµè§ˆå™¨é€šè¿‡ HTML æ ‡ç­¾æˆ– DOM å…ƒç´ æä¾›çš„ä¸€äº›åŠŸèƒ½æ€§çš„é»˜è®¤è¡Œä¸ºã€‚<br>æ¯”å¦‚åœ¨ a æ ‡ç­¾ href å±æ€§ä¸Šçš„è·³è½¬ï¼Œå³é”®å‘¼å‡ºçš„èœå•ï¼Œå½“ä½ åœ¨ä¸€ä¸ª form è¡¨å•é‡Œç‚¹å‡»æäº¤æŒ‰é’®æ—¶ç½‘é¡µä¼šäº§ç”Ÿæäº¤è¡Œä¸ºå¹¶åˆ·æ–°ç½‘é¡µï¼Œå½“ä½ ç½‘é¡µä¸Šæ»šåŠ¨é¼ æ ‡æ»šè½®æ—¶ï¼Œç½‘é¡µçš„æ»šåŠ¨æ¡ä¼šåŠ¨ã€‚<br>é˜»æ­¢é»˜è®¤äº‹ä»¶å°±èƒ½é˜»æ­¢ç±»ä¼¼è¿™äº›äº‹</p><h3 id="åŒæ—¶é˜»æ­¢ï¼Œèƒ½å’‹æ»´ï¼Ÿ"><a href="#åŒæ—¶é˜»æ­¢ï¼Œèƒ½å’‹æ»´ï¼Ÿ" class="headerlink" title="åŒæ—¶é˜»æ­¢ï¼Œèƒ½å’‹æ»´ï¼Ÿ"></a>åŒæ—¶é˜»æ­¢ï¼Œèƒ½å’‹æ»´ï¼Ÿ</h3><p>ä¸èƒ½å’‹æ»´ï¼Œä½  return false ğŸ‚ğŸº</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å°±è¿™ä¸¤è¡Œç©æ„ï¼Œä¸æ€»ç»“äº†å¥¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é˜»æ­¢äº‹ä»¶å†’æ³¡ é˜»æ­¢é»˜è®¤äº‹ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dom0-dom2</title>
    <link href="/2020/06/15/dom0-dom2/"/>
    <url>/2020/06/15/dom0-dom2/</url>
    
    <content type="html"><![CDATA[<h2 id="dom0"><a href="#dom0" class="headerlink" title="dom0"></a>dom0</h2><p>æˆ–è€…å« 0 çº§ dom ï¼Œå¦‚ä¸‹</p><pre><code class="hljs scilab">&lt;input id=<span class="hljs-string">"btn"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"button"</span> onclick=<span class="hljs-string">"console.log('</span>You clicked the button!<span class="hljs-string">');"</span> value=<span class="hljs-string">"Click"</span> /&gt;<span class="hljs-comment">//  æˆ–è€…jså†™æ³•</span>document.getElementById(<span class="hljs-string">'btn'</span>).onclick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> &#123;</span>            console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'ï¼©ã€€am ï½ï½’ï½ï½ƒï½…ï½“ï½“ï½…ï½„ by dom0!'</span>);        &#125;;</code></pre><h3 id="è¿™ç§å†™æ³•ï¼Œåé¢çš„ä»£ç ä¼šè¦†ç›–å‰é¢çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå¤šæ¬¡è¾“å‡ºï¼Œä¹Ÿåªä¼šè¾“å‡ºæœ€åä¸€æ¡ã€‚"><a href="#è¿™ç§å†™æ³•ï¼Œåé¢çš„ä»£ç ä¼šè¦†ç›–å‰é¢çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå¤šæ¬¡è¾“å‡ºï¼Œä¹Ÿåªä¼šè¾“å‡ºæœ€åä¸€æ¡ã€‚" class="headerlink" title="è¿™ç§å†™æ³•ï¼Œåé¢çš„ä»£ç ä¼šè¦†ç›–å‰é¢çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå¤šæ¬¡è¾“å‡ºï¼Œä¹Ÿåªä¼šè¾“å‡ºæœ€åä¸€æ¡ã€‚"></a>è¿™ç§å†™æ³•ï¼Œåé¢çš„ä»£ç ä¼šè¦†ç›–å‰é¢çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå¤šæ¬¡è¾“å‡ºï¼Œä¹Ÿåªä¼šè¾“å‡ºæœ€åä¸€æ¡ã€‚</h3><h2 id="dom2"><a href="#dom2" class="headerlink" title="dom2"></a>dom2</h2><p>æˆ–è€…å« 2 çº§ domï¼Œç»§ç»­å¦‚ä¸‹å‘—</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'input'</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"alert('haha')"</span> /&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">     <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'input'</span>).onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="actionscript">         alert(<span class="hljs-string">'fff'</span>)</span><span class="actionscript">     &#125;; <span class="hljs-comment">// ç›®æ ‡é˜¶æ®µ</span></span><span class="javascript">     <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'input'</span>).addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="actionscript">         alert(<span class="hljs-string">'mmm'</span>)</span><span class="actionscript">     &#125;, <span class="hljs-literal">true</span>)  <span class="hljs-comment">// æ•è·é˜¶æ®µ</span></span><span class="javascript">     <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'input'</span>).addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="actionscript">         alert(<span class="hljs-string">'ooooo'</span>)</span><span class="actionscript">     &#125;, <span class="hljs-literal">true</span>)  <span class="hljs-comment">// æ•è·é˜¶æ®µ</span></span><span class="javascript">     <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'input'</span>).addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="actionscript">         alert(<span class="hljs-string">'pppp'</span>)</span><span class="actionscript">     &#125;, <span class="hljs-literal">false</span>)  <span class="hljs-comment">// å†’æ³¡é˜¶æ®µ</span></span><span class="actionscript">     <span class="hljs-comment">// å…¼å®¹ä½ç‰ˆæœ¬IEçš„å†™æ³•</span></span><span class="javascript">     <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'input'</span>).attachEvent(<span class="hljs-string">"onclick"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="actionscript">         alert(<span class="hljs-string">'pppp'</span>)</span>     &#125;); <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> // mmm ooooo fff pppp</code></pre><p>dom2 æŠŠäº‹æƒ…åˆ†ä¸º 3 æ­¥ â€”â€”â€”â€” äº‹ä»¶æ•è·é˜¶æ®µã€å¤„äºç›®æ ‡é˜¶æ®µå’Œäº‹ä»¶å†’æ³¡é˜¶æ®µ</p><pre><code class="hljs actionscript">addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>&#123;&#125;,<span class="hljs-literal">true</span>/<span class="hljs-literal">false</span>)<span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¡¨æ˜æ˜¯å•¥è§¦å‘äº‹ä»¶</span><span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼Œäº‹ä»¶è§¦å‘ä»¥åçš„å›è°ƒå‡½æ•°</span><span class="hljs-comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œtrueæˆ–è€…false ï¼Œtrueæ˜¯ç¬¬äºŒä¸ªå‚æ•°é‚£ä¸ªå›è°ƒå‡½æ•°åœ¨æ•è·é˜¶æ®µè°ƒç”¨ ï¼Œfalseåœ¨å†’æ³¡é˜¶æ®µ ï¼Œé»˜è®¤æ˜¯false</span><span class="hljs-comment">// 2015å¹´åº•ï¼Œæ‰©å±•äº†ç¬¬ä¸‰ä¸ªå‚æ•°</span>el.addEventListener(type, listener, &#123;    capture: <span class="hljs-literal">false</span>, <span class="hljs-comment">// useCapture</span>    once: <span class="hljs-literal">false</span>,    <span class="hljs-comment">// æ˜¯å¦è®¾ç½®å•æ¬¡ç›‘å¬</span>    passive: <span class="hljs-literal">false</span>  <span class="hljs-comment">// æ˜¯å¦è®©é˜»æ­¢é»˜è®¤è¡Œä¸ºpreventDefault()å¤±æ•ˆ</span>    <span class="hljs-comment">//  ç”±äº touchmove äº‹ä»¶å¯¹è±¡çš„ cancelable å±æ€§ä¸º trueï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„é»˜è®¤è¡Œä¸ºå¯ä»¥è¢«ç›‘å¬å™¨é€šè¿‡ preventDefault() æ–¹æ³•é˜»æ­¢ã€‚é‚£å®ƒçš„é»˜è®¤è¡Œä¸ºæ˜¯ä»€ä¹ˆå‘¢ï¼Œé€šå¸¸æ¥è¯´å°±æ˜¯æ»šåŠ¨å½“å‰é¡µé¢ï¼ˆè¿˜å¯èƒ½æ˜¯ç¼©æ”¾é¡µé¢ï¼‰ï¼Œå¦‚æœå®ƒçš„é»˜è®¤è¡Œä¸ºè¢«é˜»æ­¢äº†ï¼Œé¡µé¢å°±å¿…é¡»é™æ­¢ä¸åŠ¨ã€‚ä½†æµè§ˆå™¨æ— æ³•é¢„å…ˆçŸ¥é“ä¸€ä¸ªç›‘å¬å™¨ä¼šä¸ä¼šè°ƒç”¨ preventDefault()ï¼Œå®ƒèƒ½åšçš„åªæœ‰ç­‰ç›‘å¬å™¨æ‰§è¡Œå®Œåå†å»æ‰§è¡Œé»˜è®¤è¡Œä¸ºï¼Œè€Œç›‘å¬å™¨æ‰§è¡Œæ˜¯è¦è€—æ—¶çš„ï¼Œæœ‰äº›ç”šè‡³è€—æ—¶å¾ˆæ˜æ˜¾ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´é¡µé¢å¡é¡¿ã€‚å³ä¾¿ç›‘å¬å™¨æ˜¯ä¸ªç©ºå‡½æ•°ï¼Œä¹Ÿä¼šäº§ç”Ÿä¸€å®šçš„å¡é¡¿ï¼Œæ¯•ç«Ÿç©ºå‡½æ•°çš„æ‰§è¡Œä¹Ÿä¼šè€—æ—¶ã€‚å½“è®¾ç½®äº†passiveä¸ºtrueï¼Œåˆ™ä¼šå¿½ç•¥ä»£ç ä¸­çš„preventDefault(), å› æ­¤é¡µé¢ä¼šå˜å¾—æ›´æµç•…</span>&#125;)</code></pre><p>window =&gt; document =&gt; body =&gt; div æ•è·</p><p>div =&gt; body =&gt; document =&gt; window å†’æ³¡</p><h3 id="è¿™ç§å†™æ³•ï¼Œä¸ä¼šè¦†ç›–ï¼Œä¼šä¾æ¬¡è¾“å‡ºæ‰€æœ‰é¡¹"><a href="#è¿™ç§å†™æ³•ï¼Œä¸ä¼šè¦†ç›–ï¼Œä¼šä¾æ¬¡è¾“å‡ºæ‰€æœ‰é¡¹" class="headerlink" title="è¿™ç§å†™æ³•ï¼Œä¸ä¼šè¦†ç›–ï¼Œä¼šä¾æ¬¡è¾“å‡ºæ‰€æœ‰é¡¹"></a>è¿™ç§å†™æ³•ï¼Œä¸ä¼šè¦†ç›–ï¼Œä¼šä¾æ¬¡è¾“å‡ºæ‰€æœ‰é¡¹</h3><p>é¡ºä¾¿æä¸€å˜´ dom3 ï¼Œå¢åŠ äº†æ›´å¤šçš„äº‹ä»¶ç±»å‹ï¼Œæ¯”å¦‚ï¼š<br>       DOM3 çº§äº‹ä»¶åœ¨ DOM2 çº§äº‹ä»¶çš„åŸºç¡€ä¸Šæ·»åŠ äº†æ›´å¤šçš„äº‹ä»¶ç±»å‹ï¼Œå…¨éƒ¨ç±»å‹å¦‚ä¸‹ï¼š</p><p>UI äº‹ä»¶ï¼Œå½“ç”¨æˆ·ä¸é¡µé¢ä¸Šçš„å…ƒç´ äº¤äº’æ—¶è§¦å‘ï¼Œå¦‚ï¼šloadã€scroll</p><p>ç„¦ç‚¹äº‹ä»¶ï¼Œå½“å…ƒç´ è·å¾—æˆ–å¤±å»ç„¦ç‚¹æ—¶è§¦å‘ï¼Œå¦‚ï¼šblurã€focus</p><p>é¼ æ ‡äº‹ä»¶ï¼Œå½“ç”¨æˆ·é€šè¿‡é¼ æ ‡åœ¨é¡µé¢æ‰§è¡Œæ“ä½œæ—¶è§¦å‘å¦‚ï¼šdbclickã€mouseup</p><p>æ»šè½®äº‹ä»¶ï¼Œå½“ä½¿ç”¨é¼ æ ‡æ»šè½®æˆ–ç±»ä¼¼è®¾å¤‡æ—¶è§¦å‘ï¼Œå¦‚ï¼šmousewheel</p><p>æ–‡æœ¬äº‹ä»¶ï¼Œå½“åœ¨æ–‡æ¡£ä¸­è¾“å…¥æ–‡æœ¬æ—¶è§¦å‘ï¼Œå¦‚ï¼štextInput</p><p>é”®ç›˜äº‹ä»¶ï¼Œå½“ç”¨æˆ·é€šè¿‡é”®ç›˜åœ¨é¡µé¢ä¸Šæ‰§è¡Œæ“ä½œæ—¶è§¦å‘ï¼Œå¦‚ï¼škeydownã€keypress</p><p>åˆæˆäº‹ä»¶ï¼Œå½“ä¸º IMEï¼ˆè¾“å…¥æ³•ç¼–è¾‘å™¨ï¼‰è¾“å…¥å­—ç¬¦æ—¶è§¦å‘ï¼Œå¦‚ï¼šcompositionstart</p><p>å˜åŠ¨äº‹ä»¶ï¼Œå½“åº•å±‚ DOM ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼Œå¦‚ï¼šDOMsubtreeModified</p><p>åŒæ—¶ DOM3 çº§äº‹ä»¶ä¹Ÿå…è®¸ä½¿ç”¨è€…è‡ªå®šä¹‰ä¸€äº›äº‹ä»¶ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åŒºåˆ«ï¼šdom0 ä¼šè¦†ç›–ï¼Œdom2 ä¸ä¼šè¦†ç›–ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>dom0 dom2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSé«˜é˜¶å‡½æ•°</title>
    <link href="/2020/06/15/higher-order-function/"/>
    <url>/2020/06/15/higher-order-function/</url>
    
    <content type="html"><![CDATA[<h2 id="å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‚æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå°±å«åšé«˜é˜¶å‡½æ•°ã€‚"><a href="#å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‚æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå°±å«åšé«˜é˜¶å‡½æ•°ã€‚" class="headerlink" title="å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‚æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå°±å«åšé«˜é˜¶å‡½æ•°ã€‚"></a>å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‚æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå°±å«åšé«˜é˜¶å‡½æ•°ã€‚</h2><h3 id="å¸¸è§é«˜é˜¶å‡½æ•°"><a href="#å¸¸è§é«˜é˜¶å‡½æ•°" class="headerlink" title="å¸¸è§é«˜é˜¶å‡½æ•°"></a>å¸¸è§é«˜é˜¶å‡½æ•°</h3><ol><li>Array.prototype.map,</li><li>Array.prototype.filter,</li><li>Array.prototype.reduce,</li></ol><p>æ—¢ç„¶æåˆ°äº†è¿™å‡ ä¸ªæ•°ç»„æ–¹æ³•ï¼Œé‚£ä¹Ÿå°±é¡ºä¾¿è¯´ä¸€è¯´å“ˆ</p><ul><li>map æ˜¯å•¥ï¼Œå°±ä¸åœ¨è¿™é‡Œè¯´äº†ï¼Œä¸çŸ¥é“å°±ç™¾åº¦å»ã€‚map() æ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥å— 3 ä¸ªå‚æ•°ã€‚ item index arraySelf ã€‚ item æ˜¯æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´  ï¼Œindex æ˜¯è¯¥å…ƒç´ çš„ä¸‹æ ‡ï¼ˆæ•°ç»„ä¸­çš„ç¬¬å‡ ä¸ªå…ƒç´ ï¼‰ï¼ŒarraySelf æ˜¯è°ƒç”¨ map æ–¹æ³•çš„è¿™ä¸ªæ•°ç»„ï¼Œå½“ç„¶äº†ï¼Œè¿™äº›å‚æ•°ä¸æ˜¯å›ºå®šå« itemï¼Œindex å•¥çš„ï¼Œè¿™æ˜¯å…¥å‚ï¼Œå«å•¥éƒ½è¡Œï¼Œä½ç½®å¯¹çš„ä¸Šç›¸åº”çš„ä½ç½®å°±è¡Œã€‚æ¯”å¦‚ï¼š</li></ul><pre><code class="hljs stata">[1,2,3].map((<span class="hljs-keyword">one</span>,<span class="hljs-keyword">two</span>,three)=&gt;&#123;  <span class="hljs-comment">// è¿™é‡Œçš„oneå°±å¯¹åº”ä¸Šé¢æˆ‘è¯´çš„item ï¼Œtwoå°±æ˜¯indexï¼Œè¿™æ ·è¯´å°±èƒ½æ˜ç™½å§ï¼Ÿ</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">one</span> + <span class="hljs-keyword">two</span> + three.length&#125;)</code></pre><p>map æœ‰è¿”å›å€¼ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œè€Œç±»ä¼¼çš„ forEachï¼ˆï¼‰æ–¹æ³•ï¼Œå°±æ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥å“Ÿï¼Œç”¨ forEach çš„æ—¶å€™ç»å¸¸ä¼šæ­é… Array.push() ğŸ˜ è¿˜æœ‰å•Šï¼Œå†™ jsx çš„æ—¶å€™ï¼Œmap éå†å‡ºæ¥çš„ç©æ„ä½ å¾—åŠ ä¸ª key å€¼ï¼Œé€šå¸¸å¯ä»¥æ˜¯ indexï¼Œæ¯”å¦‚å“ˆï¼Œæˆ‘ä¸¾ä¸ªæ —å­ ğŸŒ°</p><pre><code class="hljs javascript">&lt;ul&gt;[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].map(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> &#123;  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span> = <span class="hljs-string">&#123;index&#125;</span> <span class="hljs-attr">value</span> = <span class="hljs-string">&#123;item&#125;</span> &gt;</span>item<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>&#125;)&lt;<span class="hljs-regexp">/ul&gt;</span></code></pre><p>è¿™ç©æ„å†™çš„å¥½åƒæœ‰ç‚¹å¤šä½™ã€‚ã€‚ã€‚å¥½åƒä¼š map çš„éƒ½èƒ½çŸ¥é“ï¼Œä¸ä¼š map çœ‹äº†æˆ‘è¿™ä¹Ÿçœ‹ä¸æ‡‚ã€‚ğŸ˜‚</p><pre><code class="hljs angelscript">[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].filter(item=&gt;item &gt; <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].reduce((x,y)=&gt;&#123;<span class="hljs-keyword">return</span> x + y&#125;)</code></pre><p>react-redux</p><p>connect æ–¹æ³• å˜»å˜» å¼„ä¸€æ³¢è¿™ä¸ªï½</p><p>connect æ–¹æ³•åšçš„äº‹æƒ…æ˜¯å°† state å’Œ dispatch ç»‘å®šåˆ° Connect ç»„ä»¶çš„å‚æ•°ä¸Šï¼Œç„¶å Connect ç»„ä»¶å°†ä½ å½“å‰çš„ App ç»„ä»¶å°è£…èµ·æ¥ï¼Œä½¿å¾— App ç»„ä»¶å¯ä»¥é€šè¿‡ props è·å–åˆ°çˆ¶ç»„ä»¶ Connect ä¼ é€’çš„ state å’Œ propsã€‚</p><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥åœ¨è‡ªå·±å†™çš„ç»„ä»¶ä¸Šé¢ç›´æ¥é€šè¿‡ this.props è®¿é—®åˆ° state å’Œ actionã€‚æœ‰çš„äººæ˜¯é€šè¿‡ store å»è¯»å– state å’Œ dispatch actionï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ã€‚</p><p>ä» connect æ–¹æ³•çš„å®ç°ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†éå¸¸å¤š react ç»„ä»¶çš„å½±å­ï¼Œç”Ÿå‘½å‘¨æœŸï¼Œprops ä¼ é€’ï¼Œcontext ä¸Šä¸‹æ–‡ã€‚</p><p>å¯¹æ¯” Provider ç»„ä»¶ï¼š</p><p>Provider æ˜¯é¡¶å±‚ç»„ä»¶çš„ä½œç”¨ï¼Œå°† store ä½œä¸ºä¸Šä¸‹æ–‡æä¾›ç»™å…¨å±€å…±äº«ï¼Œè€Œ Connect ç»„ä»¶æ˜¯å±€éƒ¨ç»„ä»¶ï¼Œå°†æŸä¸ª react ç»„ä»¶åŒ…è£…èµ·æ¥ï¼Œä¼ é€’æŒ‡å®šçš„ state å’Œ props ç»™è¯¥ç»„ä»¶è®¿é—®ã€‚</p><h3 id="éå¸¸é—æ†¾ï¼Œæˆ‘æ²¡æœ‰å½»åº•çœ‹æ‡‚-connect-çš„æºç ï¼Œæ‰€ä»¥æš‚æ—¶ä¸å†™ä»€ä¹ˆæ„Ÿæƒ³äº†ï¼Œç•™ä¸ªé“¾æ¥åç»­å†è¯•è¯•ç»§ç»­ç†è§£"><a href="#éå¸¸é—æ†¾ï¼Œæˆ‘æ²¡æœ‰å½»åº•çœ‹æ‡‚-connect-çš„æºç ï¼Œæ‰€ä»¥æš‚æ—¶ä¸å†™ä»€ä¹ˆæ„Ÿæƒ³äº†ï¼Œç•™ä¸ªé“¾æ¥åç»­å†è¯•è¯•ç»§ç»­ç†è§£" class="headerlink" title="éå¸¸é—æ†¾ï¼Œæˆ‘æ²¡æœ‰å½»åº•çœ‹æ‡‚ connect çš„æºç ï¼Œæ‰€ä»¥æš‚æ—¶ä¸å†™ä»€ä¹ˆæ„Ÿæƒ³äº†ï¼Œç•™ä¸ªé“¾æ¥åç»­å†è¯•è¯•ç»§ç»­ç†è§£"></a>éå¸¸é—æ†¾ï¼Œæˆ‘æ²¡æœ‰å½»åº•çœ‹æ‡‚ connect çš„æºç ï¼Œæ‰€ä»¥æš‚æ—¶ä¸å†™ä»€ä¹ˆæ„Ÿæƒ³äº†ï¼Œç•™ä¸ªé“¾æ¥åç»­å†è¯•è¯•ç»§ç»­ç†è§£</h3><p><a href="https://www.cnblogs.com/williamjie/p/9591826.html" target="_blank" rel="noopener">è¿™æ˜¯åˆ«äººåšå®¢ï¼Œconnect è§£ææºç çš„</a></p><h4 id="å‘ç°äº†å¦ä¸€ä¸ªåšå®¢ï¼Œç®€åŒ–ç‰ˆçš„ï¼Œå¤§æ¦‚çš„é€»è¾‘å°±çœ‹æ‡‚äº†ï¼Œä½†æ˜¯é‚£ä¸ª-480-è¡Œçš„æºç è¿˜æ˜¯ä¸æ˜ç™½å…·ä½“å’‹å›äº‹ã€‚"><a href="#å‘ç°äº†å¦ä¸€ä¸ªåšå®¢ï¼Œç®€åŒ–ç‰ˆçš„ï¼Œå¤§æ¦‚çš„é€»è¾‘å°±çœ‹æ‡‚äº†ï¼Œä½†æ˜¯é‚£ä¸ª-480-è¡Œçš„æºç è¿˜æ˜¯ä¸æ˜ç™½å…·ä½“å’‹å›äº‹ã€‚" class="headerlink" title="å‘ç°äº†å¦ä¸€ä¸ªåšå®¢ï¼Œç®€åŒ–ç‰ˆçš„ï¼Œå¤§æ¦‚çš„é€»è¾‘å°±çœ‹æ‡‚äº†ï¼Œä½†æ˜¯é‚£ä¸ª 480 è¡Œçš„æºç è¿˜æ˜¯ä¸æ˜ç™½å…·ä½“å’‹å›äº‹ã€‚"></a>å‘ç°äº†å¦ä¸€ä¸ªåšå®¢ï¼Œç®€åŒ–ç‰ˆçš„ï¼Œå¤§æ¦‚çš„é€»è¾‘å°±çœ‹æ‡‚äº†ï¼Œä½†æ˜¯é‚£ä¸ª 480 è¡Œçš„æºç è¿˜æ˜¯ä¸æ˜ç™½å…·ä½“å’‹å›äº‹ã€‚</h4><pre><code class="hljs kotlin">export <span class="hljs-keyword">default</span> function connect(mapStateToProps, mapDispatchToProps, mergeProps, options = &#123;&#125;) &#123;<span class="hljs-keyword">return</span> function wrapWithConnect(WrappedComponent) &#123;  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Connect</span> <span class="hljs-title">extends</span> <span class="hljs-title">Component</span> </span>&#123;    <span class="hljs-keyword">constructor</span>(props, context) &#123;      <span class="hljs-comment">// ä»ç¥–å…ˆComponentå¤„è·å¾—store</span>      <span class="hljs-keyword">this</span>.store = props.store || context.store      <span class="hljs-keyword">this</span>.stateProps = computeStateProps(<span class="hljs-keyword">this</span>.store, props)      <span class="hljs-keyword">this</span>.dispatchProps = computeDispatchProps(<span class="hljs-keyword">this</span>.store, props)      <span class="hljs-keyword">this</span>.state = &#123; storeState: <span class="hljs-literal">null</span> &#125;      <span class="hljs-comment">// å¯¹statePropsã€dispatchPropsã€parentPropsè¿›è¡Œåˆå¹¶</span>      <span class="hljs-keyword">this</span>.updateState()    &#125;    shouldComponentUpdate(nextProps, nextState) &#123;      <span class="hljs-comment">// è¿›è¡Œåˆ¤æ–­ï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒComponenté‡æ–°æ¸²æŸ“</span>      <span class="hljs-keyword">if</span> (propsChanged || mapStateProducedChange || dispatchPropsChanged) &#123;        <span class="hljs-keyword">this</span>.updateState(nextProps)          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>        &#125;      &#125;      componentDidMount() &#123;        <span class="hljs-comment">// æ”¹å˜Componentçš„state</span>        <span class="hljs-keyword">this</span>.store.subscribe(() = &#123;          <span class="hljs-keyword">this</span>.setState(&#123;            storeState: <span class="hljs-keyword">this</span>.store.getState()          &#125;)        &#125;)      &#125;      render() &#123;        <span class="hljs-comment">// ç”ŸæˆåŒ…è£¹ç»„ä»¶Connect</span>        <span class="hljs-keyword">return</span> (          &lt;WrappedComponent &#123;...<span class="hljs-keyword">this</span>.nextState&#125; /&gt;        )      &#125;    &#125;    Connect.contextTypes = &#123;      store: storeShape    &#125;    <span class="hljs-keyword">return</span> Connect;  &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é«˜é˜¶å‡½æ•° react-redux connect</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯è·¯ç”±</title>
    <link href="/2020/06/11/router-hash-history/"/>
    <url>/2020/06/11/router-hash-history/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±ï¼Ÿ</h2><p>è·¯ç”±çš„æ¦‚å¿µæ¥æºäºæœåŠ¡ç«¯ï¼Œåœ¨æœåŠ¡ç«¯ä¸­è·¯ç”±æè¿°çš„æ˜¯ URL ä¸å¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p><p>åœ¨ Web å‰ç«¯å•é¡µåº”ç”¨ SPA(Single Page Application)ä¸­ï¼Œè·¯ç”±æè¿°çš„æ˜¯ URL ä¸ UI ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œè¿™ç§æ˜ å°„æ˜¯å•å‘çš„ï¼Œå³ URL å˜åŒ–å¼•èµ· UI æ›´æ–°ï¼ˆæ— éœ€åˆ·æ–°é¡µé¢ï¼‰ã€‚</p><h2 id="å¦‚ä½•å®ç°å‰ç«¯è·¯ç”±ï¼Ÿ"><a href="#å¦‚ä½•å®ç°å‰ç«¯è·¯ç”±ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®ç°å‰ç«¯è·¯ç”±ï¼Ÿ"></a>å¦‚ä½•å®ç°å‰ç«¯è·¯ç”±ï¼Ÿ</h2><p>è¦å®ç°å‰ç«¯è·¯ç”±ï¼Œéœ€è¦è§£å†³ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p><p>1.å¦‚ä½•æ”¹å˜ URL å´ä¸å¼•èµ·é¡µé¢åˆ·æ–°ï¼Ÿ 2.å¦‚ä½•æ£€æµ‹ URL å˜åŒ–äº†ï¼Ÿ</p><h3 id="hash-å®ç°"><a href="#hash-å®ç°" class="headerlink" title="hash å®ç°"></a>hash å®ç°</h3><p>hash æ˜¯ URL ä¸­ hash (#) åŠåé¢çš„é‚£éƒ¨åˆ†ï¼Œå¸¸ç”¨ä½œé”šç‚¹åœ¨é¡µé¢å†…è¿›è¡Œå¯¼èˆªï¼Œæ”¹å˜ URL ä¸­çš„ hash éƒ¨åˆ†ä¸ä¼šå¼•èµ·é¡µé¢åˆ·æ–°<br>é€šè¿‡ hashchange äº‹ä»¶ç›‘å¬ URL çš„å˜åŒ–ï¼Œæ”¹å˜ URL çš„æ–¹å¼åªæœ‰è¿™å‡ ç§ï¼šé€šè¿‡æµè§ˆå™¨å‰è¿›åé€€æ”¹å˜ URLã€é€šè¿‡æ ‡ç­¾æ”¹å˜ URLã€é€šè¿‡ window.location æ”¹å˜ URLï¼Œè¿™å‡ ç§æƒ…å†µæ”¹å˜ URL éƒ½ä¼šè§¦å‘ hashchange äº‹ä»¶</p><h3 id="history-å®ç°"><a href="#history-å®ç°" class="headerlink" title="history å®ç°"></a>history å®ç°</h3><p>history æä¾›äº† pushState å’Œ replaceState ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æ”¹å˜ URL çš„ path éƒ¨åˆ†ä¸ä¼šå¼•èµ·é¡µé¢åˆ·æ–°<br>history æä¾›ç±»ä¼¼ hashchange äº‹ä»¶çš„ popstate äº‹ä»¶ï¼Œä½† popstate äº‹ä»¶æœ‰äº›ä¸åŒï¼šé€šè¿‡æµè§ˆå™¨å‰è¿›åé€€æ”¹å˜ URL æ—¶ä¼šè§¦å‘ popstate äº‹ä»¶ï¼Œé€šè¿‡ pushState/replaceState æˆ–æ ‡ç­¾æ”¹å˜ URL ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ã€‚å¥½åœ¨æˆ‘ä»¬å¯ä»¥æ‹¦æˆª pushState/replaceState çš„è°ƒç”¨å’Œæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶æ¥æ£€æµ‹ URL å˜åŒ–ï¼Œæ‰€ä»¥ç›‘å¬ URL å˜åŒ–å¯ä»¥å®ç°ï¼Œåªæ˜¯æ²¡æœ‰ hashchange é‚£ä¹ˆæ–¹ä¾¿ã€‚</p><h2 id="hash-å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰"><a href="#hash-å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰" class="headerlink" title="hash å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰"></a>hash å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰</h2><pre><code class="hljs xquery"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><span class="xml">  </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><span class="xml">ref=""&gt;    <span class="hljs-comment">&lt;!-- å®šä¹‰è·¯ç”± --&gt;</span></span><span class="xml">    </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#/home"</span>&gt;</span>home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span class="xml">    </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#/about"</span>&gt;</span>about<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>ref=<span class="hljs-string">""</span>&gt;    &lt;!-- æ¸²æŸ“è·¯ç”±å¯¹åº”çš„ UI --&gt;    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"routeView"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  &lt;/ul&gt;&lt;/body&gt;// é¡µé¢åŠ è½½å®Œä¸ä¼šè§¦å‘ hashchangeï¼Œè¿™é‡Œä¸»åŠ¨è§¦å‘ä¸€æ¬¡ hashchange äº‹ä»¶<span class="hljs-keyword">window</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, onLoad)// ç›‘å¬è·¯ç”±å˜åŒ–<span class="hljs-keyword">window</span>.addEventListener(<span class="hljs-string">'hashchange'</span>, onHashChange)// è·¯ç”±è§†å›¾var routerView = null<span class="hljs-keyword">function</span> onLoad () &#123;  routerView =<span class="hljs-built_in"> document</span>.querySelector(<span class="hljs-string">'#routeView'</span>)  onHashChange()&#125;// è·¯ç”±å˜åŒ–æ—¶ï¼Œæ ¹æ®è·¯ç”±æ¸²æŸ“å¯¹åº” UI<span class="hljs-keyword">function</span> onHashChange () &#123;  <span class="hljs-keyword">switch</span> (location.hash) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">'#/home'</span>:      routerView.innerHTML = <span class="hljs-string">'Home'</span>      <span class="hljs-keyword">return</span>    <span class="hljs-keyword">case</span> <span class="hljs-string">'#/about'</span>:      routerView.innerHTML = <span class="hljs-string">'About'</span>      <span class="hljs-keyword">return</span>    default:      <span class="hljs-keyword">return</span>  &#125;&#125;</code></pre><h2 id="history-å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰"><a href="#history-å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰" class="headerlink" title="history å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰"></a>history å®ç°ï¼ˆç®€ç•¥ç‰ˆï¼‰</h2><pre><code class="hljs php">&lt;body&gt;  &lt;ul&gt;    &lt;li&gt;&lt;a href=<span class="hljs-string">'/home'</span>&gt;home&lt;/a&gt;&lt;/li&gt;    &lt;li&gt;&lt;a href=<span class="hljs-string">'/about'</span>&gt;about&lt;/a&gt;&lt;/li&gt;    &lt;div id=<span class="hljs-string">"routeView"</span>&gt;&lt;/div&gt;  &lt;/ul&gt;&lt;/body&gt;<span class="hljs-comment">// é¡µé¢åŠ è½½å®Œä¸ä¼šè§¦å‘ hashchangeï¼Œè¿™é‡Œä¸»åŠ¨è§¦å‘ä¸€æ¬¡ hashchange äº‹ä»¶</span>window.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, onLoad)<span class="hljs-comment">// ç›‘å¬è·¯ç”±å˜åŒ–</span>window.addEventListener(<span class="hljs-string">'popstate'</span>, onPopState)<span class="hljs-comment">// è·¯ç”±è§†å›¾</span><span class="hljs-keyword">var</span> routerView = <span class="hljs-keyword">null</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onLoad</span> <span class="hljs-params">()</span> </span>&#123;  routerView = document.querySelector(<span class="hljs-string">'#routeView'</span>)  onPopState() href=<span class="hljs-string">""</span>&gt;  <span class="hljs-comment">// æ‹¦æˆª &lt;a&gt; æ ‡ç­¾ç‚¹å‡»äº‹ä»¶é»˜è®¤è¡Œä¸ºï¼Œ ç‚¹å‡»æ—¶ä½¿ç”¨ pushState ä¿®æ”¹ URLå¹¶æ›´æ–°æ‰‹åŠ¨ UIï¼Œä»è€Œå®ç°ç‚¹å‡»é“¾æ¥æ›´æ–° URL å’Œ UI çš„æ•ˆæœã€‚</span>  <span class="hljs-keyword">var</span> linkList = document.querySelectorAll(<span class="hljs-string">'a[href]'</span>)  linkList.<span class="hljs-keyword">forEach</span>(el =&gt; el.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> </span>&#123;    e.preventDefault()    history.pushState(<span class="hljs-keyword">null</span>, <span class="hljs-string">''</span>, el.getAttribute(<span class="hljs-string">'href'</span>))    onPopState()  &#125;))&#125;<span class="hljs-comment">// è·¯ç”±å˜åŒ–æ—¶ï¼Œæ ¹æ®è·¯ç”±æ¸²æŸ“å¯¹åº” UI</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onPopState</span> <span class="hljs-params">()</span> </span>&#123;  <span class="hljs-keyword">switch</span> (location.pathname) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">'/home'</span>:      routerView.innerHTML = <span class="hljs-string">'Home'</span>      <span class="hljs-keyword">return</span>    <span class="hljs-keyword">case</span> <span class="hljs-string">'/about'</span>:      routerView.innerHTML = <span class="hljs-string">'About'</span>      <span class="hljs-keyword">return</span>    <span class="hljs-keyword">default</span>:      <span class="hljs-keyword">return</span>  &#125;&#125;</code></pre><h2 id="æ€»ç»“ï¼šå‰ç«¯è·¯ç”±ï¼Œåœ¨-SPA-å•é¡µé¢åº”ç”¨ä¸­ï¼Œéå¸¸é‡è¦ã€‚è·¯ç”±å¯¹åº”ç»„ä»¶æ¸²æŸ“ï¼Œä¸ç”¨å‘è¯·æ±‚ã€‚è¿œå¤æ—¶ä»£è·¯ç”±è·³è½¬å¯æ˜¯è¦å‘è¯·æ±‚ï¼Œåç«¯è¿”å›é¡µé¢çš„é¸­ã€‚ã€‚ã€‚"><a href="#æ€»ç»“ï¼šå‰ç«¯è·¯ç”±ï¼Œåœ¨-SPA-å•é¡µé¢åº”ç”¨ä¸­ï¼Œéå¸¸é‡è¦ã€‚è·¯ç”±å¯¹åº”ç»„ä»¶æ¸²æŸ“ï¼Œä¸ç”¨å‘è¯·æ±‚ã€‚è¿œå¤æ—¶ä»£è·¯ç”±è·³è½¬å¯æ˜¯è¦å‘è¯·æ±‚ï¼Œåç«¯è¿”å›é¡µé¢çš„é¸­ã€‚ã€‚ã€‚" class="headerlink" title="æ€»ç»“ï¼šå‰ç«¯è·¯ç”±ï¼Œåœ¨ SPA å•é¡µé¢åº”ç”¨ä¸­ï¼Œéå¸¸é‡è¦ã€‚è·¯ç”±å¯¹åº”ç»„ä»¶æ¸²æŸ“ï¼Œä¸ç”¨å‘è¯·æ±‚ã€‚è¿œå¤æ—¶ä»£è·¯ç”±è·³è½¬å¯æ˜¯è¦å‘è¯·æ±‚ï¼Œåç«¯è¿”å›é¡µé¢çš„é¸­ã€‚ã€‚ã€‚"></a>æ€»ç»“ï¼šå‰ç«¯è·¯ç”±ï¼Œåœ¨ SPA å•é¡µé¢åº”ç”¨ä¸­ï¼Œéå¸¸é‡è¦ã€‚è·¯ç”±å¯¹åº”ç»„ä»¶æ¸²æŸ“ï¼Œä¸ç”¨å‘è¯·æ±‚ã€‚è¿œå¤æ—¶ä»£è·¯ç”±è·³è½¬å¯æ˜¯è¦å‘è¯·æ±‚ï¼Œåç«¯è¿”å›é¡µé¢çš„é¸­ã€‚ã€‚ã€‚</h2>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯è·¯ç”± Hash History</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSæ¨¡å—åŒ–çš„å‘å±•å†ç¨‹</title>
    <link href="/2020/06/10/commonjs-amd-cmd/"/>
    <url>/2020/06/10/commonjs-amd-cmd/</url>
    
    <content type="html"><![CDATA[<p><strong>éšä¾¿å†™ç‚¹ js æ¨¡å—åŒ–å‘å±•å†å²ï¼Œé¢è¯•æœ‰é—®è¿™ç©æ„çš„ï¼Œéšä¾¿çœ‹çœ‹åˆ°æ—¶å€™èƒ½ç­”å‡ºæ¥å‡ å¥å°± okï¼Œé¡ºä¾¿å’±ä¹Ÿäº†è§£ä¸€ä¸‹ js çš„è¿™æ–¹é¢å†å²ã€‚</strong></p><p>1.js çš„è¯ç”Ÿï¼šç”± Brendan Eich èŠ±äº†ä¸åˆ°åå¤©æ—¶é—´å‘æ˜ï¼Œç”¨æ¥åœ¨ç½‘é¡µä¸Šè¿›è¡Œè¡¨å•æ ¡éªŒã€å®ç°ç®€å•çš„åŠ¨ç”»æ•ˆæœç­‰ç­‰ï¼Œä½ å¯ä»¥å›æƒ³ä¸€ä¸‹é‚£ä¸ªç½‘é¡µä¸Šåˆ°å¤„æœ‰å…¬å‘Šå—é£˜æ¥é£˜å»çš„æ—¶ä»£ã€‚<br>2.2006 å¹´ ajax å‡ºç°ï¼Œjs å¼€å§‹å‘å±•ã€‚å…¨å±€å˜é‡å¼€å§‹è®©äººå¤´ç–¼äº†ï¼Œå‡½æ•°å‘½åå¼€å§‹å†²çªäº† 3.æ‰€ä»¥ js éœ€è¦ï¼Œä¹Ÿå¿…é¡»è¦æ•´æ¨¡å—åŒ–</p><p>éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š</p><ul><li>å¦‚ä½•å®‰å…¨çš„åŒ…è£…ä¸€ä¸ªæ¨¡å—çš„ä»£ç ï¼Ÿï¼ˆä¸æ±¡æŸ“æ¨¡å—å¤–çš„ä»»ä½•ä»£ç ï¼‰</li><li>å¦‚ä½•å”¯ä¸€æ ‡è¯†ä¸€ä¸ªæ¨¡å—ï¼Ÿ</li><li>å¦‚ä½•ä¼˜é›…çš„æŠŠæ¨¡å—çš„ API æš´æ¼å‡ºå»ï¼Ÿï¼ˆä¸èƒ½å¢åŠ å…¨å±€å˜é‡ï¼‰</li><li>å¦‚ä½•æ–¹ä¾¿çš„ä½¿ç”¨æ‰€ä¾èµ–çš„æ¨¡å—ï¼Ÿ</li></ul><p>2009 å¹´ï¼Œnode.js è¯ç”Ÿï¼Œè¿™ä¸‹æ¨¡å—åŒ–å¿…é¡»é©¬ä¸Šæ•´äº†ï¼Œè¦ä¸ç„¶æœåŠ¡ç«¯æ²¡æ³•å¼„äº† æ‰€ä»¥ å½“å½“å½“å½“ï½ CommonJs é—ªäº®ç™»åœº</p><h2 id="CommonJs"><a href="#CommonJs" class="headerlink" title="CommonJs"></a>CommonJs</h2><p>ç®€å•æ¥è¯´å‘¢ï¼ŒcommonJs å°±æ˜¯ï¼Œexports æš´éœ² APIï¼Œrequire å¼•å…¥è¯¥ API çš„æ¨¡å—ï¼Œ</p><p>ç¼ºç‚¹ï¼Œå¾—å‘è¯·æ±‚å•Š è¿™ç©æ„å°±ä¸å¤ªå¥½äº†</p><h2 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h2><p>å¼‚æ­¥åŠ è½½æ‰€éœ€çš„æ¨¡å—ï¼Œç„¶ååœ¨å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œä¸»é€»è¾‘ã€‚</p><p>ç¼ºç‚¹ï¼šé¢„å…ˆä¸‹è½½å¤ªå¤šä¸œè¥¿ï¼Œè€Œä¸”å®šä¹‰æ¨¡å—çš„æ—¶å€™å†™æ³•å¤æ‚ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œå®ƒå®æ—¶ä¸‹è½½ä»£ç ç„¶åè§¦å‘å›è°ƒï¼Œä¸»ä½“ä»£ç è¿è¡Œã€‚ç”¨æˆ·ä¼šæœ‰å¡é¡¿æ„Ÿã€‚</p><h2 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h2><p>æ·˜å®å‰ç«¯ ç‰ä¼¯ æ•´å‡ºæ¥çš„ï¼Œèå„å®¶æ‰€é•¿ï¼Œæ²¡å•¥ç¼ºç‚¹</p><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><p>2015 å¹´ 6 æœˆï¼Œes6 æ¥äº†ï¼Œexport æš´éœ²ï¼Œimport å¼•å…¥ï¼Œç¼–è¯‘æ—¶åŠ è½½ï¼ˆé™æ€åŠ è½½ï¼‰</p><h2 id="æ€»ç»“ï¼Œå°±è¿™ç‚¹å†…å®¹ï¼Œè¿˜æ€»ç»“å•¥ï¼Ÿå‘Šè¾ï½"><a href="#æ€»ç»“ï¼Œå°±è¿™ç‚¹å†…å®¹ï¼Œè¿˜æ€»ç»“å•¥ï¼Ÿå‘Šè¾ï½" class="headerlink" title="æ€»ç»“ï¼Œå°±è¿™ç‚¹å†…å®¹ï¼Œè¿˜æ€»ç»“å•¥ï¼Ÿå‘Šè¾ï½"></a>æ€»ç»“ï¼Œå°±è¿™ç‚¹å†…å®¹ï¼Œè¿˜æ€»ç»“å•¥ï¼Ÿå‘Šè¾ï½</h2>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CommonJs AMD CMD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é—­åŒ…ï¼Œè€é“å®‰æ’ä¸Š</title>
    <link href="/2020/06/09/bi-bao/"/>
    <url>/2020/06/09/bi-bao/</url>
    
    <content type="html"><![CDATA[<p>å‘±å‘±ï¼Œå•¥æ˜¯é—­åŒ…ï¼Ÿ<br>å¤©å¤©å†™é—­åŒ…ï¼Œä½†æ˜¯è®©è¡¨è¾¾å‡ºæ¥ï¼Œè¿˜çœŸæœ‰ç‚¹æ‡µä½äº†ï¼Œ<br>è¿™ç©æ„æˆ‘éƒ½è®°åœ¨å¿ƒé‡Œï¼Œè¯è¯´ä¸å‡ºå£ï¼Œéƒ½åœ¨é…’é‡Œäº†ï¼Œå¹²æ¯ï½</p><p>â€”### é—­åŒ…æ˜¯å•¥ï¼Ÿ</p><p>æ¥å‡ ä¸ªå®˜æ–¹å›ç­”ï¼Œå¯ä»¥åº”ä»˜é¢è¯•</p><ul><li>é—­åŒ…æ˜¯ä¸€ä¸ªæœ‰è‡ªå·±ç¯å¢ƒçš„å‡½æ•°ï¼Œå¹¶ä¸”åœ¨è¯¥ç¯å¢ƒä¸­è‡³å°‘æœ‰ä¸€ä¸ªå˜é‡ã€‚</li><li>é—­åŒ…æ˜¯å°†å‡½æ•°ä¸å…¶å¼•ç”¨çš„å‘¨è¾¹çŠ¶æ€ç»‘å®šåœ¨ä¸€èµ·å½¢æˆï¼ˆå°è£…ï¼‰çš„ç»„åˆ</li><li>é—­åŒ…å‡½æ•°æ˜¯å£°æ˜åœ¨ä¸€ä¸ªå‡½æ•°ä¸­çš„å‡½æ•°</li><li>é—­åŒ…æ˜¯å†…éƒ¨å‡½æ•°æ€»æ˜¯å¯ä»¥è®¿é—®å…¶æ‰€åœ¨çš„å¤–éƒ¨å‡½æ•°ä¸­ç”Ÿå‘½çš„å‚æ•°å’Œå˜é‡ï¼Œå³ä½¿åœ¨å…¶å¤–éƒ¨å‡½æ•°è¢«è¿”å›ä»¥å</li></ul><h3 id="é—­åŒ…ç‰¹ç‚¹ï¼ˆä¼˜ç¼ºç‚¹éƒ½æœ‰å“ˆï¼‰"><a href="#é—­åŒ…ç‰¹ç‚¹ï¼ˆä¼˜ç¼ºç‚¹éƒ½æœ‰å“ˆï¼‰" class="headerlink" title="é—­åŒ…ç‰¹ç‚¹ï¼ˆä¼˜ç¼ºç‚¹éƒ½æœ‰å“ˆï¼‰"></a>é—­åŒ…ç‰¹ç‚¹ï¼ˆä¼˜ç¼ºç‚¹éƒ½æœ‰å“ˆï¼‰</h3><ul><li><p>è®©å¤–éƒ¨è®¿é—®å‡½æ•°å†…éƒ¨å˜é‡æˆä¸ºå¯èƒ½ï¼›</p></li><li><p>å±€éƒ¨å˜é‡ä¼šå¸¸é©»åœ¨å†…å­˜ä¸­ï¼›</p></li><li><p>å¯ä»¥é¿å…ä½¿ç”¨å…¨å±€å˜é‡ï¼Œé˜²æ­¢å…¨å±€å˜é‡æ±¡æŸ“ï¼›(ä¸ç”¨æ‹…å¿ƒå˜é‡åé‡å¤ï¼Œä¸è¿‡éƒ½ 2020 å¹´äº†ï¼Œè°è¿˜é¢‘ç¹ç”¨ var å£°æ˜å˜é‡å•Šã€‚)</p></li><li><p>ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼ˆæœ‰ä¸€å—å†…å­˜ç©ºé—´è¢«é•¿æœŸå ç”¨ï¼Œè€Œä¸è¢«é‡Šæ”¾ï¼‰</p><p>é—­åŒ…å°±æ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ç¯å¢ƒï¼Œæ¯ä¸ªé—­åŒ…é‡Œé¢çš„ç¯å¢ƒéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œäº’ä¸å¹²æ‰°ã€‚<strong>æ¯æ¬¡å¤–éƒ¨å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œå¤–éƒ¨å‡½æ•°çš„å¼•ç”¨åœ°å€ä¸åŒï¼Œéƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åœ°å€ã€‚</strong>ä½†å‡¡æ˜¯å½“å‰æ´»åŠ¨å¯¹è±¡ä¸­æœ‰è¢«å†…éƒ¨å­é›†å¼•ç”¨çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œè¿™ä¸ªæ•°æ®ä¸åˆ é™¤ï¼Œä¿ç•™ä¸€æ ¹æŒ‡é’ˆç»™å†…éƒ¨æ´»åŠ¨å¯¹è±¡ã€‚æ‰€ä»¥å•Šï¼Œå½“æœ‰å¾ˆå¤šå¾ˆå¤šé—­åŒ…çš„æ—¶å€™ï¼Œæˆ–è€…é—­åŒ…è¢«è°ƒç”¨å¾ˆå¤šå¾ˆå¤šæ¬¡çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±ä¼šå†…å­˜æ³„æ¼äº†ã€‚</p></li></ul><p><em>ç„¶åé¢è¯•çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡è§ä¸€äº›ç¬”è¯•é¢˜ï¼Œé¢è¯•å®˜æ•´ä¸€ä¸ªå‡½æ•°ï¼Œè®©ä½ å†™è¾“å‡ºçš„å€¼ï¼Œè®¾è®¡ä¸ªåœˆå¥—å‘ä½ ï¼Œæ€ä¹ˆåŠï¼Ÿä¸æ…Œï¼æœ‰ç§˜è¯€ï½</em></p><p><strong>ç§˜è¯€åœ¨æ­¤ï¼šè¾“å‡ºçš„å°±æ˜¯åŒä¸€ä¸ªåœ°å€ä¸­çš„çˆ¸çˆ¸å‡½æ•°ä¸­çš„å˜é‡å€¼</strong></p><p>å¦‚æ­¤ç®€å•ç²—æš´çš„ç§˜è¯€ï¼Œå–œæ¬¢å—ï¼Ÿ</p><p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œä¸‹é¢æˆ‘æ¥è¡¨æ¼”ç»æ´»ï¼šä¸¾ä¸ªæ —å­ ğŸŒ°</p><pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">funA</span><span class="hljs-params">()</span></span>&#123;  <span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;  <span class="hljs-comment">// funAçš„æ´»åŠ¨å¯¹è±¡ä¹‹ä¸­;</span>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>&#123;   <span class="hljs-comment">//åŒ¿åå‡½æ•°çš„æ´»åŠ¨å¯¹è±¡;</span>        alert(a);  &#125;&#125;<span class="hljs-keyword">var</span> b = funA();b();<span class="hljs-comment">// 10</span></code></pre><p>ç”±æµ…å…¥æ·±ï¼Œå…ˆä»è¿™ä¸ªç®€å•çš„å¼€å§‹ï¼Œå¥—å…¥ç§˜è¯€ï¼Œ<em>åŒä¸€ä¸ªåœ°å€ä¸­çš„çˆ¸çˆ¸å‡½æ•°ä¸­çš„å˜é‡å€¼</em> å•¥å«åŒä¸€ä¸ªåœ°å€å‘¢ï¼Œå°±æ˜¯è¢«åŒä¸€ä¸ªäººè°ƒç”¨ï¼Œåœ¨è¿™ä¸ªæ —å­é‡Œé¢ï¼Œå°±æ˜¯è¿™ä¸ªï¼š</p><p>var b = funAï¼ˆï¼‰<br>b()</p><p>è¿™ä¸ª b å°±æ˜¯ä¸ªåœ°å€ï¼Œå¦‚æœå¤šä¸€ä¸ª var c = funAï¼ˆï¼‰ ç„¶åè°ƒç”¨ cï¼ˆï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ª c å°±æ˜¯å¦ä¸€ä¸ªåœ°å€ã€‚</p><p>åœ°å€å°±æ˜ç™½äº†å§ï½<br>ç„¶åæ‰¾çˆ¸çˆ¸ï¼Œçˆ¸çˆ¸çš„çˆ¸çˆ¸å«ä»€ä¹ˆï¼Œçˆ¸çˆ¸çš„çš„çˆ¸çˆ¸å«çˆ·çˆ·ã€‚ã€‚ã€‚å“ˆå“ˆ ï¼Œçš®ä¸€ä¸‹</p><p>å›åˆ°æ‰¾çˆ¹çš„æ­£äº‹ä¸Šæ¥ï¼Œalertï¼ˆaï¼‰æ˜¯å„¿å­ï¼Œä»–çˆ¸åœ¨å¤–è¾¹åŒ…ä½äº†å®ƒï¼Œå°±æ˜¯è¿™ä¸ª funA æ˜¯å®ƒçˆ¸ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºæ€€å­•çš„æ¯äº²ï¼Œå’Œè‚šå­é‡Œçš„å­©å­ã€‚ï¼ˆè°åœ¨é‡Œé¢è°å„¿å­ï¼‰</p><p>æ‰€ä»¥æ‰¾åˆ°äº†å®ƒçˆ¸çˆ¸é‡Œé¢çš„å˜é‡ a=10 ï¼Œæ‰€ä»¥è¾“å‡º 10</p><p>å¥½çš„ï¼Œå¾ˆå¼€å¿ƒï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸€ä¸ªæ —å­ ğŸŒ°</p><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">zhujunFn</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xcolaFn</span>(<span class="hljs-params"></span>)</span>&#123;      i++;      <span class="hljs-built_in">console</span>.log(i);  &#125;  <span class="hljs-keyword">return</span> xcolaFn;&#125;<span class="hljs-keyword">var</span> aaa = zhujunFn();  <span class="hljs-comment">//æ¯æ¬¡å¤–éƒ¨å‡½æ•°æ‰§è¡Œçš„æ—¶å€™,å¤–éƒ¨å‡½æ•°çš„åœ°å€ä¸åŒï¼Œéƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åœ°å€,è¿™ä¸ªaaaæ˜¯ä¸ªæ–°çš„åœ°å€</span>aaa();aaa();aaa();<span class="hljs-keyword">var</span> bbb = zhujunFn();  <span class="hljs-comment">//  æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œaaaå’Œbbb æ˜¯ä¸¤ä¸ªä¸åŒçš„åœ°å€</span>bbb();bbb();bbb();<span class="hljs-comment">// 1 2 3 1 2 3</span></code></pre><p>å…ˆé‡å¤ä¸€ä¸‹æˆ‘ä»¬çš„ç§˜è¯€ï¼Œç„¶åæ‰¾çˆ¹</p><ul><li><p><em>åŒä¸€ä¸ªåœ°å€ä¸­çš„çˆ¸çˆ¸å‡½æ•°ä¸­çš„å˜é‡å€¼</em></p><p>aaa å’Œ bbb åˆ†åˆ«æ˜¯ä¸¤ä¸ªåœ°å€ï¼Œæ˜¯ç‹¬ç«‹çš„</p><p>ç„¶åç»™è¿™ä¸ª <strong>xcolaFn</strong> æ‰¾çˆ¹ï¼Œæ˜¯å¤–è¾¹è¿™ä¸ª <strong>zhujunFn</strong>ï¼Œç„¶åæ‰¾åˆ°é‡Œé¢çš„è¿™ä¸ªå˜é‡ iï¼Œæ¯æ¬¡è°ƒç”¨ aaaï¼ˆï¼‰è¾“å‡º i ä¸º 1ï¼Œ2ï¼Œ3</p><p>æ¯æ¬¡è°ƒç”¨ bbbï¼ˆï¼‰æ˜¯æ–°çš„åœ°å€ï¼Œç‹¬ç«‹çš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç† è¾“å‡º i ä¸º 1ï¼Œ2ï¼Œ3</p></li></ul><pre><code class="hljs matlab"><span class="hljs-keyword">for</span> (var <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>; <span class="hljs-built_in">i</span>&lt;=<span class="hljs-number">5</span>; <span class="hljs-built_in">i</span>++) &#123; (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(j)</span> &#123;</span>setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timer</span><span class="hljs-params">()</span> &#123; <span class="hljs-title">console</span>.<span class="hljs-title">log</span><span class="hljs-params">( j )</span>;</span>             &#125;, <span class="hljs-built_in">j</span>*<span class="hljs-number">1000</span> );         &#125;)( <span class="hljs-built_in">i</span> );&#125;</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘æ²¡å•¥æƒ³æ€»ç»“äº†ï¼Œæœ‰è¥å…»çš„éƒ½åœ¨ä¸Šè¾¹äº†ï¼Œå¦‚æœçœ‹å®Œäº†å‘ç°è¿˜æ˜¯ä¸å¤ªæ˜ç™½ï¼Œé‚£ä¸€å®šæ˜¯æˆ‘æ²¡è¯´æ¸…æ¥šï¼Œä¸æ€ªä½ ï¼Œé‚£å°±å†çœ‹çœ‹è¿™ä¸ªäººå¯¹é—­åŒ…çš„ç†è§£å§ï¼Œä¼šæœ‰å¸®åŠ©çš„<br>é“¾æ¥åœ¨æ­¤ï¼š<a href="http://blog.xcola.top/2018/05/23/%E5%AF%B9%E9%97%AD%E5%8C%85%E7%9A%84%E7%90%86%E8%A7%A3/" target="_blank" rel="noopener">è¯·ç‚¹å‡»è¿™é‡Œ</a></p><p><strong>å†²é¸­ï¼Œå¥¥åˆ©ç»™</strong></p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é—­åŒ…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Jsäº‹ä»¶å¾ªç¯æœºåˆ¶</title>
    <link href="/2020/06/08/event-loop/"/>
    <url>/2020/06/08/event-loop/</url>
    
    <content type="html"><![CDATA[<ul><li>js å¼•æ“å­˜åœ¨ monitoring process è¿›ç¨‹ï¼Œä¼šæŒç»­ä¸æ–­çš„æ£€æŸ¥ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆæ˜¯å¦ä¸ºç©ºï¼Œä¸€æ—¦ä¸ºç©ºï¼Œå°±ä¼šå» Event Queue é‚£é‡Œæ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…è¢«è°ƒç”¨çš„å‡½æ•°ã€‚</li><li>è¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ªç¯ä¸æ–­çš„ï¼Œæ‰€ä»¥æ•´ä¸ªçš„è¿™ç§è¿è¡Œæœºåˆ¶åˆç§°ä¸º Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰</li></ul><ul><li>æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼ˆexecution context stackï¼‰</li><li>å¦‚æœåœ¨å¾®ä»»åŠ¡æ‰§è¡ŒæœŸé—´å¾®ä»»åŠ¡é˜Ÿåˆ—åŠ å…¥äº†æ–°çš„å¾®ä»»åŠ¡ï¼Œä¼šå°†æ–°çš„å¾®ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼Œä¹‹åä¹Ÿä¼šè¢«æ‰§è¡Œ</li></ul><h5 id="çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå…ˆå¾€ä¸‹çœ‹ï¼Œå›è¿‡å¤´æ¥å°±ç†è§£è¿™äº›äº†ï¼Œè€é“ï¼"><a href="#çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå…ˆå¾€ä¸‹çœ‹ï¼Œå›è¿‡å¤´æ¥å°±ç†è§£è¿™äº›äº†ï¼Œè€é“ï¼" class="headerlink" title="çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå…ˆå¾€ä¸‹çœ‹ï¼Œå›è¿‡å¤´æ¥å°±ç†è§£è¿™äº›äº†ï¼Œè€é“ï¼"></a>çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå…ˆå¾€ä¸‹çœ‹ï¼Œå›è¿‡å¤´æ¥å°±ç†è§£è¿™äº›äº†ï¼Œè€é“ï¼</h5><h3 id="js-ä¸­çš„å¼‚æ­¥æ“ä½œ"><a href="#js-ä¸­çš„å¼‚æ­¥æ“ä½œ" class="headerlink" title="js ä¸­çš„å¼‚æ­¥æ“ä½œ"></a>js ä¸­çš„å¼‚æ­¥æ“ä½œ</h3><ul><li>setTimeOut</li><li>setInterval</li><li>ajax</li><li>promise</li><li>I/O</li></ul><h3 id="åŒæ­¥ä»»åŠ¡-å¼‚æ­¥ä»»åŠ¡"><a href="#åŒæ­¥ä»»åŠ¡-å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="åŒæ­¥ä»»åŠ¡ - å¼‚æ­¥ä»»åŠ¡"></a>åŒæ­¥ä»»åŠ¡ - å¼‚æ­¥ä»»åŠ¡</h3><ul><li>åŒæ­¥ä»»åŠ¡æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šæ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡</li><li>å¼‚æ­¥ä»»åŠ¡ ä¸è¿›å…¥ä¸»çº¿ç¨‹ï¼Œè€Œæ˜¯è¿›å…¥ ä»»åŠ¡é˜Ÿåˆ— ï¼Œåªæœ‰ ä»»åŠ¡é˜Ÿåˆ— é€šçŸ¥ä¸»çº¿ç¨‹ï¼ŒæŸä¸ªå¼‚æ­¥ä»»åŠ¡å¯ä»¥æ‰§è¡Œäº†ï¼Œè¯¥ä»»åŠ¡æ‰ä¼šè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</li></ul><h3 id="å®ä»»åŠ¡-å¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡-å¾®ä»»åŠ¡" class="headerlink" title="å®ä»»åŠ¡ - å¾®ä»»åŠ¡"></a>å®ä»»åŠ¡ - å¾®ä»»åŠ¡</h3><ul><li>å®ä»»åŠ¡ï¼šæ•´ä½“ä»£ç  script/setTimeOut ç­‰ï¼ˆnew Promise ä¼šè¿›å…¥ä¸»çº¿ç¨‹ç«‹åˆ»æ‰§è¡Œï¼Œæ˜¯ä¸»çº¿ç¨‹ä»»åŠ¡ï¼‰</li><li>å¾®ä»»åŠ¡ï¼špromise.then/promise.nextTick (node)</li></ul><hr><p>ä¸¾ä¸ªæ —å­</p><pre><code class="hljs fortran">console.<span class="hljs-built_in">log</span>(<span class="hljs-number">1</span>)setTimeOut(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>&#123;  console.<span class="hljs-built_in">log</span>(<span class="hljs-number">2</span>)&#125;,<span class="hljs-number">0</span>)console.<span class="hljs-built_in">log</span>(<span class="hljs-number">3</span>)</code></pre><p>æ‰§è¡Œç»“æœ 1 3 2</p><p><strong>å› ä¸º setTimeOut æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œæ‰€ä»¥å“ªæ€•æ˜¯ 0 ç§’ç­‰å¾…ï¼Œä¹Ÿä¼šç­‰ä¸»çº¿ç¨‹ä»»åŠ¡éƒ½å®Œäº‹äº†ä»¥åæ‰æ‰§è¡Œï¼Œä¸‹è¾¹æ˜¯è¯¦ç»†è§£æ</strong></p><p>1.console.log(1)æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œç›´æ¥æ‰“å° 1ï¼›</p><p>2.setTimeout æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œä¸”æ˜¯å®å‡½æ•°ï¼Œæ”¾åˆ°å®å‡½æ•°é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ä¸‹æ¬¡ Event Loop æ‰ä¼šæ‰§è¡Œï¼›</p><p>3.console.log(3)æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œç›´æ¥æ‰“å° 3ï¼›</p><p>4.ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œæ²¡æœ‰å¾®ä»»åŠ¡ï¼Œé‚£ä¹ˆæ‰§è¡Œç¬¬äºŒä¸ªå®ä»»åŠ¡ setTimeoutï¼Œæ‰“å° 2ï¼›</p><p>5.ç»“æœï¼š1ï¼Œ3ï¼Œ2</p><p><strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰ promiseï¼Œé‚£æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œç­‰æ‰€æœ‰åŒæ­¥ä»»åŠ¡å®Œäº‹ï¼Œå¼€å§‹æ‰§è¡Œè¿™ä¸ª promise.thenï¼Œå†ç„¶åæ‰æ˜¯ setTimeOut å•¥çš„ã€‚</strong></p><hr><p>ä¸¾ä¸ªæ —å­</p><pre><code class="hljs lisp">setTimeout(<span class="hljs-name">function</span>()&#123;    console.log(<span class="hljs-number">1</span>)&#125;)<span class="hljs-comment">;</span>new Promise(<span class="hljs-name">function</span>(<span class="hljs-name">resolve</span>)&#123;    console.log(<span class="hljs-number">2</span>)<span class="hljs-comment">;</span>    for(<span class="hljs-name">var</span> i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 10000; i++)&#123;</span>        i == <span class="hljs-number">9999</span> <span class="hljs-symbol">&amp;&amp;</span> resolve()<span class="hljs-comment">;</span>    &#125;&#125;).then(<span class="hljs-name">function</span>()&#123;    console.log(<span class="hljs-number">3</span>)&#125;)<span class="hljs-comment">;</span>console.log(<span class="hljs-number">4</span>)<span class="hljs-comment">;</span></code></pre><p>è¾“å‡º 2 ï¼Œ 4 ï¼Œ 3ï¼Œ 1</p><p>1.setTimeout æ˜¯å¼‚æ­¥ï¼Œä¸”æ˜¯å®å‡½æ•°ï¼Œæ”¾åˆ°å®å‡½æ•°é˜Ÿåˆ—ä¸­ï¼›</p><p>2.new Promise æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œç›´æ¥æ‰§è¡Œï¼Œæ‰“å° 2ï¼Œå¹¶æ‰§è¡Œ for å¾ªç¯ï¼›</p><p>3.promise.then æ˜¯å¾®ä»»åŠ¡ï¼Œæ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼›</p><p>4.consoleã€‚log(4)åŒæ­¥ä»»åŠ¡ï¼Œç›´æ¥æ‰§è¡Œï¼Œæ‰“å° 4ï¼›</p><p>5.æ­¤æ—¶ä¸»çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œæœ‰ promise.thenï¼Œæ‰§è¡Œå¾®ä»»åŠ¡ï¼Œæ‰“å° 3ï¼Œ</p><p>6.å¾®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç¬¬ä¸€æ¬¡å¾ªç¯ç»“æŸï¼›ä»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºç¬¬ä¸€ä¸ªå®ä»»åŠ¡åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œæ‰“å° 1</p><hr><p><em>å†ä¸¾ä¸ªå‰å®³çš„æ —å­å§</em></p><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x, y</span>) </span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>)  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// timer1</span>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>)  &#125;, <span class="hljs-number">1000</span>)&#125;add();setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// timer2</span>  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>)&#125;)<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve</span>) </span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">4</span>)  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// timer3</span>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span>)  &#125;, <span class="hljs-number">100</span>)  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;    i == <span class="hljs-number">99</span> &amp;&amp; resolve()  &#125;&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// timer4</span>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">6</span>)  &#125;, <span class="hljs-number">0</span>)  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">7</span>)&#125;)<span class="hljs-built_in">console</span>.log(<span class="hljs-number">8</span>)</code></pre><p>ç»“æœ 1ï¼Œ 4ï¼Œ 8ï¼Œ 7ï¼Œ 3ï¼Œ 6ï¼Œ 5ï¼Œ 2ï¼Œ<br>è¿™å°±ä¸è§£æäº†ï¼Œè¿™å›å¼„æ‡‚äº†å§ã€‚</p><hr><p><strong>æ€»ç»“ï¼šè¿™æ˜¯ä¸ªå¾ªç¯ï¼Œç¬¬ä¸€æ¬¡å¾ªç¯å…ˆæå®šæ‰€æœ‰ä¸»çº¿ç¨‹ä»»åŠ¡ï¼Œå®Œäº‹ä»¥åçœ‹çœ‹æœ‰æ²¡æœ‰å¾®ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œæ‰§è¡Œï¼Œç„¶åç»“æŸç¬¬ä¸€æ¬¡å¾ªç¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ç›´æ¥ç»“æŸç¬¬ä¸€æ¬¡å¾ªç¯ï¼Œï¼Œï¼Œç„¶åå¼€å§‹ç¬¬äºŒæ¬¡å¾ªç¯ï¼Œæ‰¾åˆ°å®ä»»åŠ¡é‡Œè¾¹æœ€å…ˆæ‰§è¡Œé‚£ä¸ªï¼Œæ‰§è¡Œï¼Œæ‰€æœ‰éƒ½æ‰§è¡Œå®Œäº‹ï¼Œç„¶åçœ‹æœ‰æ²¡æœ‰å¾®ä»»åŠ¡ï¼Œå¦‚æœæœ‰ã€‚ã€‚ã€‚å¦‚æœæ²¡æœ‰ã€‚ã€‚ã€‚ã€‚ä½ çœ‹è¿™å¥è¯ä¸Šé¢ä¹Ÿè¯´è¿‡ï¼Œè¿™å°±æ˜¯å¾ªç¯å•Šï¼Œç„¶åç»§ç»­å¾ªç¯å•Šï¼Œç›´åˆ°æ²¡æœ‰å®ä»»åŠ¡ï¼Œä¹Ÿæ²¡æœ‰å¾®ä»»åŠ¡ã€‚å¾ªç¯å°±å®Œäº‹äº†å‘—</strong></p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>jsè¿è¡Œå¾ªç¯æœºåˆ¶ å®ä»»åŠ¡ å¾®ä»»åŠ¡ åŒæ­¥ä»»åŠ¡ å¼‚æ­¥ä»»åŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¥½çš„å¼€å§‹ï¼Œæˆ‘åªæ˜¯æƒ³å˜å¼º</title>
    <link href="/2020/06/08/my-first/"/>
    <url>/2020/06/08/my-first/</url>
    
    <content type="html"><![CDATA[<h3 id="so-what-can-i-do"><a href="#so-what-can-i-do" class="headerlink" title="so what can i do"></a>so what can i do</h3><p>å…ˆå†™ä¸ªå¼€å¤´ï¼Œé¡ºä¾¿å¤ä¹ ä¸€ä¸‹ markdownï¼Œæ˜¯çš„ï¼Œæ²¡é”™ï¼Œæˆ‘åˆå¿˜è®° markdown æ€ä¹ˆç”¨äº†ï¼Œä¸ºäº†é¿å…å†æ¬¡å¿˜è®°ï¼Œè¦å°½é‡å¤šçš„ä½¿ç”¨ï¼Œ<br>æ¯”å¦‚</p><ul><li>1 å°½é‡é¢‘ç¹çš„å†™åšå®¢</li><li>2 å°½é‡é¢‘ç¹çš„å†™åšå®¢</li><li>3 è¿˜æ˜¯ tmd å°½é‡é¢‘ç¹çš„å†™åšå®¢</li></ul><p>æ— åºåˆ—è¡¨ç”¨*<br>æœ‰åºåˆ—è¡¨ç”¨ 1.</p><p>æ¯”å¦‚</p><ol><li>è¿™æ˜¯æœ‰åºçš„</li><li>æˆ‘æ˜¯æœ‰å¤´å‘çš„</li><li>ç¬¬ä¸‰æ¡ä¸é‡è¦</li></ol><p>åŠ ä¸ªå¤§äºå· åè¾¹æ˜¯æ–‡å­— å±•ç¤ºæ•ˆæœæ˜¯å¼•ç”¨</p><blockquote><p>è¿™æ˜¯é²è¿…è¯´çš„ â€”â€” å‘¨æ ‘äºº</p></blockquote><p>æ’å…¥é“¾æ¥ <a href="å°±å½“è¿™é‡Œæœ‰é“¾æ¥">xxx</a> è‹±æ–‡ä¹¦åå·åŠ å°æ‹¬å·</p><p>æ’å…¥å›¾ç‰‡ å‰è¾¹æœ‰ä¸ªæ„Ÿå¹å· <img src="%E5%B0%B1%E5%BD%93%E8%BF%99%E9%87%8C%E6%9C%89%E9%93%BE%E6%8E%A5%E5%90%A7" srcset="/img/loading.gif" alt="å‡è£…æœ‰å›¾.jpg"> è‹±æ–‡æ„Ÿå¹å·åŠ ä¹¦åå·åŠ å°æ‹¬å·</p><p><strong>å·¦å³å„ä¸¤ä¸ªæ˜Ÿå·ä¸­é—´å¤¹çš„ä¼šåŠ ç²—ï¼Œè¯·ç»™æˆ‘åŠ ç²—</strong><br><em>å·¦å³å„ä¸€ä¸ªæ˜Ÿå·å°±å€¾æ–œ</em></p><p>æ¨¡ç‰ˆå­—ç¬¦ä¸²ä¸­é—´å¯ä»¥æ”¾ä»£ç ï¼Œæ¯”å¦‚<br><code>const wanghao = &#39;è¾£é¸¡&#39;</code><br>å·¦å³å„ä¸‰ä¸ªè¿™ç©æ„ï¼Œå¯ä»¥å¤¹ä½ä»£ç å—ï¼Œlet me try try<br>Â·Â·Â·ä¸å¥½æ„æ€ï¼Œæ•´é”™äº†Â·Â·Â·</p><pre><code class="hljs ebnf"><span class="hljs-attribute">let a</span> = 1;<span class="hljs-attribute">a</span> = 2;<span class="hljs-attribute">a</span> = b = 2;</code></pre><p>tab å¯ä»¥ç¼©è¿›ï¼Œè¿™å°±æ˜¯ä¸ºå•¥ç°åœ¨æ‰æœ‰ç¼©è¿›ï¼Œæˆ‘åˆšçœ‹åˆ°ã€‚<br>éå¸¸å¼€å¿ƒï¼Œå†æ¥å‡ ä¸ªç¼©è¿›<br>ä¸‰ä¸ªæ˜Ÿå·æ˜¯åˆ†å‰²çº¿</p><table><thead><tr><th>è¡¨å¤´</th><th>è¡¨å¤´</th></tr></thead><tbody><tr><td>åå­—</td><td>èº«ä»½è¯å·ç </td></tr><tr><td>ç‹æ˜Š</td><td>211232199608135438</td></tr><tr><td>åŸŸå</td><td>IP</td></tr><tr><td><a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></td><td>220.181.111.188</td></tr></tbody></table><p>å•Šã€‚ã€‚ã€‚å¤±è´¥çš„ markdown è¡¨æ ¼ï¼Œä¸ºå•¥è¡¨æ ¼æ²¡å¥½ä½¿å‘¢ï¼Ÿ(ä¹‹å‰è¿™é‡Œæ²¡æœ‰å±•ç¤ºä¸ºè¡¨æ ¼ï¼Œåæ¥è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œï¼Œï¼Œèƒ½æˆåŠŸå±•ç¤ºäº†)</p><table><thead><tr><th>è¡¨å¤´</th><th>è¡¨å¤´</th></tr></thead><tbody><tr><td>åå­—</td><td>èº«ä»½è¯å·ç </td></tr><tr><td>ç‹æ˜Š</td><td>211232199608135438</td></tr><tr><td>åŸŸå</td><td>IP</td></tr><tr><td><a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></td><td>220.181.111.188</td></tr></tbody></table><p>markdown è¡¨æ ¼æ²¡å¥½ä½¿çš„åŸå› æ˜¯ æˆ‘åœ¨|åé¢ä¹ æƒ¯æ€§çš„åŠ äº†ç©ºæ ¼ã€‚å¯¼è‡´ markdown æ²¡èƒ½è¯†åˆ«è¿™ç§ã€‚è¡Œé‚£æˆ‘ä»¬ç»§ç»­ï¼Œä¸Šé¢å¤±è´¥çš„çš„å°±ä¸åˆ é™¤äº†</p><hr><p><strong>è¡Œï¼Œè¿™å°±ç®—å¤ä¹ å®Œäº‹ï¼Œæ¥ä¸‹æ¥æˆ‘éšä¾¿å†™å†™ã€‚</strong><br><strong>åˆ«é—®æˆ‘ä¸ºå•¥åŠ ç²—ï¼Œæˆ‘å°±å–œæ¬¢ç²—ï¼Œå¹¶ä¸”ä¸ç¼©è¿›ï¼ŒçœŸç”·äººä»æ¥ä¸åšç¼©å¤´ä¹Œé¾Ÿ</strong></p><h2 id="æˆ‘è¿˜èƒ½æ›´ç²—"><a href="#æˆ‘è¿˜èƒ½æ›´ç²—" class="headerlink" title="æˆ‘è¿˜èƒ½æ›´ç²—"></a>æˆ‘è¿˜èƒ½æ›´ç²—</h2><p>æœ€è¿‘ç»å†äº†å¥½å¤šçš„äº‹æƒ…ï¼Œäº‹æƒ…éƒ½æ˜¯ç›¸å¯¹çš„ï¼Œè¾©è¯å»çœ‹ï¼Œä¹Ÿæ— æ‰€è°“å¥½åã€‚<br>ä½†æ˜¯å¾ˆå¤šäº‹æƒ…ï¼Œæˆ‘éƒ½ä¸å–œæ¬¢ï¼Œä¸å¦‚æ„äº‹å¸¸å…«ä¹ï¼Œå¯ä¸äººè¨€æ— äºŒä¸‰ã€‚<br>æ•²äº†å¾ˆå¤šå­—ï¼Œåˆéƒ½åˆ æ‰äº†ã€‚è§‰å¾—æ²¡æœ‰æ„ä¹‰ã€‚è‡ªå·±å’Œè‡ªå·±çš„è¾©è®ºï¼Œæ€»å½’èµ¢çš„ä¹Ÿæ˜¯è‡ªå·±ã€‚<br>è‡ªå·±å’Œè‡ªå·±æ¢è®¨äººç”Ÿè§‚ï¼Œä»·å€¼è§‚ï¼Œä¹Ÿæœªå…å¤ªæ— è¶£ï¼Œè¿˜è¦å†™åœ¨è¿™é‡Œè®°å½•ä¸‹æ¥ï¼Œä¹Ÿæœªå…å¤ªä»–å¦ˆçš„æ— è¶£<br>æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘å°±ä¸€å¥è¯ï¼Œæˆ‘æƒ³å˜å¼ºã€‚</p><hr><p><em>æˆ‘æ²¡è§‰å¾—å–œæ¬¢è¿™ä¸ªè¡Œä¸šï¼Œä½†æ˜¯æˆ‘å–œæ¬¢è‡ªå·±å˜å¼ºçš„æ„Ÿè§‰ã€‚</em></p><p>å¼€å§‹æ•´æ´»ï¼<br><strong>å¥¥åˆ©ç»™</strong></p>]]></content>
    
    
    <categories>
      
      <category>markdown</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ æ²¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2020/06/05/hello-world/"/>
    <url>/2020/06/05/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre><code class="hljs bash">$ hexo new <span class="hljs-string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre><code class="hljs bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre><code class="hljs bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre><code class="hljs bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>.</title>
    <link href="/2020/01/18/secret0818/"/>
    <url>/2020/01/18/secret0818/</url>
    
    <content type="html"><![CDATA[<p>hiï¼Œsomeone. this is not for anybody,but maybe this is for the future you</p><p>æœ‰äººç°åœ¨è¯´å–œæ¬¢å°æºª<br>æ˜¯å› ä¸ºè¿˜æ²¡è§è¿‡å¤§æµ·<br>è€Œæˆ‘å·²ç»è§è¿‡äº†é“¶æ²³<br>å´ä»ç„¶åªçˆ±ä½ è¿™é¢—æ˜Ÿ</p><p>â€”ã€Šwhat can i hold you with? ã€‹<br>__ Jorges Luis Borges</p><p>i offer you lean streets,desperate sunsets, the moon of the jagged suburbs<br>i offer you the bitterness of a man who has looked long and long at the lonely moon<br>i offer you my ancestors, my family<br>i offer you whatever insight my books may hold<br>whatever manliness or humour my life<br>i offer you the loyalty of a man who has never been loyal<br>i offer you explanations of yourself,theories about yourself,authentic and surprising news of yourself<br>i can give you my loneliness ,my darkness,the hunger of my heart<br>i am trying to bribe you with uncertainty,with danger,with defeat</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>.</title>
    <link href="/2020/01/17/secret0817/"/>
    <url>/2020/01/17/secret0817/</url>
    
    <content type="html"><![CDATA[<p>ä»–æƒ³éšè—åœ¨è¿™ä¸ªä¸–ç•Œï¼Œåˆæƒ³å‘å‡ºå£°éŸ³ã€‚<br>ä»–å–œæ¬¢ç‚½çƒ­çš„æ¬¢æ„‰ï¼Œä¹Ÿå–œæ¬¢å†·æ·¡çš„é™é»˜ã€‚<br>æ˜æ˜æ˜¯ç‚çƒ­çš„ 8 æœˆï¼Œä»–ä¸ºä»€ä¹ˆä¼šæ„Ÿåˆ°å†·å‘¢<br>çœŸæ˜¯ä¸ªå¥‡æ€ªçš„äººå•Š</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
